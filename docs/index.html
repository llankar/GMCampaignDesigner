
<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='utf-8' />
  <title>GMCampaignDesigner Documentation</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; color: #111; }
    h1, h2, h3, h4 { color: #0b3d6e; }
    code { background: #f2f4f8; padding: 2px 4px; border-radius: 3px; }
    section { margin-bottom: 36px; }
    figure.shot { margin: 0 0 24px 0; }
    figure.shot img { max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; display: block; }
    figure.shot figcaption { color: #666; font-size: 0.9em; margin-top: 6px; }
    .menu-block { margin-bottom: 16px; }
    ul { margin-top: 8px; }
  </style>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <meta name='generator' content='generate_docs.py'>
  <meta name='robots' content='noindex'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge' />
  <meta name='description' content='Auto-generated documentation for GMCampaignDesigner'>
  <meta name='theme-color' content='#0b3d6e' />
  <meta name='og:title' content='GMCampaignDesigner Documentation' />
  <meta name='og:type' content='website' />
  <meta name='og:description' content='Auto-generated documentation for GMCampaignDesigner' />
  <meta name='og:image' content='images/main_window.png' />
  <meta name='og:image:alt' content='Main Window Screenshot' />
  <meta name='twitter:card' content='summary_large_image' />
  <meta name='twitter:title' content='GMCampaignDesigner Documentation' />
  <meta name='twitter:image' content='images/main_window.png' />
  <meta name='twitter:image:alt' content='Main Window Screenshot' />
  <meta name='apple-mobile-web-app-title' content='GMCampaignDesigner Docs' />
</head>
<body>
  
        <section id="overview">
          <h1>GMCampaignDesigner Documentation</h1>
          <p>This document provides an overview of the application's features, UI, right-click context menus, and a module API reference generated from the source code.</p>
          <p>Version generated on: 2025-10-22 10:07:09</p>
          <p>PDF utilities now include image extraction: embedded artwork and diagrams can be saved directly to each campaign's <code>assets/books/images</code> folder with sensible names derived from the document.</p>
        </section>
        <section id='screenshots'><h2>UI Screenshots</h2><h3>Main Window &amp; Sidebar</h3><figure class='shot'><img src='images/main_window.png' alt='Main Window' /><figcaption>Main Window</figcaption></figure><h3>Entity Managers</h3><figure class='shot'><img src='images/entity_books.png' alt='Entity Books' /><figcaption>Entity Books</figcaption></figure><figure class='shot'><img src='images/entity_clues.png' alt='Entity Clues' /><figcaption>Entity Clues</figcaption></figure><figure class='shot'><img src='images/entity_creatures.png' alt='Entity Creatures' /><figcaption>Entity Creatures</figcaption></figure><figure class='shot'><img src='images/entity_factions.png' alt='Entity Factions' /><figcaption>Entity Factions</figcaption></figure><figure class='shot'><img src='images/entity_informations.png' alt='Entity Informations' /><figcaption>Entity Informations</figcaption></figure><figure class='shot'><img src='images/entity_maps.png' alt='Entity Maps' /><figcaption>Entity Maps</figcaption></figure><figure class='shot'><img src='images/entity_npcs.png' alt='Entity Npcs' /><figcaption>Entity Npcs</figcaption></figure><figure class='shot'><img src='images/entity_objects.png' alt='Entity Objects' /><figcaption>Entity Objects</figcaption></figure><figure class='shot'><img src='images/entity_pcs.png' alt='Entity Pcs' /><figcaption>Entity Pcs</figcaption></figure><figure class='shot'><img src='images/entity_places.png' alt='Entity Places' /><figcaption>Entity Places</figcaption></figure><figure class='shot'><img src='images/entity_scenarios.png' alt='Entity Scenarios' /><figcaption>Entity Scenarios</figcaption></figure><h3>Detail &amp; Editor Windows</h3><figure class='shot'><img src='images/scenario_detail.png' alt='Scenario Detail' /><figcaption>Scenario Detail</figcaption></figure><figure class='shot'><img src='images/scenario_editor.png' alt='Scenario Editor' /><figcaption>Scenario Editor</figcaption></figure><figure class='shot'><img src='images/custom_fields_editor.png' alt='Custom Fields Editor' /><figcaption>Custom Fields Editor</figcaption></figure><h3>Graph Editors</h3><figure class='shot'><img src='images/npc_graph.png' alt='Npc Graph' /><figcaption>Npc Graph</figcaption></figure><figure class='shot'><img src='images/pc_graph.png' alt='Pc Graph' /><figcaption>Pc Graph</figcaption></figure><figure class='shot'><img src='images/faction_graph.png' alt='Faction Graph' /><figcaption>Faction Graph</figcaption></figure><figure class='shot'><img src='images/scenario_graph.png' alt='Scenario Graph' /><figcaption>Scenario Graph</figcaption></figure><h3>GM &amp; Scenario Tools</h3><figure class='shot'><img src='images/gm_screen.png' alt='Gm Screen' /><figcaption>Gm Screen</figcaption></figure><figure class='shot'><img src='images/scenario_generator.png' alt='Scenario Generator' /><figcaption>Scenario Generator</figcaption></figure><figure class='shot'><img src='images/scenario_importer.png' alt='Scenario Importer' /><figcaption>Scenario Importer</figcaption></figure><h3>Map Tools</h3><figure class='shot'><img src='images/map_tool_selector.png' alt='Map Tool Selector' /><figcaption>Map Tool Selector</figcaption></figure><figure class='shot'><img src='images/map_tool_map1.png' alt='Map Tool Map1' /><figcaption>Map Tool Map1</figcaption></figure><figure class='shot'><img src='images/map_tool_map2.png' alt='Map Tool Map2' /><figcaption>Map Tool Map2</figcaption></figure><figure class='shot'><img src='images/map_tool_rectangle.png' alt='Map Tool Rectangle' /><figcaption>Map Tool Rectangle</figcaption></figure><figure class='shot'><img src='images/map_tool_oval.png' alt='Map Tool Oval' /><figcaption>Map Tool Oval</figcaption></figure><h3>Additional Views</h3><figure class='shot'><img src='images/audio_bar.png' alt='Audio Bar' /><figcaption>Audio Bar</figcaption></figure><figure class='shot'><img src='images/book_viewer.png' alt='Book Viewer' /><figcaption>Book Viewer</figcaption></figure><figure class='shot'><img src='images/dice_bar.png' alt='Dice Bar' /><figcaption>Dice Bar</figcaption></figure><figure class='shot'><img src='images/dice_roller.png' alt='Dice Roller' /><figcaption>Dice Roller</figcaption></figure><figure class='shot'><img src='images/scenario_builder.png' alt='Scenario Builder' /><figcaption>Scenario Builder</figcaption></figure><figure class='shot'><img src='images/scene_flow_viewer.png' alt='Scene Flow Viewer' /><figcaption>Scene Flow Viewer</figcaption></figure><figure class='shot'><img src='images/sound_manager.png' alt='Sound Manager' /><figcaption>Sound Manager</figcaption></figure><figure class='shot'><img src='images/world_map.png' alt='World Map' /><figcaption>World Map</figcaption></figure></section><section id='context-menus'><h2>Right-Click Menus</h2><div class='menu-block'><h3>modules\factions\faction_graph_editor.py</h3><ul><li>Delete Faction</li></ul></div>
<div class='menu-block'><h3>modules\generic\entity_detail_factory.py</h3><ul><li>Play Audio</li><li>Stop Audio</li></ul></div>
<div class='menu-block'><h3>modules\generic\generic_list_view.py</h3><ul><li>Open Book</li><li>Extract Pages…</li><li>Edit Details…</li><li>Open in GM Screen</li><li>Display on Second Screen</li><li>Show Portrait</li><li>Copy</li><li>Paste</li><li>Delete</li><li>Clear Color</li><li>Play Audio</li><li>Stop Audio</li><li>Link to Scenario...</li><li>Add to GM Screen...</li><li>Columns...</li><li>Display Fields...</li><li>Open Excerpt</li><li>Row Color</li></ul></div>
<div class='menu-block'><h3>modules\maps\controllers\display_map_controller.py</h3><ul><li>Open Linked Map</li><li>Set Linked Map...</li><li>Clear Linked Map</li><li>Edit Description</li><li>Attach Video...</li><li>Play Video on Second Screen</li><li>Edit Shape Graphically</li><li>Bring to Front</li><li>Send to Back</li><li>Show Portrait</li><li>Show Portraits</li><li>Play Audio</li><li>Stop Audio</li></ul></div>
<div class='menu-block'><h3>modules\maps\world_map_view.py</h3><ul><li>Resize?</li><li>Change Color</li><li>Delete</li></ul></div>
<div class='menu-block'><h3>modules\npcs\npc_graph_editor.py</h3><ul><li>No Arrows</li><li>Arrow at Start</li><li>Arrow at End</li><li>Arrows at Both Ends</li><li>Delete Node</li><li>Change Color</li><li>Display Portrait Window</li><li>Play Audio</li><li>Stop Audio</li><li>Change shape size</li><li>Bring to Front</li><li>Send to Back</li><li>Delete Shape</li><li>Arrow Mode</li></ul></div>
<div class='menu-block'><h3>modules\pcs\pc_graph_editor.py</h3><ul><li>No Arrows</li><li>Arrow at Start</li><li>Arrow at End</li><li>Arrows at Both Ends</li><li>Delete Node</li><li>Change Color</li><li>Display Portrait Window</li><li>Play Audio</li><li>Stop Audio</li><li>Change shape size</li><li>Bring to Front</li><li>Send to Back</li><li>Delete Shape</li><li>Arrow Mode</li></ul></div>
<div class='menu-block'><h3>modules\scenarios\gm_screen_view.py</h3><ul><li>Mark Active Scene Complete</li><li>Mark Next Scene Complete</li><li>Add Timestamped Note</li></ul></div>
<div class='menu-block'><h3>modules\scenarios\scenario_builder_wizard.py</h3><ul><li>Add Scene</li><li>Edit Scenario Notes</li><li>Edit Scene Inline</li><li>Duplicate Scene</li><li>Remove Scene</li><li>Clear All</li><li>Remove Link</li></ul></div>
<div class='menu-block'><h3>modules\scenarios\scenario_graph_editor.py</h3><ul><li>Delete Node</li><li>Change Color</li><li>Display Portrait</li><li>Play Audio</li><li>Stop Audio</li></ul></div>
<div class='menu-block'><h3>modules\web\templates\clues.html</h3><ul><li>Edit Clue</li><li>Add Link</li><li>Delete Clue</li></ul></div>
<div class='menu-block'><h3>modules\web\templates\clues.html</h3><ul><li>Delete Link</li></ul></div></section><section id='api'><h2>Module API Reference</h2><section class='module'><h3>campaign_generator.py</h3><p>campaign_generator_ui.py
------------------------

This module provides a simple graphical interface for generating
role‑playing game campaigns based on different settings: Fantasy,
Science‑Fiction, Modern and Post‑Apocalyptic.  The UI is built using
Tkinter with ttk widgets for a clean look.  Users select a setting,
generate a random campaign using the corresponding generator module,
view the results, and export the details to a Word (.docx) document.

The program falls back on a minimal DOCX implementation to avoid
requiring external libraries.  It creates a valid Word document by
zipping together the necessary XML parts whenever the user chooses to
export.

To run the application: ``python3 campaign_generator_ui.py``.  A window
will open allowing you to select the setting and generate a campaign.</p><h4>Functions</h4><ul><li><code>roll(table: List[str])</code> &ndash; Return a random entry from a table. Parameters: table (type List[str]). Returns: str.</li><li><code>generate_fantasy_campaign()</code> &ndash; Generate a random fantasy campaign outline using detailed paragraphs.

Each entry is constructed by rolling multiple times on various tables to
produce a longer, multi‑sentence description.  Seeds from the
FlexTale tables are occasionally used as the first component to retain
authenticity, but additional random rolls flesh out the context,
motives, hazards and rewards.  This approach satisfies the request
for longer entries while still ensuring hundreds of unique
combinations per category. Returns: Dict[str, str].</li><li><code>generate_scifi_campaign()</code> &ndash; Generate a random science‑fiction campaign with detailed paragraphs.

Like the fantasy generator, this function uses multi‑roll
compositions to create rich descriptions for each campaign element.
The variety of table entries combined with additional context and
hazards ensures a large pool of possible outputs. Returns: Dict[str, str].</li><li><code>generate_modern_campaign()</code> &ndash; Generate a random modern campaign with detailed descriptions.

Uses the same composition functions as other settings to provide
extended narrative elements and ensure depth for each field.  This
satisfies the requirement for longer entries built from multiple
rolls. Returns: Dict[str, str].</li><li><code>generate_postapoc_campaign()</code> &ndash; Generate a random post‑apocalyptic campaign with richly detailed entries.

Leverages the same multi‑roll composition functions to craft
descriptive paragraphs, blending seeds from the source tables with
additional context and flavour unique to the wasteland. Returns: Dict[str, str].</li><li><code>generate_starting_location(setting: str)</code> &ndash; Generate a starting location string for the given setting. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_starting(setting: str)</code> &ndash; Compose a longer starting location description using multiple random rolls.

This function stitches together several generated fragments to build a
multi‑sentence paragraph.  It begins with a seed or constructed
starting location, mentions at least one nearby region, introduces
two NPCs or hazards, and hints at an emerging rumour or quest item. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_quest(setting: str)</code> &ndash; Compose a longer quest description by combining multiple quests and hooks.

A primary quest is joined by two side objectives, and multiple
motivations are referenced to weave a complex storyline.  This
ensures that the adventure feels layered and detailed. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_hook(setting: str)</code> &ndash; Compose a longer quest hook by combining multiple reasons and contexts.

This merges several hooks into a single narrative, offering
overlapping incentives or pressures that drive the party towards
action. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_giver(setting: str)</code> &ndash; Compose a longer quest giver description.

The quest giver is fleshed out by introducing additional allies or
rivals and by foreshadowing both the rewards and the consequences
associated with the mission.  A final hook ties their motives to
the overarching plot. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_npc(setting: str)</code> &ndash; Compose a longer NPC description with secrets or motives.

Two NPCs are described in detail, with hidden identities, alliances
and secret motivations.  Additional hooks hint at why they are
connected to the heroes. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_region(setting: str)</code> &ndash; Compose a longer region description including hazards.

This function describes multiple adjacent regions, their unique
qualities and hazards, and sometimes hints at secrets or rewards
buried within. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_distance(setting: str)</code> &ndash; Compose a longer travel distance with obstacles.

Describes the primary journey and a secondary leg of travel while
mentioning terrain and potential hazards.  This builds a sense of
the arduousness of the trip. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_encounter(setting: str)</code> &ndash; Compose a longer encounter description combining multiple hazards.

Two or more random encounters are chained together to create a
challenging and varied sequence of events. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_reward(setting: str)</code> &ndash; Compose a longer reward description combining tangible and intangible prizes.

A trio of rewards is described, including a special quest item and
hints of bonus advantages such as knowledge or favours. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_penalty(setting: str)</code> &ndash; Compose a longer penalty description combining multiple negative outcomes.

Multiple penalties are chained together, with additional hazards and
hooks hinting at the reasons for the failures.  This makes the
consequences feel weighty and narrative. Parameters: setting (type str). Returns: str.</li><li><code>compose_detailed_item(setting: str)</code> &ndash; Compose a longer quest item description combining different properties.

Multiple unique items are described together, along with hints of
rewards and penalties associated with their possession.  This
encourages the party to weigh the risks and benefits. Parameters: setting (type str). Returns: str.</li><li><code>generate_quest_template(setting: str)</code> &ndash; Generate a quest template string. Parameters: setting (type str). Returns: str.</li><li><code>generate_quest_hook(setting: str)</code> &ndash; Generate a quest hook string. Parameters: setting (type str). Returns: str.</li><li><code>generate_quest_giver(setting: str)</code> &ndash; Generate a quest giver description. Parameters: setting (type str). Returns: str.</li><li><code>generate_npc(setting: str)</code> &ndash; Generate a key NPC description. Parameters: setting (type str). Returns: str.</li><li><code>generate_region(setting: str)</code> &ndash; Generate a region description. Parameters: setting (type str). Returns: str.</li><li><code>generate_distance(setting: str)</code> &ndash; Generate a travel distance string. Parameters: setting (type str). Returns: str.</li><li><code>generate_random_encounter(setting: str)</code> &ndash; Generate a random encounter description. Parameters: setting (type str). Returns: str.</li><li><code>generate_reward(setting: str)</code> &ndash; Generate a reward description. Parameters: setting (type str). Returns: str.</li><li><code>generate_penalty(setting: str)</code> &ndash; Generate a penalty description. Parameters: setting (type str). Returns: str.</li><li><code>generate_quest_item(setting: str)</code> &ndash; Generate a quest item description. Parameters: setting (type str). Returns: str.</li><li><code>export_to_docx(campaign: Dict[str, str], filename: str)</code> &ndash; Create a DOCX file containing the campaign information with styled headings and text. Parameters: campaign (type Dict[str, str]); filename (type str). Returns: None.</li><li><code>main()</code> &ndash; Returns: None.</li></ul><div class='class'><h4>class CampaignGeneratorApp (tk.Tk)</h4><p>Main application window for generating campaigns.</p><ul><li><code>__init__(self)</code> &ndash; Returns: None.</li><li><code>_create_widgets(self)</code> &ndash; Returns: None.</li><li><code>generate_campaign(self)</code> &ndash; Generate and display a campaign for the selected setting. Returns: None.</li><li><code>export_campaign(self)</code> &ndash; Returns: None.</li><li><code>export_campaign_json(self)</code> &ndash; Export the current campaign to a JSON file using the provided template.

The generated scenario is converted into a dictionary with fields
Title, Summary, Secrets, Places and NPCs.  Summary and Secrets are
stored as objects containing text and empty formatting lists to
mirror the example template.  If the chosen file already exists
and contains a JSON list, the scenario will be appended; otherwise
a new list is created. Returns: None.</li></ul></div></section>
<section class='module'><h3>main_window.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class MainWindow (ctk.CTk)</h4><p></p><ul><li><code>__init__(self)</code> &ndash; No inline documentation available.</li><li><code>open_ai_settings(self)</code> &ndash; No inline documentation available.</li><li><code>set_window_icon(self)</code> &ndash; No inline documentation available.</li><li><code>create_layout(self)</code> &ndash; No inline documentation available.</li><li><code>load_icons(self)</code> &ndash; No inline documentation available.</li><li><code>open_custom_fields_editor(self)</code> &ndash; No inline documentation available.</li><li><code>open_cross_campaign_asset_library(self)</code> &ndash; No inline documentation available.</li><li><code>open_new_entity_type_dialog(self)</code> &ndash; No inline documentation available.</li><li><code>load_icon(self, file_name, size=(60, 60))</code> &ndash; Parameters: file_name; size (default (60, 60)).</li><li><code>create_sidebar(self)</code> &ndash; No inline documentation available.</li><li><code>update_sidebar_metadata(self)</code> &ndash; No inline documentation available.</li><li><code>open_system_selector(self)</code> &ndash; No inline documentation available.</li><li><code>_on_system_selector_destroyed(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>create_accordion_sidebar(self)</code> &ndash; No inline documentation available.</li><li><code>create_content_area(self)</code> &ndash; No inline documentation available.</li><li><code>_toggle_banner(self)</code> &ndash; No inline documentation available.</li><li><code>get_content_container(self)</code> &ndash; Choose correct parent depending on banner state.</li><li><code>create_exit_button(self)</code> &ndash; No inline documentation available.</li><li><code>_apply_cursor_recursive(self, widget, cursor)</code> &ndash; Parameters: widget; cursor.</li><li><code>_set_wait_cursor(self, enable)</code> &ndash; Parameters: enable.</li><li><code>_show_busy_modal(self, message)</code> &ndash; Parameters: message.</li><li><code>_hide_busy_modal(self)</code> &ndash; No inline documentation available.</li><li><code>_busy_operation(self, message)</code> &ndash; Parameters: message.</li><li><code>load_model_config(self)</code> &ndash; No inline documentation available.</li><li><code>init_wrappers(self)</code> &ndash; No inline documentation available.</li><li><code>_normalize_entity_media_paths(self)</code> &ndash; Ensure stored portrait/image paths are relative within the campaign.</li><li><code>_normalize_single_media_path(self, value, base_candidates)</code> &ndash; Return normalized (relative) path for portraits/images. Parameters: value; base_candidates.</li><li><code>_is_absolute_path(path_value: str)</code> &ndash; Parameters: path_value (type str). Returns: bool.</li><li><code>refresh_entities(self, *_)</code> &ndash; Parameters: _ (variadic positional).</li><li><code>open_faction_graph_editor(self)</code> &ndash; No inline documentation available.</li><li><code>clear_current_content(self)</code> &ndash; No inline documentation available.</li><li><code>move_current_view(self)</code> &ndash; Move the current open view to the correct container based on banner state.</li><li><code>open_entity(self, entity)</code> &ndash; Parameters: entity.</li><li><code>save_items_to_json(self, view, entity_name)</code> &ndash; Parameters: view; entity_name.</li><li><code>load_items_from_json(self, view, entity_name)</code> &ndash; Parameters: view; entity_name.</li><li><code>open_gm_screen(self)</code> &ndash; No inline documentation available.</li><li><code>open_npc_graph_editor(self)</code> &ndash; No inline documentation available.</li><li><code>open_pc_graph_editor(self)</code> &ndash; No inline documentation available.</li><li><code>open_world_map(self)</code> &ndash; Launch the World Map nested navigation window.</li><li><code>open_scenario_graph_editor(self)</code> &ndash; No inline documentation available.</li><li><code>open_scene_flow_viewer(self)</code> &ndash; No inline documentation available.</li><li><code>export_foundry(self)</code> &ndash; No inline documentation available.</li><li><code>_run_progress_task(self, title, worker, success_message, detail_builder=None)</code> &ndash; Parameters: title; worker; success_message; detail_builder (default None).</li><li><code>_format_backup_summary(self, manifest: dict | None, *, include_target: bool)</code> &ndash; Parameters: manifest (type dict | None); include_target (keyword-only, type bool). Returns: str.</li><li><code>prompt_campaign_backup(self)</code> &ndash; No inline documentation available.</li><li><code>_sanitize_campaign_name(name: str)</code> &ndash; Parameters: name (type str). Returns: str.</li><li><code>prompt_campaign_restore(self)</code> &ndash; No inline documentation available.</li><li><code>open_scenario_importer(self)</code> &ndash; No inline documentation available.</li><li><code>_on_scenario_built(self)</code> &ndash; No inline documentation available.</li><li><code>open_creature_importer(self)</code> &ndash; No inline documentation available.</li><li><code>open_object_importer(self)</code> &ndash; No inline documentation available.</li><li><code>open_scenario_generator(self)</code> &ndash; No inline documentation available.</li><li><code>open_scenario_builder(self)</code> &ndash; No inline documentation available.</li><li><code>change_database_storage(self)</code> &ndash; No inline documentation available.</li><li><code>select_swarmui_path(self)</code> &ndash; No inline documentation available.</li><li><code>launch_swarmui(self)</code> &ndash; No inline documentation available.</li><li><code>cleanup_swarmui(self)</code> &ndash; No inline documentation available.</li><li><code>generate_missing_portraits(self)</code> &ndash; No inline documentation available.</li><li><code>generate_missing_npc_portraits(self)</code> &ndash; No inline documentation available.</li><li><code>generate_portraits_continue_npcs(self)</code> &ndash; No inline documentation available.</li><li><code>generate_missing_creature_portraits(self)</code> &ndash; No inline documentation available.</li><li><code>generate_portraits_continue_creatures(self)</code> &ndash; No inline documentation available.</li><li><code>generate_portrait_for_npc(self, npc)</code> &ndash; Parameters: npc.</li><li><code>generate_portrait_for_creature(self, creature)</code> &ndash; Parameters: creature.</li><li><code>copy_and_resize_portrait(self, entity, src_path)</code> &ndash; Parameters: entity; src_path.</li><li><code>import_portraits_from_directory(self)</code> &ndash; Match and import portraits from a directory for all portrait-capable entities.</li><li><code>preview_and_export_scenarios(self)</code> &ndash; No inline documentation available.</li><li><code>preview_and_save(self, selected_scenarios)</code> &ndash; Parameters: selected_scenarios.</li><li><code>apply_formatting(self, run, formatting)</code> &ndash; Parameters: run; formatting.</li><li><code>normalize_name(self, name)</code> &ndash; Parameters: name.</li><li><code>build_portrait_mapping(self)</code> &ndash; No inline documentation available.</li><li><code>associate_npc_portraits(self)</code> &ndash; No inline documentation available.</li><li><code>_on_ctrl_f(self, event=None)</code> &ndash; Global Ctrl+F binding: only opens search when GM screen is active. Parameters: event (default None).</li><li><code>open_audio_bar(self)</code> &ndash; No inline documentation available.</li><li><code>_on_audio_bar_destroyed(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>open_dice_bar(self)</code> &ndash; No inline documentation available.</li><li><code>_on_dice_bar_destroyed(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>_on_system_changed(self, _config)</code> &ndash; Refresh open dice windows when the campaign system changes. Parameters: _config. Returns: None.</li><li><code>_reload_active_campaign_system(self)</code> &ndash; Force the system configuration to match the active campaign DB. Returns: None.</li><li><code>destroy(self)</code> &ndash; Returns: None.</li><li><code>open_sound_manager(self)</code> &ndash; No inline documentation available.</li><li><code>_on_sound_manager_destroyed(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>open_dice_roller(self)</code> &ndash; No inline documentation available.</li><li><code>_on_dice_window_destroyed(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>map_tool(self, map_name=None)</code> &ndash; Parameters: map_name (default None).</li></ul></div></section>
<section class='module'><h3>modules\ai\authoring_wizard.py</h3><p></p><h4>Functions</h4><ul><li><code>_parse_json_relaxed(s: str)</code> &ndash; Parameters: s (type str).</li></ul><div class='class'><h4>class AuthoringWizardView (ctk.CTkFrame)</h4><p>AI-assisted authoring for NPCs and Scenarios with presets and checks.</p><ul><li><code>__init__(self, parent)</code> &ndash; Parameters: parent.</li><li><code>_build_layout(self)</code> &ndash; No inline documentation available.</li><li><code>select_for(self, entity_type: str)</code> &ndash; Select default tab based on entity type (e.g., 'npcs' or 'scenarios'). Parameters: entity_type (type str).</li><li><code>_build_tab_npc(self, tab)</code> &ndash; Parameters: tab.</li><li><code>_build_tab_scenario(self, tab)</code> &ndash; Parameters: tab.</li><li><code>_build_tab_beats(self, tab)</code> &ndash; Parameters: tab.</li><li><code>_lore_digest(self, max_chars: int=2000)</code> &ndash; Parameters: max_chars (type int, default 2000). Returns: str.</li><li><code>_short(val, n=120)</code> &ndash; Parameters: val; n (default 120).</li><li><code>_system_hdr(self)</code> &ndash; No inline documentation available.</li><li><code>_with_lore(self, prompt: str)</code> &ndash; Parameters: prompt (type str). Returns: str.</li><li><code>_chat_json(self, user_prompt: str)</code> &ndash; Parameters: user_prompt (type str). Returns: dict.</li><li><code>_chat_text(self, user_prompt: str)</code> &ndash; Parameters: user_prompt (type str). Returns: str.</li><li><code>_format_kv(self, key, value)</code> &ndash; Parameters: key; value.</li><li><code>_format_list(self, title, items)</code> &ndash; Parameters: title; items.</li><li><code>_format_npc_text(self, data: dict)</code> &ndash; Parameters: data (type dict). Returns: str.</li><li><code>_format_scenario_text(self, data: dict)</code> &ndash; Parameters: data (type dict). Returns: str.</li><li><code>_as_text(val)</code> &ndash; Coerce arbitrary value to displayable text. Parameters: val.</li><li><code>generate_npc(self)</code> &ndash; No inline documentation available.</li><li><code>check_npc_consistency(self)</code> &ndash; No inline documentation available.</li><li><code>save_npc(self)</code> &ndash; No inline documentation available.</li><li><code>generate_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>check_scenario_consistency(self)</code> &ndash; No inline documentation available.</li><li><code>save_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>expand_beat(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\ai\local_ai_client.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class LocalAIClient</h4><p>Minimal OpenAI-compatible chat client for local models (e.g., gpt-oss,
LM Studio, Ollama OpenAI adapter, text-gen webui proxy).

Reads configuration from [AI] in config/config.ini:
  - base_url: server base (e.g., http://localhost:8080)
  - api_key: optional token if your server requires it
  - model:   model name/id to request
  - temperature: default generation temperature (float)
  - max_tokens:  optional default max tokens (int)
  - use_powershell: if true on Windows, call via PowerShell
                    Invoke-WebRequest (default true on Windows)</p><ul><li><code>__init__(self)</code> &ndash; No inline documentation available.</li><li><code>_parse_json_safe(s: str)</code> &ndash; Parse JSON from a string that may contain extra leading/trailing text. Parameters: s (type str).</li><li><code>_parse_markdown_table(text: str)</code> &ndash; Parse the first markdown table found in text into a list of dicts. Parameters: text (type str).</li><li><code>_powershell_generate(self, url, payload, headers)</code> &ndash; POST to url using PowerShell Invoke-WebRequest.

Returns parsed JSON dict. Parameters: url; payload; headers.</li><li><code>chat(self, messages, model=None, temperature=None, max_tokens=None, timeout=600)</code> &ndash; Send a chat completion request and return the assistant's text.

messages: list[{role, content}] per OpenAI API Parameters: messages; model (default None); temperature (default None); max_tokens (default None); timeout (default 600).</li></ul></div></section>
<section class='module'><h3>modules\audio\audio_bar_window.py</h3><p>Compact always-on-top audio controller widget.</p><h4>Functions</h4><ul></ul><div class='class'><h4>class AudioBarWindow (ctk.CTkToplevel)</h4><p>Light-weight controller that mirrors the shared audio state.</p><ul><li><code>__init__(self, master: tk.Misc | None=None, *, controller: Optional[AudioController]=None)</code> &ndash; Parameters: master (type tk.Misc | None, default None); controller (keyword-only, type Optional[AudioController], default None). Returns: None.</li><li><code>_build_ui(self)</code> &ndash; Returns: None.</li><li><code>_keep_search_dropdown_width(self, *_args: Any)</code> &ndash; Parameters: _args (variadic positional, type Any). Returns: None.</li><li><code>_keep_now_playing_dropdown_width(self, *_args: Any)</code> &ndash; Parameters: _args (variadic positional, type Any). Returns: None.</li><li><code>_register_controller_listener(self)</code> &ndash; Returns: None.</li><li><code>_detach_controller_listener(self)</code> &ndash; Returns: None.</li><li><code>_dispatch_controller_event(self, section: str, event: str, payload: Dict[str, Any])</code> &ndash; Parameters: section (type str); event (type str); payload (type Dict[str, Any]). Returns: None.</li><li><code>_handle_controller_event(self, section: str, event: str, payload: Dict[str, Any])</code> &ndash; Parameters: section (type str); event (type str); payload (type Dict[str, Any]). Returns: None.</li><li><code>_toggle_section(self)</code> &ndash; Returns: None.</li><li><code>_on_track_selected(self, choice: str)</code> &ndash; Parameters: choice (type str). Returns: None.</li><li><code>_on_search_submitted(self, _event: tk.Event | None=None)</code> &ndash; Parameters: _event (type tk.Event | None, default None). Returns: None.</li><li><code>_on_search_text_changed(self, _event: tk.Event | None=None)</code> &ndash; Parameters: _event (type tk.Event | None, default None). Returns: None.</li><li><code>_perform_search(self)</code> &ndash; Returns: None.</li><li><code>_on_search_result_selected(self, choice: str)</code> &ndash; Parameters: choice (type str). Returns: None.</li><li><code>_apply_search_result(self, info: Dict[str, Any])</code> &ndash; Parameters: info (type Dict[str, Any]). Returns: None.</li><li><code>_clear_search_results(self)</code> &ndash; Returns: None.</li><li><code>_on_play_clicked(self)</code> &ndash; Returns: None.</li><li><code>_on_pause_clicked(self)</code> &ndash; Returns: None.</li><li><code>_on_stop_clicked(self)</code> &ndash; Returns: None.</li><li><code>_on_next_clicked(self)</code> &ndash; Returns: None.</li><li><code>_on_prev_clicked(self)</code> &ndash; Returns: None.</li><li><code>_on_shuffle_toggle(self)</code> &ndash; Returns: None.</li><li><code>_on_loop_toggle(self)</code> &ndash; Returns: None.</li><li><code>_on_continue_toggle(self)</code> &ndash; Returns: None.</li><li><code>_on_volume_changed(self, value: float)</code> &ndash; Parameters: value (type float). Returns: None.</li><li><code>_refresh_from_state(self, section: Optional[str]=None)</code> &ndash; Parameters: section (type Optional[str], default None). Returns: None.</li><li><code>_apply_volume(self, value: Any)</code> &ndash; Parameters: value (type Any). Returns: None.</li><li><code>_update_status_from_state(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_update_button_states(self, state: Dict[str, Any])</code> &ndash; Parameters: state (type Dict[str, Any]). Returns: None.</li><li><code>_update_playlist_menu(self, playlist: list[Dict[str, Any]])</code> &ndash; Parameters: playlist (type list[Dict[str, Any]]). Returns: None.</li><li><code>_find_label_for_track(self, track: Dict[str, Any])</code> &ndash; Parameters: track (type Dict[str, Any]). Returns: Optional[str].</li><li><code>_find_label_for_identifier(self, identifier: str)</code> &ndash; Parameters: identifier (type str). Returns: Optional[str].</li><li><code>_set_selected_track_by_label(self, label: str)</code> &ndash; Parameters: label (type str). Returns: None.</li><li><code>_get_selected_track_info(self)</code> &ndash; Returns: Optional[Dict[str, Any]].</li><li><code>_apply_pending_selection(self)</code> &ndash; Returns: None.</li><li><code>_track_identifier(track: Dict[str, Any])</code> &ndash; Parameters: track (type Dict[str, Any]). Returns: str.</li><li><code>_format_track_label(track: Dict[str, Any])</code> &ndash; Parameters: track (type Dict[str, Any]). Returns: str.</li><li><code>_make_dropdown_label(self, label: str, existing: set[str], max_chars: int)</code> &ndash; Parameters: label (type str); existing (type set[str]); max_chars (type int). Returns: str.</li><li><code>_truncate_with_suffix(label: str, max_chars: int, suffix: str="")</code> &ndash; Parameters: label (type str); max_chars (type int); suffix (type str, default ""). Returns: str.</li><li><code>_section_button_label(self, section: str)</code> &ndash; Parameters: section (type str). Returns: str.</li><li><code>_apply_geometry(self)</code> &ndash; Returns: None.</li><li><code>_toggle_collapsed(self)</code> &ndash; Returns: None.</li><li><code>_set_collapsed(self, collapsed: bool)</code> &ndash; Parameters: collapsed (type bool). Returns: None.</li><li><code>_update_collapse_button(self)</code> &ndash; Returns: None.</li><li><code>show(self)</code> &ndash; Returns: None.</li><li><code>_on_destroy_event(self, event: tk.Event)</code> &ndash; Parameters: event (type tk.Event). Returns: None.</li><li><code>_on_close(self)</code> &ndash; Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\audio\audio_constants.py</h3><p>Shared constants for audio UI components.</p><h4>Functions</h4><ul></ul></section>
<section class='module'><h3>modules\audio\audio_controller.py</h3><p>Centralized audio controller shared across UI windows.</p><h4>Functions</h4><ul><li><code>get_audio_controller()</code> &ndash; Return the shared :class:`AudioController` instance. Returns: AudioController.</li></ul><div class='class'><h4>class AudioController</h4><p>Coordinates shared audio playback state.</p><ul><li><code>__init__(self, library: Optional[AudioLibrary]=None)</code> &ndash; Parameters: library (type Optional[AudioLibrary], default None). Returns: None.</li><li><code>add_listener(self, callback: ControllerListener)</code> &ndash; Parameters: callback (type ControllerListener). Returns: None.</li><li><code>remove_listener(self, callback: ControllerListener)</code> &ndash; Parameters: callback (type ControllerListener). Returns: None.</li><li><code>_emit(self, event: str, section: str, payload: Optional[Dict[str, Any]]=None, **extra: Any)</code> &ndash; Parameters: event (type str); section (type str); payload (type Optional[Dict[str, Any]], default None); extra (variadic keyword, type Any). Returns: None.</li><li><code>set_playlist(self, section: str, tracks: Iterable[Dict[str, Any]], *, category: Optional[str]=None)</code> &ndash; Parameters: section (type str); tracks (type Iterable[Dict[str, Any]]); category (keyword-only, type Optional[str], default None). Returns: None.</li><li><code>play(self, section: str, *, start_index: Optional[int]=None, track_id: Optional[str]=None)</code> &ndash; Parameters: section (type str); start_index (keyword-only, type Optional[int], default None); track_id (keyword-only, type Optional[str], default None). Returns: bool.</li><li><code>pause(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>stop(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>next(self, section: str)</code> &ndash; Parameters: section (type str). Returns: bool.</li><li><code>previous(self, section: str)</code> &ndash; Parameters: section (type str). Returns: bool.</li><li><code>set_shuffle(self, section: str, enabled: bool)</code> &ndash; Parameters: section (type str); enabled (type bool). Returns: None.</li><li><code>set_loop(self, section: str, enabled: bool)</code> &ndash; Parameters: section (type str); enabled (type bool). Returns: None.</li><li><code>set_continue(self, section: str, enabled: bool)</code> &ndash; Parameters: section (type str); enabled (type bool). Returns: None.</li><li><code>set_volume(self, section: str, value: float)</code> &ndash; Parameters: section (type str); value (type float). Returns: None.</li><li><code>get_state(self, section: str)</code> &ndash; Parameters: section (type str). Returns: Dict[str, Any].</li><li><code>get_last_error(self, section: str)</code> &ndash; Parameters: section (type str). Returns: str.</li><li><code>_initial_state(self, section: str)</code> &ndash; Parameters: section (type str). Returns: Dict[str, Any].</li><li><code>_restore_last_playlist(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_get_player(self, section: str)</code> &ndash; Parameters: section (type str). Returns: AudioPlayer.</li><li><code>_update_last_error(self, section: str, message: str)</code> &ndash; Parameters: section (type str); message (type str). Returns: None.</li><li><code>_handle_player_event(self, section: str, event: str, payload: Dict[str, Any])</code> &ndash; Parameters: section (type str); event (type str); payload (type Dict[str, Any]). Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\audio\audio_library.py</h3><p></p><h4>Functions</h4><ul></ul></section>
<section class='module'><h3>modules\audio\audio_player.py</h3><p></p><h4>Functions</h4><ul><li><code>create_backend()</code> &ndash; Returns: BaseAudioBackend.</li></ul><div class='class'><h4>class AudioBackendError (Exception)</h4><p>Raised when the underlying audio backend fails.</p><ul></ul></div><div class='class'><h4>class BaseAudioBackend</h4><p>Abstract backend interface.</p><ul><li><code>load(self, path: str)</code> &ndash; Parameters: path (type str). Returns: None.</li><li><code>play(self, *, loop: bool=False)</code> &ndash; Parameters: loop (keyword-only, type bool, default False). Returns: None.</li><li><code>stop(self)</code> &ndash; Returns: None.</li><li><code>is_active(self)</code> &ndash; Returns: bool.</li><li><code>set_volume(self, volume: float)</code> &ndash; Parameters: volume (type float). Returns: None.</li><li><code>close(self)</code> &ndash; Returns: None.</li><li><code>supports_polling(self)</code> &ndash; Returns: bool.</li></ul></div><div class='class'><h4>class NullAudioBackend (BaseAudioBackend)</h4><p>Fallback backend when no audio support is available.</p><ul><li><code>__init__(self)</code> &ndash; Returns: None.</li><li><code>load(self, path: str)</code> &ndash; Parameters: path (type str). Returns: None.</li><li><code>play(self, *, loop: bool=False)</code> &ndash; Parameters: loop (keyword-only, type bool, default False). Returns: None.</li><li><code>stop(self)</code> &ndash; Returns: None.</li><li><code>is_active(self)</code> &ndash; Returns: bool.</li><li><code>set_volume(self, volume: float)</code> &ndash; Parameters: volume (type float). Returns: None.</li><li><code>close(self)</code> &ndash; Returns: None.</li><li><code>supports_polling(self)</code> &ndash; Returns: bool.</li></ul></div><div class='class'><h4>class WinMMAudioBackend (BaseAudioBackend)</h4><p>Audio backend built on top of winsound with optional transcoding.</p><ul><li><code>__init__(self)</code> &ndash; Returns: None.</li><li><code>load(self, path: str)</code> &ndash; Parameters: path (type str). Returns: None.</li><li><code>play(self, *, loop: bool=False)</code> &ndash; Parameters: loop (keyword-only, type bool, default False). Returns: None.</li><li><code>stop(self)</code> &ndash; Returns: None.</li><li><code>is_active(self)</code> &ndash; Returns: bool.</li><li><code>set_volume(self, volume: float)</code> &ndash; Parameters: volume (type float). Returns: None.</li><li><code>close(self)</code> &ndash; Returns: None.</li><li><code>supports_polling(self)</code> &ndash; Returns: bool.</li><li><code>_reset_timer(self)</code> &ndash; Returns: None.</li><li><code>_cancel_timer(self)</code> &ndash; Returns: None.</li><li><code>_on_track_finished(self)</code> &ndash; Returns: None.</li><li><code>_prepare_playback(self, path: str)</code> &ndash; Parameters: path (type str). Returns: tuple[str, float].</li><li><code>_get_wav_duration(self, path: str)</code> &ndash; Parameters: path (type str). Returns: float.</li><li><code>_transcode_to_wav(self, path: str, fallback_error: Exception | None=None)</code> &ndash; Parameters: path (type str); fallback_error (type Exception | None, default None). Returns: tuple[str, float].</li><li><code>_cleanup_temp(self)</code> &ndash; Returns: None.</li><li><code>_get_device_volume_raw(self)</code> &ndash; Returns: Optional[int].</li><li><code>_set_device_volume(self, volume: float)</code> &ndash; Parameters: volume (type float). Returns: bool.</li><li><code>_restore_initial_volume(self)</code> &ndash; Returns: None.</li></ul></div><div class='class'><h4>class AudioPlayer</h4><p>High-level playlist and playback controller.</p><ul><li><code>__init__(self, backend: Optional[BaseAudioBackend]=None, *, poll_interval: float=0.5)</code> &ndash; Parameters: backend (type Optional[BaseAudioBackend], default None); poll_interval (keyword-only, type float, default 0.5). Returns: None.</li><li><code>add_listener(self, callback: EventCallback)</code> &ndash; Parameters: callback (type EventCallback). Returns: None.</li><li><code>remove_listener(self, callback: EventCallback)</code> &ndash; Parameters: callback (type EventCallback). Returns: None.</li><li><code>_emit(self, event: str, **payload: Any)</code> &ndash; Parameters: event (type str); payload (variadic keyword, type Any). Returns: None.</li><li><code>set_playlist(self, tracks: List[Dict[str, Any]])</code> &ndash; Parameters: tracks (type List[Dict[str, Any]]). Returns: None.</li><li><code>play(self, start_index: Optional[int]=None)</code> &ndash; Parameters: start_index (type Optional[int], default None). Returns: bool.</li><li><code>play_track_id(self, track_id: str)</code> &ndash; Parameters: track_id (type str). Returns: bool.</li><li><code>stop(self)</code> &ndash; Returns: None.</li><li><code>_start_track(self, index: int)</code> &ndash; Parameters: index (type int). Returns: bool.</li><li><code>next(self)</code> &ndash; Returns: bool.</li><li><code>previous(self)</code> &ndash; Returns: bool.</li><li><code>set_shuffle(self, enabled: bool)</code> &ndash; Parameters: enabled (type bool). Returns: None.</li><li><code>set_loop(self, enabled: bool)</code> &ndash; Parameters: enabled (type bool). Returns: None.</li><li><code>set_continue(self, enabled: bool)</code> &ndash; Parameters: enabled (type bool). Returns: None.</li><li><code>set_volume(self, value: float)</code> &ndash; Parameters: value (type float). Returns: None.</li><li><code>is_playing(self)</code> &ndash; Returns: bool.</li><li><code>current_track(self)</code> &ndash; Returns: Optional[Dict[str, Any]].</li><li><code>playlist(self)</code> &ndash; Returns: List[Dict[str, Any]].</li><li><code>last_error(self)</code> &ndash; Returns: str.</li><li><code>_monitor_loop(self)</code> &ndash; Returns: None.</li><li><code>_advance_after_track(self)</code> &ndash; Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\audio\entity_audio.py</h3><p>Utility helpers for playing entity-specific audio cues.</p><h4>Functions</h4><ul><li><code>normalize_audio_reference(value: Any)</code> &ndash; Normalize stored audio metadata into a plain string reference. Parameters: value (type Any). Returns: str.</li><li><code>get_entity_audio_value(record: Any)</code> &ndash; Extract an audio reference from an entity record or value. Parameters: record (type Any). Returns: str.</li><li><code>_get_player()</code> &ndash; Returns: AudioPlayer.</li><li><code>resolve_audio_path(value: str | os.PathLike[str])</code> &ndash; Return an absolute path for an audio reference stored in the campaign. Parameters: value (type str | os.PathLike[str]). Returns: str.</li><li><code>play_entity_audio(value: str | os.PathLike[str], *, entity_label: str="")</code> &ndash; Play a single audio track associated with an entity.

Parameters
----------
value:
    Path (relative or absolute) to the audio file.
entity_label:
    Friendly name used in log output and UI messages. Parameters: value (type str | os.PathLike[str]); entity_label (keyword-only, type str, default ""). Returns: bool.</li><li><code>stop_entity_audio()</code> &ndash; Stop the currently playing entity audio track, if any. Returns: None.</li></ul></section>
<section class='module'><h3>modules\audio\sound_manager_window.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class SoundManagerWindow (ctk.CTkToplevel)</h4><p>Utility window for organizing and playing music and sound effects.</p><ul><li><code>__init__(self, master: tk.Misc | None=None, *, controller: AudioController | None=None)</code> &ndash; Parameters: master (type tk.Misc | None, default None); controller (keyword-only, type AudioController | None, default None). Returns: None.</li><li><code>_build_ui(self)</code> &ndash; Returns: None.</li><li><code>_build_section(self, parent: Any, section: str)</code> &ndash; Parameters: parent (type Any); section (type str). Returns: dict[str, Any].</li><li><code>_register_controller_callbacks(self)</code> &ndash; Returns: None.</li><li><code>_detach_controller_listener(self)</code> &ndash; Returns: None.</li><li><code>_on_destroy_event(self, event: tk.Event)</code> &ndash; Parameters: event (type tk.Event). Returns: None.</li><li><code>show(self)</code> &ndash; Returns: None.</li><li><code>_dispatch_controller_event(self, section: str, event: str, payload: dict[str, Any])</code> &ndash; Parameters: section (type str); event (type str); payload (type dict[str, Any]). Returns: None.</li><li><code>_handle_controller_event(self, section: str, event: str, payload: dict[str, Any])</code> &ndash; Parameters: section (type str); event (type str); payload (type dict[str, Any]). Returns: None.</li><li><code>_apply_controller_state(self, section: str, data: dict[str, Any])</code> &ndash; Parameters: section (type str); data (type dict[str, Any]). Returns: None.</li><li><code>_highlight_track(self, section: str, track_id: str | None)</code> &ndash; Parameters: section (type str); track_id (type str | None). Returns: None.</li><li><code>_get_state(self, section: str)</code> &ndash; Parameters: section (type str). Returns: dict[str, Any].</li><li><code>_refresh_categories(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_select_category(self, section: str, category: str)</code> &ndash; Parameters: section (type str); category (type str). Returns: None.</li><li><code>_refresh_tracks(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_update_directories_label(self, state: dict[str, Any], directories: list[str])</code> &ndash; Parameters: state (type dict[str, Any]); directories (type list[str]). Returns: None.</li><li><code>_set_status(self, section: str, message: str)</code> &ndash; Parameters: section (type str); message (type str). Returns: None.</li><li><code>_get_selected_category(self, section: str)</code> &ndash; Parameters: section (type str). Returns: str | None.</li><li><code>_add_category(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_rename_category(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_remove_category(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_on_category_selected(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_get_initial_dir(self, section: str, category: str | None)</code> &ndash; Parameters: section (type str); category (type str | None). Returns: str.</li><li><code>_add_tracks_via_files(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_add_tracks_via_folder(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_remove_tracks(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_rescan_category(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_ai_sort_directory(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_ai_sort_directory_worker(self, section: str, directory: str, audio_files: list[dict[str, str]])</code> &ndash; Parameters: section (type str); directory (type str); audio_files (type list[dict[str, str]]). Returns: None.</li><li><code>_invoke_ai_sort(self, audio_files: list[dict[str, str]])</code> &ndash; Parameters: audio_files (type list[dict[str, str]]). Returns: dict[str, list[str]].</li><li><code>_apply_ai_sort_results(self, section: str, directory: str, audio_files: list[dict[str, str]], assignments: dict[str, list[str]])</code> &ndash; Parameters: section (type str); directory (type str); audio_files (type list[dict[str, str]]); assignments (type dict[str, list[str]]). Returns: None.</li><li><code>_gather_audio_files(self, directory: str)</code> &ndash; Parameters: directory (type str). Returns: list[dict[str, str]].</li><li><code>_play_selected(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_next_track(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_previous_track(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_stop_player(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_toggle_shuffle(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_toggle_loop(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_toggle_continue(self, section: str)</code> &ndash; Parameters: section (type str). Returns: None.</li><li><code>_on_volume_change(self, section: str, value: float)</code> &ndash; Parameters: section (type str); value (type float). Returns: None.</li><li><code>_on_close(self)</code> &ndash; Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\books\__init__.py</h3><p></p><h4>Functions</h4><ul></ul></section>
<section class='module'><h3>modules\books\book_importer.py</h3><p>Utilities for importing and indexing book records.</p><h4>Functions</h4><ul><li><code>prepare_books_from_files(file_paths: Sequence[str], *, campaign_dir: str | None=None)</code> &ndash; Prepare book records from arbitrary PDF file selections. Parameters: file_paths (type Sequence[str]); campaign_dir (keyword-only, type str | None, default None). Returns: List[dict].</li><li><code>prepare_books_from_directory(directory_path: str, *, campaign_dir: str | None=None)</code> &ndash; Prepare book records for every PDF within ``directory_path`` (recursively). Parameters: directory_path (type str); campaign_dir (keyword-only, type str | None, default None). Returns: List[dict].</li><li><code>extract_text_from_book(attachment_path: str, *, campaign_dir: str | None=None)</code> &ndash; Extract page count and text for a persisted book attachment. Parameters: attachment_path (type str); campaign_dir (keyword-only, type str | None, default None). Returns: Tuple[int, str, List[str]].</li><li><code>_prepare_books(paths: Iterable[Path], *, base_dir: Path | None, campaign_dir: str | None)</code> &ndash; Parameters: paths (type Iterable[Path]); base_dir (keyword-only, type Path | None); campaign_dir (keyword-only, type str | None). Returns: List[dict].</li><li><code>_resolve_campaign_dir(campaign_dir: str | None)</code> &ndash; Parameters: campaign_dir (type str | None). Returns: str.</li><li><code>_copy_pdf_to_assets(source: Path, campaign_dir: str)</code> &ndash; Parameters: source (type Path); campaign_dir (type str). Returns: Tuple[Path, str].</li><li><code>_title_from_filename(path: Path)</code> &ndash; Parameters: path (type Path). Returns: str.</li><li><code>_folder_and_tags_for(path: Path, base_dir: Path | None)</code> &ndash; Parameters: path (type Path); base_dir (type Path | None). Returns: Tuple[str, List[str]].</li><li><code>_count_pdf_pages(path: Path)</code> &ndash; Parameters: path (type Path). Returns: int.</li><li><code>_run_ocr_on_page(pdf_path: Path, page_number: int)</code> &ndash; Parameters: pdf_path (type Path); page_number (type int). Returns: str.</li></ul></section>
<section class='module'><h3>modules\books\book_viewer.py</h3><p>Interactive PDF book viewer for campaign assets.</p><h4>Functions</h4><ul><li><code>open_book_viewer(master, book_record: dict)</code> &ndash; Open a new :class:`BookViewer` window for ``book_record``. Parameters: master; book_record (type dict).</li></ul><div class='class'><h4>class BookViewer (ctk.CTkToplevel)</h4><p>A window capable of displaying PDF books with navigation and search.</p><ul><li><code>__init__(self, master, book_record: dict)</code> &ndash; Parameters: master; book_record (type dict).</li><li><code>_build_ui(self)</code> &ndash; No inline documentation available.</li><li><code>_collect_page_texts(self)</code> &ndash; Returns: list[str].</li><li><code>_split_transcript_into_pages(self, transcript)</code> &ndash; Parameters: transcript. Returns: list[str].</li><li><code>_extract_page_texts_from_pdf(self)</code> &ndash; Returns: list[str].</li><li><code>_collect_signets(self)</code> &ndash; Returns: list[dict[str, int | str]].</li><li><code>_render_current_page(self)</code> &ndash; No inline documentation available.</li><li><code>_center_image(self)</code> &ndash; No inline documentation available.</li><li><code>_format_page_label(self)</code> &ndash; Returns: str.</li><li><code>_format_zoom_label(self)</code> &ndash; Returns: str.</li><li><code>go_to_page_from_entry(self)</code> &ndash; No inline documentation available.</li><li><code>go_to_page(self, page: int)</code> &ndash; Parameters: page (type int).</li><li><code>previous_page(self)</code> &ndash; No inline documentation available.</li><li><code>next_page(self)</code> &ndash; No inline documentation available.</li><li><code>adjust_zoom(self, delta: float)</code> &ndash; Parameters: delta (type float).</li><li><code>_prepare_search_results(self, query: str)</code> &ndash; Parameters: query (type str).</li><li><code>_advance_search(self, forward: bool)</code> &ndash; Parameters: forward (type bool).</li><li><code>search_forward(self)</code> &ndash; No inline documentation available.</li><li><code>search_backward(self)</code> &ndash; No inline documentation available.</li><li><code>_format_signet_label(self, signet: dict[str, int | str])</code> &ndash; Parameters: signet (type dict[str, int | str]). Returns: str.</li><li><code>_highlight_current_signet(self)</code> &ndash; No inline documentation available.</li><li><code>_activate_selected_signet(self)</code> &ndash; No inline documentation available.</li><li><code>_on_signet_select(self, _event)</code> &ndash; Parameters: _event.</li><li><code>_on_signet_activate(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_on_mouse_wheel(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_shift_mouse_wheel(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_close(self)</code> &ndash; No inline documentation available.</li><li><code>_refresh_search_highlight(self)</code> &ndash; No inline documentation available.</li><li><code>_prepare_highlight_boxes_for_current_page(self)</code> &ndash; No inline documentation available.</li><li><code>_draw_highlight_overlays(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\books\pdf_processing.py</h3><p>PDF helper functions for rendering and extracting content.</p><h4>Functions</h4><ul><li><code>_resolve_campaign_dir(campaign_dir: str | None)</code> &ndash; Parameters: campaign_dir (type str | None). Returns: Path.</li><li><code>_resolve_pdf_path(attachment_path: str, campaign_dir: str | None)</code> &ndash; Parameters: attachment_path (type str); campaign_dir (type str | None). Returns: Path.</li><li><code>open_document(attachment_path: str, *, campaign_dir: str | None=None)</code> &ndash; Open a PDF attachment and return a PyMuPDF document instance. Parameters: attachment_path (type str); campaign_dir (keyword-only, type str | None, default None). Returns: fitz.Document.</li><li><code>render_pdf_page_to_image(attachment_path: str, page_number: int, *, zoom: float=1.0, campaign_dir: str | None=None, document: fitz.Document | None=None)</code> &ndash; Rasterize a PDF page and return it as a ``PIL.Image`` instance. Parameters: attachment_path (type str); page_number (type int); zoom (keyword-only, type float, default 1.0); campaign_dir (keyword-only, type str | None, default None); document (keyword-only, type fitz.Document | None, default None). Returns: Image.Image.</li><li><code>get_pdf_page_count(attachment_path: str, *, campaign_dir: str | None=None)</code> &ndash; Return the total number of pages for the PDF attachment. Parameters: attachment_path (type str); campaign_dir (keyword-only, type str | None, default None). Returns: int.</li><li><code>export_pdf_page_range(attachment_path: str, start_page: int, end_page: int, *, campaign_dir: str | None=None)</code> &ndash; Export a selection of pages to ``assets/books/excerpts`` and return metadata. Parameters: attachment_path (type str); start_page (type int); end_page (type int); campaign_dir (keyword-only, type str | None, default None). Returns: Dict[str, object].</li></ul></section>
<section class='module'><h3>modules\clues\clues_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\creatures\creature_importer.py</h3><p></p><h4>Functions</h4><ul><li><code>parse_json_relaxed(payload: str)</code> &ndash; Parse JSON from a possibly noisy AI response. Parameters: payload (type str).</li><li><code>_normalize_creature_payload(payload)</code> &ndash; Return the creature list from various payload shapes. Parameters: payload.</li><li><code>_to_longtext(value)</code> &ndash; Convert plain strings into the rich-text JSON structure used by the DB. Parameters: value.</li><li><code>import_creature_records(payload)</code> &ndash; Persist a list (or wrapped dict) of creature entries into the database. Parameters: payload. Returns: int.</li><li><code>import_creatures_from_json(raw_text: str)</code> &ndash; Parse JSON text containing creature definitions and import them into the DB. Parameters: raw_text (type str). Returns: int.</li></ul><div class='class'><h4>class CreatureImportWindow (ctk.CTkToplevel)</h4><p>Window allowing AI-assisted import of creature data from PDFs or pasted text.</p><ul><li><code>__init__(self, master=None)</code> &ndash; Parameters: master (default None).</li><li><code>import_pasted_json(self)</code> &ndash; No inline documentation available.</li><li><code>import_pdf_via_ai(self)</code> &ndash; No inline documentation available.</li><li><code>ai_parse_textarea(self)</code> &ndash; No inline documentation available.</li><li><code>_extract_pdf_text(self, path: str)</code> &ndash; Parameters: path (type str). Returns: str.</li><li><code>_ai_extract_and_import(self, raw_text: str, source_label: str="")</code> &ndash; Parameters: raw_text (type str); source_label (type str, default "").</li><li><code>_set_text(self, value: str)</code> &ndash; Parameters: value (type str).</li><li><code>_set_status(self, text: str)</code> &ndash; Parameters: text (type str).</li><li><code>_busy(self, active: bool)</code> &ndash; Parameters: active (type bool).</li><li><code>_info(self, title: str, message: str)</code> &ndash; Parameters: title (type str); message (type str).</li><li><code>_warn(self, title: str, message: str)</code> &ndash; Parameters: title (type str); message (type str).</li><li><code>_error(self, title: str, message: str)</code> &ndash; Parameters: title (type str); message (type str).</li></ul></div></section>
<section class='module'><h3>modules\creatures\creatures_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\creatures\creatures_opener.py</h3><p></p><h4>Functions</h4><ul><li><code>open_creature_editor_window(creature_name)</code> &ndash; Opens the specified NPC in a new GenericEditorWindow,
completely detached from the scenario/tabs system. Parameters: creature_name.</li></ul></section>
<section class='module'><h3>modules\dice\__init__.py</h3><p></p><h4>Functions</h4><ul></ul></section>
<section class='module'><h3>modules\dice\dice_bar_window.py</h3><p>Always-on-top dice bar that reuses the shared dice engine.</p><h4>Functions</h4><ul></ul><div class='class'><h4>class TextSegment</h4><p>Represents a portion of result text and its emphasis preference.</p><ul></ul></div><div class='class'><h4>class DiceBarWindow (ctk.CTkToplevel)</h4><p>Compact dice roller that mirrors the behaviour of the full window.</p><ul><li><code>__init__(self, master: tk.Misc | None=None)</code> &ndash; Parameters: master (type tk.Misc | None, default None). Returns: None.</li><li><code>_build_ui(self)</code> &ndash; Returns: None.</li><li><code>roll(self)</code> &ndash; Returns: None.</li><li><code>_append_die(self, faces: int)</code> &ndash; Parameters: faces (type int). Returns: None.</li><li><code>_clear_formula(self)</code> &ndash; Returns: None.</li><li><code>refresh_system_settings(self, *, initial: bool=False)</code> &ndash; Reload system-dependent dice presets and default formula. Parameters: initial (keyword-only, type bool, default False). Returns: None.</li><li><code>_rebuild_preset_buttons(self)</code> &ndash; Returns: None.</li><li><code>_format_roll_output(self, result: dice_engine.RollResult, separate: bool)</code> &ndash; Parameters: result (type dice_engine.RollResult); separate (type bool). Returns: tuple[List[TextSegment], str].</li><li><code>_join_parts(self, parts: List[List[TextSegment]])</code> &ndash; Parameters: parts (type List[List[TextSegment]]). Returns: List[TextSegment].</li><li><code>show(self)</code> &ndash; Returns: None.</li><li><code>_apply_geometry(self)</code> &ndash; Returns: None.</li><li><code>_show_error(self, message: str)</code> &ndash; Parameters: message (type str). Returns: None.</li><li><code>_toggle_collapsed(self)</code> &ndash; Returns: None.</li><li><code>_set_collapsed(self, collapsed: bool)</code> &ndash; Parameters: collapsed (type bool). Returns: None.</li><li><code>_update_collapse_button(self)</code> &ndash; Returns: None.</li><li><code>_on_drag_start(self, event: tk.Event)</code> &ndash; Parameters: event (type tk.Event). Returns: None.</li><li><code>_on_drag_motion(self, event: tk.Event)</code> &ndash; Parameters: event (type tk.Event). Returns: None.</li><li><code>_on_drag_end(self, _event: tk.Event)</code> &ndash; Parameters: _event (type tk.Event). Returns: None.</li><li><code>_on_close(self)</code> &ndash; Returns: None.</li><li><code>_display_segments(self, segments: List[TextSegment])</code> &ndash; Parameters: segments (type List[TextSegment]). Returns: None.</li><li><code>_register_drag_target(self, widget: tk.Widget)</code> &ndash; Parameters: widget (type tk.Widget). Returns: None.</li><li><code>_set_total_text(self, text: str)</code> &ndash; Parameters: text (type str). Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\dice\dice_engine.py</h3><p>Non-UI dice rolling engine with reusable parsing and roll helpers.</p><h4>Functions</h4><ul><li><code>parse_formula(formula: str, *, supported_faces: Iterable[int] | None=None)</code> &ndash; Parse a textual dice formula into a :class:`ParsedFormula`. Parameters: formula (type str); supported_faces (keyword-only, type Iterable[int] | None, default None). Returns: ParsedFormula.</li><li><code>format_formula(dice: Mapping[int, int], modifier: int)</code> &ndash; Return a canonical textual representation for a dice formula. Parameters: dice (type Mapping[int, int]); modifier (type int). Returns: str.</li><li><code>roll_parsed_formula(parsed: ParsedFormula, *, explode: bool=False, rng: random.Random | None=None)</code> &ndash; Roll an already parsed formula and return a :class:`RollResult`. Parameters: parsed (type ParsedFormula); explode (keyword-only, type bool, default False); rng (keyword-only, type random.Random | None, default None). Returns: RollResult.</li><li><code>roll_formula(formula: str, *, explode: bool=False, supported_faces: Iterable[int] | None=None, rng: random.Random | None=None)</code> &ndash; Convenience helper that parses and rolls a formula in one go. Parameters: formula (type str); explode (keyword-only, type bool, default False); supported_faces (keyword-only, type Iterable[int] | None, default None); rng (keyword-only, type random.Random | None, default None). Returns: RollResult.</li></ul><div class='class'><h4>class DiceEngineError (Exception)</h4><p>Base class for dice engine related errors.</p><ul></ul></div><div class='class'><h4>class FormulaError (ValueError, DiceEngineError)</h4><p>Raised when a dice formula cannot be parsed.</p><ul></ul></div><div class='class'><h4>class RollError (DiceEngineError)</h4><p>Raised when a roll cannot be completed.</p><ul></ul></div><div class='class'><h4>class ParsedFormula</h4><p>Immutable representation of a parsed dice formula.</p><ul><li><code>__post_init__(self)</code> &ndash; Returns: None.</li><li><code>total_dice(self)</code> &ndash; Returns: int.</li><li><code>canonical(self)</code> &ndash; Returns: str.</li></ul></div><div class='class'><h4>class DieRoll</h4><p>Represents the outcome of a single die throw.</p><ul></ul></div><div class='class'><h4>class DieRollChain</h4><p>Represents the sequence of rolls for a single die, including explosions.</p><ul><li><code>total(self)</code> &ndash; Returns: int.</li><li><code>display_values(self)</code> &ndash; Returns: Tuple[str, ...].</li></ul></div><div class='class'><h4>class FaceRollSummary</h4><p>Aggregated results for all dice of the same size in a roll.</p><ul><li><code>total(self)</code> &ndash; Returns: int.</li><li><code>display_values(self)</code> &ndash; Returns: Tuple[str, ...].</li></ul></div><div class='class'><h4>class RollResult</h4><p>Structured outcome of evaluating a parsed dice formula.</p><ul><li><code>modifier(self)</code> &ndash; Returns: int.</li><li><code>canonical(self)</code> &ndash; Returns: str.</li><li><code>totals_by_face(self)</code> &ndash; Returns: Mapping[int, int].</li><li><code>display_values_by_face(self)</code> &ndash; Returns: Mapping[int, Tuple[str, ...]].</li></ul></div></section>
<section class='module'><h3>modules\dice\dice_preferences.py</h3><p>Helpers that adapt dice behaviour to the active campaign system.</p><h4>Functions</h4><ul><li><code>_normalize_face_value(value: Any)</code> &ndash; Return ``value`` coerced to a positive integer die size when possible. Parameters: value (type Any). Returns: int | None.</li><li><code>get_supported_faces()</code> &ndash; Return the set of dice faces supported by the active system. Returns: Tuple[int, ...].</li><li><code>get_default_formula()</code> &ndash; Return the system's default attack formula (raw string). Returns: str.</li><li><code>canonicalize_formula(formula: str | None)</code> &ndash; Return a canonical dice formula or ``None`` if the text cannot be parsed. Parameters: formula (type str | None). Returns: str | None.</li><li><code>get_rollable_default_formula()</code> &ndash; Return a dice formula that is safe to roll for the current system. Returns: str.</li><li><code>_attack_roll_config()</code> &ndash; Returns: Mapping[str, Any].</li><li><code>_template_context(*, attack_bonus: str, base: str)</code> &ndash; Parameters: attack_bonus (keyword-only, type str); base (keyword-only, type str). Returns: dict[str, str].</li><li><code>make_attack_roll_formula(attack_bonus: str)</code> &ndash; Format an attack roll formula using the active system template. Parameters: attack_bonus (type str). Returns: str.</li><li><code>get_difficulty_definitions()</code> &ndash; Return static difficulty button definitions from the system config. Returns: Tuple[Mapping[str, Any], ...].</li></ul></section>
<section class='module'><h3>modules\dice\dice_roller_window.py</h3><p></p><h4>Functions</h4><ul></ul></section>
<section class='module'><h3>modules\factions\faction_graph_editor.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class FactionGraphEditor (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, faction_wrapper: GenericModelWrapper, *args, **kwargs)</code> &ndash; Parameters: master; faction_wrapper (type GenericModelWrapper); args (variadic positional); kwargs (variadic keyword).</li><li><code>init_toolbar(self)</code> &ndash; No inline documentation available.</li><li><code>add_faction(self)</code> &ndash; No inline documentation available.</li><li><code>_on_faction_chosen(self, name, dialog)</code> &ndash; Parameters: name; dialog.</li><li><code>place_node(self, evt)</code> &ndash; Parameters: evt.</li><li><code>start_link(self)</code> &ndash; No inline documentation available.</li><li><code>_pick_link_start(self, evt)</code> &ndash; Parameters: evt.</li><li><code>_pick_link_end(self, evt)</code> &ndash; Parameters: evt.</li><li><code>draw_graph(self)</code> &ndash; No inline documentation available.</li><li><code>start_drag(self, evt)</code> &ndash; Parameters: evt.</li><li><code>do_drag(self, evt)</code> &ndash; Parameters: evt.</li><li><code>end_drag(self, evt)</code> &ndash; Parameters: evt.</li><li><code>_start_canvas_pan(self, event)</code> &ndash; Parameters: event.</li><li><code>_do_canvas_pan(self, event)</code> &ndash; Parameters: event.</li><li><code>_end_canvas_pan(self, _event)</code> &ndash; Parameters: _event.</li><li><code>on_right_click(self, evt)</code> &ndash; Parameters: evt.</li><li><code>_delete_node(self, tag)</code> &ndash; Parameters: tag.</li><li><code>get_state(self)</code> &ndash; No inline documentation available.</li><li><code>set_state(self, state)</code> &ndash; Parameters: state.</li><li><code>save_graph(self)</code> &ndash; No inline documentation available.</li><li><code>load_graph(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\factions\factions_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\generic\cross_campaign_asset_library.py</h3><p>UI window that manages cross-campaign asset exports and imports.</p><h4>Functions</h4><ul></ul><div class='class'><h4>class CrossCampaignAssetLibraryWindow (ctk.CTkToplevel)</h4><p></p><ul><li><code>__init__(self, master)</code> &ndash; Parameters: master.</li><li><code>_build_ui(self)</code> &ndash; No inline documentation available.</li><li><code>refresh_campaign_list(self)</code> &ndash; No inline documentation available.</li><li><code>browse_for_campaign(self)</code> &ndash; No inline documentation available.</li><li><code>select_campaign(self, campaign: CampaignDatabase)</code> &ndash; Parameters: campaign (type CampaignDatabase).</li><li><code>reload_source(self)</code> &ndash; No inline documentation available.</li><li><code>clear_entities(self)</code> &ndash; No inline documentation available.</li><li><code>populate_lists(self)</code> &ndash; No inline documentation available.</li><li><code>update_preview_from_tree(self, entity_type: str)</code> &ndash; Parameters: entity_type (type str).</li><li><code>_set_preview(self, entity_type: str | None, record: dict | None)</code> &ndash; Parameters: entity_type (type str | None); record (type dict | None).</li><li><code>_resolve_asset_path(self, value: str)</code> &ndash; Parameters: value (type str). Returns: Path | None.</li><li><code>export_selected(self)</code> &ndash; No inline documentation available.</li><li><code>copy_selected_to_current_campaign(self)</code> &ndash; No inline documentation available.</li><li><code>import_bundle(self)</code> &ndash; No inline documentation available.</li><li><code>_post_import(self, summary: dict, overwrite: bool)</code> &ndash; Parameters: summary (type dict); overwrite (type bool).</li><li><code>_post_copy(self, summary: dict)</code> &ndash; Parameters: summary (type dict).</li><li><code>_gather_selected_records(self)</code> &ndash; Returns: Dict[str, List[dict]].</li><li><code>_run_progress_task(self, title, worker, success_message, detail_builder, on_success=None)</code> &ndash; Parameters: title; worker; success_message; detail_builder; on_success (default None).</li><li><code>_busy_cursor(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\generic\cross_campaign_asset_service.py</h3><p>Service layer for exporting and importing assets between campaigns.</p><h4>Functions</h4><ul><li><code>_resolve_active_campaign()</code> &ndash; Returns: CampaignDatabase.</li><li><code>get_active_campaign()</code> &ndash; Returns: CampaignDatabase.</li><li><code>list_sibling_campaigns(include_current: bool=False)</code> &ndash; Parameters: include_current (type bool, default False). Returns: List[CampaignDatabase].</li><li><code>discover_databases_in_directory(directory: Path)</code> &ndash; Parameters: directory (type Path). Returns: List[CampaignDatabase].</li><li><code>load_entities(entity_type: str, db_path: Path)</code> &ndash; Parameters: entity_type (type str); db_path (type Path). Returns: List[dict].</li><li><code>save_entities(entity_type: str, db_path: Path, items: List[dict], *, replace: bool=True)</code> &ndash; Parameters: entity_type (type str); db_path (type Path); items (type List[dict]); replace (keyword-only, type bool, default True). Returns: None.</li><li><code>_determine_record_key(record: dict)</code> &ndash; Parameters: record (type dict). Returns: str.</li><li><code>_collect_portrait(entity_type: str, record: dict, campaign_dir: Path)</code> &ndash; Parameters: entity_type (type str); record (type dict); campaign_dir (type Path). Returns: Optional[AssetReference].</li><li><code>_collect_audio_asset(entity_type: str, record: dict, campaign_dir: Path)</code> &ndash; Parameters: entity_type (type str); record (type dict); campaign_dir (type Path). Returns: Optional[AssetReference].</li><li><code>_collect_attachment_asset(entity_type: str, record: dict, campaign_dir: Path, field_name: str)</code> &ndash; Parameters: entity_type (type str); record (type dict); campaign_dir (type Path); field_name (type str). Returns: Optional[AssetReference].</li><li><code>_campaign_join(campaign_dir: Path, path_value: str)</code> &ndash; Parameters: campaign_dir (type Path); path_value (type str). Returns: Path.</li><li><code>_collect_map_assets(record: dict, campaign_dir: Path)</code> &ndash; Parameters: record (type dict); campaign_dir (type Path). Returns: Iterable[AssetReference].</li><li><code>_deserialize_tokens(raw)</code> &ndash; Parameters: raw. Returns: Tuple[List[dict], type].</li><li><code>_collect_token_assets(record: dict, campaign_dir: Path)</code> &ndash; Parameters: record (type dict); campaign_dir (type Path). Returns: Iterable[AssetReference].</li><li><code>collect_assets(entity_type: str, records: Iterable[dict], campaign_dir: Path)</code> &ndash; Parameters: entity_type (type str); records (type Iterable[dict]); campaign_dir (type Path). Returns: List[AssetReference].</li><li><code>_ensure_unique_bundle_path(bundle_path: Path, existing: Dict[str, Path])</code> &ndash; Parameters: bundle_path (type Path); existing (type Dict[str, Path]). Returns: Path.</li><li><code>_bundle_path_for_asset(asset: AssetReference)</code> &ndash; Parameters: asset (type AssetReference). Returns: Path.</li><li><code>export_bundle(destination: Path, source_campaign: CampaignDatabase, selected_records: Dict[str, List[dict]], progress_callback=None)</code> &ndash; Parameters: destination (type Path); source_campaign (type CampaignDatabase); selected_records (type Dict[str, List[dict]]); progress_callback (default None). Returns: dict.</li><li><code>_call_progress(callback, message: str, fraction: float)</code> &ndash; Parameters: callback; message (type str); fraction (type float). Returns: None.</li><li><code>analyze_bundle(bundle_path: Path, target_db: Path)</code> &ndash; Parameters: bundle_path (type Path); target_db (type Path). Returns: BundleAnalysis.</li><li><code>_determine_target_path(asset_type: str, original_path: str, campaign_dir: Path)</code> &ndash; Parameters: asset_type (type str); original_path (type str); campaign_dir (type Path). Returns: Tuple[Path, str].</li><li><code>detect_duplicates(selected_records: Dict[str, List[dict]], target_campaign: CampaignDatabase)</code> &ndash; Parameters: selected_records (type Dict[str, List[dict]]); target_campaign (type CampaignDatabase). Returns: Dict[str, List[str]].</li><li><code>apply_import(analysis: BundleAnalysis, target_campaign: CampaignDatabase, *, overwrite: bool, progress_callback=None)</code> &ndash; Parameters: analysis (type BundleAnalysis); target_campaign (type CampaignDatabase); overwrite (keyword-only, type bool); progress_callback (keyword-only, default None). Returns: Dict[str, int].</li><li><code>apply_direct_copy(selected_records: Dict[str, List[dict]], *, source_campaign: CampaignDatabase, target_campaign: CampaignDatabase, overwrite: bool, progress_callback=None)</code> &ndash; Parameters: selected_records (type Dict[str, List[dict]]); source_campaign (keyword-only, type CampaignDatabase); target_campaign (keyword-only, type CampaignDatabase); overwrite (keyword-only, type bool); progress_callback (keyword-only, default None). Returns: Dict[str, int].</li><li><code>_rewrite_record_paths(entity_type: str, record: dict, replacements: Dict[str, str])</code> &ndash; Parameters: entity_type (type str); record (type dict); replacements (type Dict[str, str]). Returns: dict.</li><li><code>cleanup_analysis(analysis: BundleAnalysis)</code> &ndash; Parameters: analysis (type BundleAnalysis). Returns: None.</li></ul><div class='class'><h4>class CampaignDatabase</h4><p>Simple metadata structure for a campaign database location.</p><ul></ul></div><div class='class'><h4>class AssetReference</h4><p></p><ul></ul></div><div class='class'><h4>class BundleAnalysis</h4><p></p><ul></ul></div></section>
<section class='module'><h3>modules\generic\custom_fields_editor.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class CustomFieldsEditor (ctk.CTkToplevel)</h4><p>UI to manage user-defined custom fields per entity.

- Shows base (built-in) fields as read-only for the selected entity
- Lets users add/remove custom fields (name + type, optional linked_type)
- Persists to config/custom_fields.json</p><ul><li><code>__init__(self, master)</code> &ndash; Parameters: master.</li><li><code>_on_close(self)</code> &ndash; No inline documentation available.</li><li><code>_on_entity_change(self, entity: str)</code> &ndash; Parameters: entity (type str).</li><li><code>_refresh_custom_list(self)</code> &ndash; No inline documentation available.</li><li><code>_on_type_change(self, *_)</code> &ndash; Parameters: _ (variadic positional).</li><li><code>_add_or_update(self)</code> &ndash; No inline documentation available.</li><li><code>_remove_selected(self)</code> &ndash; No inline documentation available.</li><li><code>_on_select_custom(self, _evt=None)</code> &ndash; Parameters: _evt (default None).</li><li><code>_save_current(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\generic\entity_detail_factory.py</h3><p></p><h4>Functions</h4><ul><li><code>_format_tooltip_value(value, max_length=200)</code> &ndash; Parameters: value; max_length (default 200).</li><li><code>build_entity_tooltip(entity_type, data)</code> &ndash; Build a compact tooltip string for an entity portrait. Parameters: entity_type; data.</li><li><code>_attach_portrait_tooltip(widget, entity_type, data)</code> &ndash; Parameters: widget; entity_type; data.</li><li><code>_open_book_link(parent, book_title: str)</code> &ndash; Parameters: parent; book_title (type str). Returns: None.</li><li><code>insert_text(parent, header, content)</code> &ndash; Parameters: parent; header; content.</li><li><code>insert_longtext(parent, header, content)</code> &ndash; Parameters: parent; header; content.</li><li><code>insert_links(parent, header, items, linked_type, open_entity_callback)</code> &ndash; Parameters: parent; header; items; linked_type; open_entity_callback.</li><li><code>open_entity_tab(entity_type, name, master)</code> &ndash; Parameters: entity_type; name; master.</li><li><code>unwrap_value(val)</code> &ndash; If val is a dict with a 'text' key, return that.
Otherwise, return str(val) (or '' if None). Parameters: val.</li><li><code>insert_npc_table(parent, header, npc_names, open_entity_callback)</code> &ndash; Parameters: parent; header; npc_names; open_entity_callback.</li><li><code>insert_creature_table(parent, header, creature_names, open_entity_callback)</code> &ndash; Parameters: parent; header; creature_names; open_entity_callback.</li><li><code>insert_places_table(parent, header, place_names, open_entity_callback)</code> &ndash; Render a table of Places (excluding PlayerDisplay) with columns:
Portrait, Name, Description, NPCs, Secrets Parameters: parent; header; place_names; open_entity_callback.</li><li><code>insert_list_longtext(parent, header, items, open_entity_callback=None, entity_collector=None, gm_view=None)</code> &ndash; Insert collapsible sections for long text lists such as scenario scenes. Parameters: parent; header; items; open_entity_callback (default None); entity_collector (default None); gm_view (default None).</li><li><code>create_scenario_detail_frame(entity_type, scenario_item, master, open_entity_callback=None)</code> &ndash; Build a scrollable detail view for a scenario with:
1) A header zone (Title, Summary, Secrets)
2) Then the rest of the fields, but NPCs always before Places. Parameters: entity_type; scenario_item; master; open_entity_callback (default None).</li><li><code>EditWindow(self, item, template, model_wrapper, creation_mode=False, on_save=None)</code> &ndash; Parameters: item; template; model_wrapper; creation_mode (default False); on_save (default None).</li><li><code>create_entity_detail_frame(entity_type, entity, master, open_entity_callback=None)</code> &ndash; Routes Scenarios through our custom header/body and
everything else through the generic detail path. Parameters: entity_type; entity; master; open_entity_callback (default None).</li><li><code>open_entity_window(entity_type, name)</code> &ndash; Parameters: entity_type; name.</li></ul></section>
<section class='module'><h3>modules\generic\entity_opener.py</h3><p></p><h4>Functions</h4><ul><li><code>open_detached_npc(npc_name)</code> &ndash; Parameters: npc_name.</li><li><code>open_detached_pc(pc_name)</code> &ndash; Parameters: pc_name.</li></ul></section>
<section class='module'><h3>modules\generic\entity_selection_dialog.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class EntitySelectionDialog (ctk.CTkToplevel)</h4><p></p><ul><li><code>__init__(self, master, entity_type, model_wrapper, template, on_entity_selected)</code> &ndash; Parameters: master; entity_type; model_wrapper; template; on_entity_selected.</li><li><code>create_table_header(self)</code> &ndash; No inline documentation available.</li><li><code>refresh_list(self)</code> &ndash; No inline documentation available.</li><li><code>create_item_row(self, item, row_index)</code> &ndash; Parameters: item; row_index.</li><li><code>filter_items(self)</code> &ndash; No inline documentation available.</li><li><code>sort_column(self, column)</code> &ndash; Parameters: column.</li><li><code>select_entity(self, item)</code> &ndash; Parameters: item.</li><li><code>open_selected(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\generic\export_for_foundry.py</h3><p></p><h4>Functions</h4><ul><li><code>preview_and_export_foundry(self)</code> &ndash; Exports scenarios, NPCs, and places into a ZIP archive that contains a JSON file formatted
for Foundry VTT import and a portraits folder with all the portrait image files.

Each scenario becomes a scene with embedded title, summary, secrets, NPC tokens (with preset positions and color-coded faction borders),
and clickable markers for linked place scenes. Separate place scenes are also exported.

The portrait fields in the export JSON are set to relative paths like "portraits/filename.png".</li></ul></section>
<section class='module'><h3>modules\generic\generic_editor_window.py</h3><p></p><h4>Functions</h4><ul><li><code>load_entities_list(entity_type)</code> &ndash; Creates a model wrapper for the given entity type, fetches all
database records, and returns a list of names.

Args:
    entity_type (str): The type of entity to load (e.g., "npcs", "factions").

Returns:
    list: A list of names for the given entity, or an empty list on error. Parameters: entity_type.</li><li><code>load_factions_list()</code> &ndash; No inline documentation available.</li><li><code>load_npcs_list()</code> &ndash; No inline documentation available.</li><li><code>load_pcs_list()</code> &ndash; No inline documentation available.</li><li><code>load_places_list()</code> &ndash; No inline documentation available.</li><li><code>load_objects_list()</code> &ndash; No inline documentation available.</li><li><code>load_creatures_list()</code> &ndash; No inline documentation available.</li><li><code>load_books_list()</code> &ndash; No inline documentation available.</li></ul><div class='class'><h4>class ReadOnlyLongTextPreview (ctk.CTkFrame)</h4><p>Lightweight preview widget for very large longtext fields.

The Books entity uses a massive OCR transcript (``ExtractedText``) that can
contain hundreds of thousands of characters.  Rendering that content inside
``RichTextEditor`` freezes Tk for several seconds because the widget
re-computes the layout for every line.  This helper keeps the editor fast by
showing only a short, read-only preview and deferring the full transcript to
a separate window when requested.</p><ul><li><code>__init__(self, parent, field_label: str, raw_value)</code> &ndash; Parameters: parent; field_label (type str); raw_value.</li><li><code>_coerce_to_text(value)</code> &ndash; Parameters: value. Returns: str.</li><li><code>_open_full_transcript(self)</code> &ndash; No inline documentation available.</li><li><code>get_text_data(self)</code> &ndash; Return the original longtext payload for persistence.</li></ul></div><div class='class'><h4>class CustomDropdown (ctk.CTkToplevel)</h4><p></p><ul><li><code>__init__(self, master, options, command, width=None, max_height=300, **kwargs)</code> &ndash; master      – parent widget (usually the root or your main window)
options     – list of strings
command     – callback(value) when the user selects
width       – desired pixel width (defaults to master widget’s width)
max_height  – maximum pixel height Parameters: master; options; command; width (default None); max_height (default 300); kwargs (variadic keyword).</li><li><code>_populate_options(self)</code> &ndash; No inline documentation available.</li><li><code>_on_search_change(self, *args)</code> &ndash; Parameters: args (variadic positional).</li><li><code>_on_activate(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_mousewheel(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_focus_out(self, event)</code> &ndash; Parameters: event.</li></ul></div><div class='class'><h4>class GenericEditorWindow (ctk.CTkToplevel)</h4><p></p><ul><li><code>__init__(self, master, item, template, model_wrapper, creation_mode=False)</code> &ndash; Parameters: master; item; template; model_wrapper; creation_mode (default False).</li><li><code>_get_ai(self)</code> &ndash; No inline documentation available.</li><li><code>_make_richtext_editor(self, parent, initial_text, hide_toolbar=True, max_lines=None)</code> &ndash; Shared initialization for any RichTextEditor-based field.
Returns the editor instance. Parameters: parent; initial_text; hide_toolbar (default True); max_lines (default None).</li><li><code>create_longtext_field(self, field)</code> &ndash; Parameters: field.</li><li><code>create_dynamic_longtext_list(self, field)</code> &ndash; Parameters: field.</li><li><code>create_audio_field(self, field)</code> &ndash; Parameters: field.</li><li><code>create_file_field(self, field)</code> &ndash; Parameters: field.</li><li><code>select_attachment(self, field_name, label_widget, storage_subdir)</code> &ndash; Parameters: field_name; label_widget; storage_subdir.</li><li><code>create_boolean_field(self, field)</code> &ndash; Parameters: field.</li><li><code>generate_secret_text(self)</code> &ndash; Reads three text files from the assets folder:
- Secret truths.txt
- Secret origins.txt
- Secret consequences.txt
Each file is expected to contain approximately 100 elements (one per line).
The function randomly selects one line from each file in the order:
Secret truths, then Secret origins, then Secret consequences.
The final string is then inserted into the 'Secrets' text widget.</li><li><code>generate_npc(self)</code> &ndash; Generates random NPC data by:
- Filling the Appearance, Background, Personality, and Quirks fields using the corresponding asset files:
    npc_appearance.txt, npc_background.txt, npc_personality.txt, npc_quirks.txt
- Filling the NPC's Secret field by reading from:
    npc_secret_implication.txt, npc_secret_motive.txt, npc_secret_origin.txt, npc_secret_detail.txt
Updates both the underlying data model (self.item) and the UI widgets.</li><li><code>generate_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>generate_scenario_description(self)</code> &ndash; Reads four text files from the assets folder:
- Inciting Incidents.txt
- Antagonists.txt
- Objectives.txt
- Settings.txt
Each file contains ~100 elements (one per line). This function randomly selects one line
from each file and constructs a single-line description in the order:
Inciting Incident, Antagonists, Objectives, Settings.
The output is then inserted into the 'Summary' (scenario description) text widget.</li><li><code>on_combo_mousewheel(self, event, combobox)</code> &ndash; Parameters: event; combobox.</li><li><code>create_dynamic_combobox_list(self, field)</code> &ndash; Parameters: field.</li><li><code>create_text_entry(self, field)</code> &ndash; Parameters: field.</li><li><code>create_action_bar(self)</code> &ndash; No inline documentation available.</li><li><code>_serialize_scene_states(self, states)</code> &ndash; Parameters: states.</li><li><code>save(self)</code> &ndash; No inline documentation available.</li><li><code>create_portrait_field(self, field)</code> &ndash; Parameters: field.</li><li><code>paste_portrait_from_clipboard(self)</code> &ndash; Paste image from clipboard and set as entity portrait.
Supports images directly or image file paths in clipboard (Windows).</li><li><code>create_image_field(self, field)</code> &ndash; Parameters: field.</li><li><code>paste_image_from_clipboard(self)</code> &ndash; Paste image from clipboard and set as entity image (map image).
Supports images directly or image file paths in clipboard (Windows/macOS).</li><li><code>launch_swarmui(self)</code> &ndash; No inline documentation available.</li><li><code>cleanup_swarmui(self)</code> &ndash; Terminate the SwarmUI process if it is running.</li><li><code>create_portrait_with_swarmui(self)</code> &ndash; No inline documentation available.</li><li><code>generate_portrait(self, selected_model)</code> &ndash; Generates a portrait image using the SwarmUI API and associates the resulting
image with the current NPC by updating its 'Portrait' field. Parameters: selected_model.</li><li><code>_show_image_selection_window(self, pil_images)</code> &ndash; Display a modal window with thumbnails side by side for the user to choose.
Returns the selected index, or None if cancelled. Parameters: pil_images.</li><li><code>select_portrait(self)</code> &ndash; No inline documentation available.</li><li><code>select_image(self)</code> &ndash; No inline documentation available.</li><li><code>_campaign_relative_path(self, path)</code> &ndash; Parameters: path.</li><li><code>_format_audio_label(self, value: str)</code> &ndash; Parameters: value (type str). Returns: str.</li><li><code>_update_portrait_preview(self)</code> &ndash; No inline documentation available.</li><li><code>copy_and_resize_image(self, src_path)</code> &ndash; Parameters: src_path.</li><li><code>copy_and_resize_portrait(self, src_path)</code> &ndash; Parameters: src_path.</li><li><code>copy_audio_asset(self, src_path: str)</code> &ndash; Parameters: src_path (type str). Returns: str.</li><li><code>_field_text(self, field_name)</code> &ndash; Parameters: field_name.</li><li><code>_set_field_text(self, field_name, text)</code> &ndash; Parameters: field_name; text.</li><li><code>ai_improve_field(self, field_name)</code> &ndash; Parameters: field_name.</li><li><code>ai_draft_field(self, field_name)</code> &ndash; Parameters: field_name.</li><li><code>_infer_theme(self, entity_type: str)</code> &ndash; Infer a coarse genre/theme string from existing entities of given type. Parameters: entity_type (type str). Returns: str.</li><li><code>ai_generate_full_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>ai_generate_full_npc(self)</code> &ndash; No inline documentation available.</li><li><code>ai_generate_full_creature(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\generic\generic_list_selection_view.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class GenericListSelectionView (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, entity_type, model_wrapper, template, on_select_callback=None, *args, allow_multi_select=False, on_multi_select_callback=None, **kwargs)</code> &ndash; Parameters: master; entity_type; model_wrapper; template; on_select_callback (default None); args (variadic positional); allow_multi_select (keyword-only, default False); on_multi_select_callback (keyword-only, default None); kwargs (variadic keyword).</li><li><code>refresh_list(self)</code> &ndash; No inline documentation available.</li><li><code>sort_column(self, column_name)</code> &ndash; Parameters: column_name.</li><li><code>filter_items(self)</code> &ndash; No inline documentation available.</li><li><code>on_double_click(self, event)</code> &ndash; Parameters: event.</li><li><code>open_selected(self)</code> &ndash; No inline documentation available.</li><li><code>select_entity(self, item)</code> &ndash; Parameters: item.</li><li><code>sanitize_id(self, s)</code> &ndash; Parameters: s.</li><li><code>_on_tree_select_change(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_clear_selection_indicator(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\generic\generic_list_view.py</h3><p></p><h4>Functions</h4><ul><li><code>sanitize_id(s)</code> &ndash; Parameters: s.</li><li><code>unique_iid(tree, base_id)</code> &ndash; Return a unique iid for the given treeview based on base_id. Parameters: tree; base_id.</li></ul><div class='class'><h4>class _ToolTip</h4><p>Simple tooltip for a Treeview showing full cell text on hover.</p><ul><li><code>__init__(self, widget, text_resolver=None)</code> &ndash; Parameters: widget; text_resolver (default None).</li><li><code>_on_motion(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_leave(self, _)</code> &ndash; Parameters: _.</li><li><code>_show(self, x, y, text)</code> &ndash; Parameters: x; y; text.</li><li><code>_hide(self)</code> &ndash; No inline documentation available.</li></ul></div><div class='class'><h4>class GenericListView (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, model_wrapper, template, *args, **kwargs)</code> &ndash; Parameters: master; model_wrapper; template; args (variadic positional); kwargs (variadic keyword).</li><li><code>_hide_search_frame(self)</code> &ndash; No inline documentation available.</li><li><code>_show_search_frame(self)</code> &ndash; No inline documentation available.</li><li><code>reload_from_db(self)</code> &ndash; Reload items from the model wrapper and refresh the view.</li><li><code>show_portrait_window(self, iid)</code> &ndash; Parameters: iid.</li><li><code>refresh_list(self)</code> &ndash; No inline documentation available.</li><li><code>update_entity_count(self)</code> &ndash; No inline documentation available.</li><li><code>_create_view_toggle_button(self, mode, label)</code> &ndash; Parameters: mode; label.</li><li><code>_set_view_mode(self, mode)</code> &ndash; Parameters: mode.</li><li><code>_update_view_toggle_state(self)</code> &ndash; No inline documentation available.</li><li><code>show_grid_view(self)</code> &ndash; No inline documentation available.</li><li><code>show_list_view(self)</code> &ndash; No inline documentation available.</li><li><code>show_shelf_view(self)</code> &ndash; No inline documentation available.</li><li><code>populate_grid(self)</code> &ndash; No inline documentation available.</li><li><code>on_grid_click(self, _event, item)</code> &ndash; Parameters: _event; item.</li><li><code>toggle_item_selection(self, item)</code> &ndash; Parameters: item.</li><li><code>_detect_media_field(self)</code> &ndash; No inline documentation available.</li><li><code>_resolve_media_path(self, media_path)</code> &ndash; Parameters: media_path.</li><li><code>_load_grid_image(self, item)</code> &ndash; Parameters: item.</li><li><code>_edit_item(self, item)</code> &ndash; Parameters: item.</li><li><code>on_button_press(self, event)</code> &ndash; Parameters: event.</li><li><code>on_mouse_move(self, event)</code> &ndash; Parameters: event.</li><li><code>on_button_release(self, event)</code> &ndash; Parameters: event.</li><li><code>on_tree_click(self, event)</code> &ndash; Parameters: event.</li><li><code>on_tree_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>on_tree_drop(self, event)</code> &ndash; Parameters: event.</li><li><code>copy_item(self, iid)</code> &ndash; Copy the currently selected items or the provided iid. Parameters: iid.</li><li><code>paste_item(self, iid=None)</code> &ndash; Parameters: iid (default None).</li><li><code>insert_next_batch(self)</code> &ndash; No inline documentation available.</li><li><code>insert_grouped_items(self)</code> &ndash; No inline documentation available.</li><li><code>clean_value(self, val)</code> &ndash; Parameters: val.</li><li><code>_get_display_value(self, item, column)</code> &ndash; Parameters: item; column.</li><li><code>_summarize_book_excerpts(self, item)</code> &ndash; Parameters: item.</li><li><code>_iter_book_excerpts(self, item)</code> &ndash; Parameters: item.</li><li><code>_build_excerpt_entry(self, metadata)</code> &ndash; Parameters: metadata.</li><li><code>_parse_page_range_input(self, text, total_pages)</code> &ndash; Parameters: text; total_pages.</li><li><code>_resolve_book_path(self, relative_path)</code> &ndash; Parameters: relative_path.</li><li><code>_open_book_excerpt(self, excerpt)</code> &ndash; Parameters: excerpt.</li><li><code>_show_book_excerpts_menu(self, item, widget=None)</code> &ndash; Parameters: item; widget (default None).</li><li><code>open_book(self, item)</code> &ndash; Parameters: item.</li><li><code>extract_book_pages(self, item)</code> &ndash; Parameters: item.</li><li><code>_normalize_unique_value(self, value)</code> &ndash; Parameters: value.</li><li><code>_merge_duplicate_group(self, group)</code> &ndash; Parameters: group.</li><li><code>_merge_field_value(self, existing, new)</code> &ndash; Parameters: existing; new.</li><li><code>_is_empty_value(self, value)</code> &ndash; Parameters: value.</li><li><code>_normalize_column_id(self, column_id)</code> &ndash; Translate Treeview #n identifiers into configured column names. Parameters: column_id.</li><li><code>_get_cell_text(self, iid, column_id)</code> &ndash; Parameters: iid; column_id.</li><li><code>_format_cell(self, column_id, value, iid=None)</code> &ndash; Prepare a value for display in the tree, truncating if needed. Parameters: column_id; value; iid (default None).</li><li><code>_truncate_text(self, text, column_id)</code> &ndash; Parameters: text; column_id.</li><li><code>sort_column(self, column_name)</code> &ndash; Parameters: column_name.</li><li><code>on_double_click(self, event)</code> &ndash; Parameters: event.</li><li><code>on_right_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_show_item_menu(self, iid, event)</code> &ndash; Parameters: iid; event.</li><li><code>display_on_second_screen(self, iid)</code> &ndash; Parameters: iid.</li><li><code>_get_audio_value(self, item)</code> &ndash; Parameters: item.</li><li><code>play_item_audio(self, item)</code> &ndash; Parameters: item.</li><li><code>delete_item(self, iid)</code> &ndash; Parameters: iid.</li><li><code>open_in_gm_screen(self, iid)</code> &ndash; Parameters: iid.</li><li><code>add_item(self)</code> &ndash; No inline documentation available.</li><li><code>open_editor(self, item, creation_mode=False)</code> &ndash; Parameters: item; creation_mode (default False).</li><li><code>filter_items(self, query)</code> &ndash; Parameters: query.</li><li><code>add_items(self, items)</code> &ndash; Parameters: items.</li><li><code>merge_duplicate_entities(self)</code> &ndash; No inline documentation available.</li><li><code>import_map_directory(self)</code> &ndash; No inline documentation available.</li><li><code>import_books_from_files_dialog(self)</code> &ndash; No inline documentation available.</li><li><code>import_books_from_directory_dialog(self)</code> &ndash; No inline documentation available.</li><li><code>_persist_imported_books(self, records)</code> &ndash; Parameters: records.</li><li><code>_queue_book_indexing(self, titles)</code> &ndash; Parameters: titles.</li><li><code>_on_book_indexing_complete(self, success_count, failures)</code> &ndash; Parameters: success_count; failures.</li><li><code>_copy_map_image(self, src_path, image_name)</code> &ndash; Parameters: src_path; image_name.</li><li><code>choose_group_column(self)</code> &ndash; No inline documentation available.</li><li><code>open_ai_wizard(self)</code> &ndash; No inline documentation available.</li><li><code>_set_ai_categorize_running(self, running: bool)</code> &ndash; Parameters: running (type bool).</li><li><code>_normalize_ai_excerpt(self, value, limit: int=320)</code> &ndash; Parameters: value; limit (type int, default 320). Returns: str.</li><li><code>_build_ai_categorization_payload(self, items)</code> &ndash; Parameters: items.</li><li><code>_request_ai_category_assignments(self, payload, existing_categories)</code> &ndash; Parameters: payload; existing_categories.</li><li><code>ai_categorize_objects(self)</code> &ndash; No inline documentation available.</li><li><code>_find_item_by_iid(self, iid)</code> &ndash; Parameters: iid.</li><li><code>_get_base_id(self, item)</code> &ndash; Parameters: item.</li><li><code>_resolve_action_target_bases(self, iid)</code> &ndash; Return base ids targeted by a row-level action. Parameters: iid.</li><li><code>_register_tree_iid(self, base_id, iid)</code> &ndash; Parameters: base_id; iid.</li><li><code>_apply_selection_to_tree(self)</code> &ndash; No inline documentation available.</li><li><code>_on_tree_selection_changed(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_update_tree_selection_tags(self, selection=None)</code> &ndash; Parameters: selection (default None).</li><li><code>_apply_selection_tag(self, iid)</code> &ndash; Parameters: iid.</li><li><code>_remove_selection_tag(self, iid)</code> &ndash; Parameters: iid.</li><li><code>_refresh_grid_selection(self)</code> &ndash; No inline documentation available.</li><li><code>_set_grid_card_selected(self, card, selected)</code> &ndash; Parameters: card; selected.</li><li><code>_update_bulk_controls(self)</code> &ndash; No inline documentation available.</li><li><code>_get_display_label(self)</code> &ndash; No inline documentation available.</li><li><code>_format_entity_noun(self, count)</code> &ndash; Parameters: count.</li><li><code>_find_item_by_base_id(self, base_id)</code> &ndash; Parameters: base_id.</li><li><code>_open_bulk_menu(self)</code> &ndash; No inline documentation available.</li><li><code>_bulk_link_to_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>_apply_bulk_link_to_scenario(self, scenario_name, field_name)</code> &ndash; Parameters: scenario_name; field_name.</li><li><code>_bulk_add_to_gm_screen(self)</code> &ndash; No inline documentation available.</li><li><code>_apply_bulk_add_to_gm_screen(self, scenario_name, gm_type)</code> &ndash; Parameters: scenario_name; gm_type.</li><li><code>_column_from_ident(self, ident)</code> &ndash; Parameters: ident.</li><li><code>_load_column_settings(self)</code> &ndash; No inline documentation available.</li><li><code>_apply_column_settings(self)</code> &ndash; No inline documentation available.</li><li><code>_save_column_settings(self)</code> &ndash; No inline documentation available.</li><li><code>_show_columns_menu(self, event)</code> &ndash; Parameters: event.</li><li><code>_open_column_chooser(self)</code> &ndash; No inline documentation available.</li><li><code>_open_display_fields_chooser(self)</code> &ndash; No inline documentation available.</li><li><code>_load_list_order(self)</code> &ndash; No inline documentation available.</li><li><code>_save_list_order(self)</code> &ndash; No inline documentation available.</li><li><code>_load_display_fields(self)</code> &ndash; No inline documentation available.</li><li><code>_save_display_fields(self)</code> &ndash; No inline documentation available.</li><li><code>set_row_color(self, iid, color_name)</code> &ndash; Parameters: iid; color_name.</li><li><code>_save_row_color(self, base_id, color_name)</code> &ndash; Parameters: base_id; color_name.</li></ul></div></section>
<section class='module'><h3>modules\generic\generic_model_wrapper.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class GenericModelWrapper</h4><p></p><ul><li><code>__init__(self, entity_type, db_path=None)</code> &ndash; Parameters: entity_type; db_path (default None).</li><li><code>_get_connection(self)</code> &ndash; No inline documentation available.</li><li><code>_deserialize_row(self, row)</code> &ndash; Parameters: row.</li><li><code>_infer_key_field(self, key_field=None)</code> &ndash; Parameters: key_field (default None).</li><li><code>load_items(self)</code> &ndash; No inline documentation available.</li><li><code>load_item_by_key(self, key_value, key_field=None)</code> &ndash; Parameters: key_value; key_field (default None).</li><li><code>_ensure_schema(self, cursor, items)</code> &ndash; Ensure that any new fields present in ``items`` exist in the table. Parameters: cursor; items.</li><li><code>save_items(self, items, *, replace=True)</code> &ndash; Parameters: items; replace (keyword-only, default True).</li><li><code>save_item(self, item, *, key_field=None)</code> &ndash; Parameters: item; key_field (keyword-only, default None).</li></ul></div></section>
<section class='module'><h3>modules\generic\new_entity_type_dialog.py</h3><p></p><h4>Functions</h4><ul><li><code>_slugify(value: str)</code> &ndash; Return a lowercase slug safe for template/table names. Parameters: value (type str). Returns: str.</li></ul><div class='class'><h4>class NewEntityTypeDialog (ctk.CTkToplevel)</h4><p>Dialog that seeds a new entity template and registers metadata.</p><ul><li><code>__init__(self, master, on_created=None)</code> &ndash; Parameters: master; on_created (default None).</li><li><code>_mark_slug_dirty(self)</code> &ndash; No inline documentation available.</li><li><code>_on_display_name_change(self, *_)</code> &ndash; Parameters: _ (variadic positional).</li><li><code>_choose_icon(self)</code> &ndash; No inline documentation available.</li><li><code>_clear_icon(self)</code> &ndash; No inline documentation available.</li><li><code>_validate(self, label: str, slug: str, *, allow_existing: bool=False)</code> &ndash; Parameters: label (type str); slug (type str); allow_existing (keyword-only, type bool, default False). Returns: bool.</li><li><code>_perform_action(self)</code> &ndash; No inline documentation available.</li><li><code>_create_entity(self)</code> &ndash; No inline documentation available.</li><li><code>_update_entity(self)</code> &ndash; No inline documentation available.</li><li><code>_refresh_custom_entities(self, preserve_selection: str | None=None)</code> &ndash; Parameters: preserve_selection (type str | None, default None).</li><li><code>_enter_create_mode(self)</code> &ndash; No inline documentation available.</li><li><code>_enter_edit_mode(self, slug: str)</code> &ndash; Parameters: slug (type str).</li><li><code>_on_entity_select(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_delete_selected(self)</code> &ndash; No inline documentation available.</li><li><code>_close(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\helpers\backup_helper.py</h3><p>Utilities for creating and restoring campaign backup archives.</p><h4>Functions</h4><ul><li><code>_call_progress(callback: Optional[ProgressCallback], message: str, fraction: float)</code> &ndash; Parameters: callback (type Optional[ProgressCallback]); message (type str); fraction (type float). Returns: None.</li><li><code>_read_app_version()</code> &ndash; Returns: str.</li><li><code>_relative_arcname(path: Path, base: Path)</code> &ndash; Parameters: path (type Path); base (type Path). Returns: str.</li><li><code>_iter_files(root: Path)</code> &ndash; Parameters: root (type Path). Returns: Iterable[Path].</li><li><code>_resolve_database_path()</code> &ndash; Returns: Path.</li><li><code>create_backup_archive(destination_path: str | os.PathLike[str], progress_callback: Optional[ProgressCallback]=None)</code> &ndash; Create a zip archive containing campaign data and return its manifest. Parameters: destination_path (type str | os.PathLike[str]); progress_callback (type Optional[ProgressCallback], default None). Returns: dict.</li><li><code>read_backup_manifest(archive_path: str | os.PathLike[str])</code> &ndash; Return the manifest stored inside ``archive_path``.

Raises :class:`ManifestError` when the manifest cannot be read or the
archive format is unsupported. Parameters: archive_path (type str | os.PathLike[str]). Returns: dict.</li><li><code>restore_backup_archive(archive_path: str | os.PathLike[str], target_dir: Optional[str | os.PathLike[str]]=None, progress_callback: Optional[ProgressCallback]=None, *, campaign_name: Optional[str]=None, database_filename: Optional[str]=None)</code> &ndash; Restore a campaign backup archive into ``target_dir`` and return the manifest. Parameters: archive_path (type str | os.PathLike[str]); target_dir (type Optional[str | os.PathLike[str]], default None); progress_callback (type Optional[ProgressCallback], default None); campaign_name (keyword-only, type Optional[str], default None); database_filename (keyword-only, type Optional[str], default None). Returns: dict.</li></ul><div class='class'><h4>class BackupError (Exception)</h4><p>Raised when a backup operation cannot be completed.</p><ul></ul></div><div class='class'><h4>class ManifestError (BackupError)</h4><p>Raised when a backup manifest is missing or incompatible.</p><ul></ul></div></section>
<section class='module'><h3>modules\helpers\config_helper.py</h3><p></p><h4>Functions</h4><ul></ul></section>
<section class='module'><h3>modules\helpers\custom_buttons.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class MinimalCTkButton (ctk.CTkButton)</h4><p></p><ul><li><code>__init__(self, master, text="", **kwargs)</code> &ndash; Parameters: master; text (default ""); kwargs (variadic keyword).</li><li><code>_adjust_width(self, text)</code> &ndash; Parameters: text.</li></ul></div></section>
<section class='module'><h3>modules\helpers\dice_markup.py</h3><p></p><h4>Functions</h4><ul><li><code>_coerce_group_name(value: Any, default: str | None)</code> &ndash; Parameters: value (type Any); default (type str | None). Returns: str | None.</li><li><code>_parse_regex_flags(metadata: Mapping[str, Any])</code> &ndash; Parameters: metadata (type Mapping[str, Any]). Returns: int.</li><li><code>_parse_difficulty_specs(raw: Any)</code> &ndash; Parameters: raw (type Any). Returns: Tuple[_DifficultyPattern, ...].</li><li><code>_build_action_patterns(config)</code> &ndash; Parameters: config. Returns: Tuple[_ActionPattern, ...].</li><li><code>_get_action_patterns()</code> &ndash; Returns: Tuple[_ActionPattern, ...].</li><li><code>invalidate_action_pattern_cache()</code> &ndash; Clear any cached analyzer patterns so they reload on next access. Returns: None.</li><li><code>_canonicalize_formula_text(value: str | None)</code> &ndash; Parameters: value (type str | None). Returns: str | None.</li><li><code>_build_template_context(attack_bonus: str | None, attack_roll: str | None, *, value: Any=None, extra: Mapping[str, Any] | None=None)</code> &ndash; Parameters: attack_bonus (type str | None); attack_roll (type str | None); value (keyword-only, type Any, default None); extra (keyword-only, type Mapping[str, Any] | None, default None). Returns: dict[str, str].</li><li><code>_resolve_default_difficulties(attack_bonus: str | None, attack_roll: str | None)</code> &ndash; Parameters: attack_bonus (type str | None); attack_roll (type str | None). Returns: Tuple[ParsedDifficulty, ...].</li><li><code>_build_pattern_difficulties(match: re.Match[str], pattern: _ActionPattern, attack_bonus: str | None, attack_roll: str | None)</code> &ndash; Parameters: match (type re.Match[str]); pattern (type _ActionPattern); attack_bonus (type str | None); attack_roll (type str | None). Returns: Tuple[ParsedDifficulty, ...].</li><li><code>_deduplicate_difficulties(difficulties: Iterable[ParsedDifficulty])</code> &ndash; Parameters: difficulties (type Iterable[ParsedDifficulty]). Returns: Tuple[ParsedDifficulty, ...].</li><li><code>_combine_difficulties(*groups: Iterable[ParsedDifficulty])</code> &ndash; Parameters: groups (variadic positional, type Iterable[ParsedDifficulty]). Returns: Tuple[ParsedDifficulty, ...].</li><li><code>_spans_overlap(left: Tuple[int, int], right: Tuple[int, int])</code> &ndash; Parameters: left (type Tuple[int, int]); right (type Tuple[int, int]). Returns: bool.</li><li><code>parse_inline_actions(raw_text: Any)</code> &ndash; Extract inline combat actions from a block of text.

Returns a tuple ``(display_text, actions, errors)`` where ``display_text`` is the
original text with markup removed, ``actions`` is a list of dictionaries describing
parsed actions, and ``errors`` captures any validation issues encountered. Parameters: raw_text (type Any). Returns: tuple[str, list[dict[str, Any]], list[dict[str, Any]]].</li><li><code>_parse_segment(segment: str, span: Tuple[int, int], *, base_offset: int)</code> &ndash; Parameters: segment (type str); span (type Tuple[int, int]); base_offset (keyword-only, type int). Returns: tuple[ParsedAction | None, ParsedError | None, str | None].</li><li><code>_format_action_display(*, label: str, attack_bonus: str | None, damage_formula: str | None, notes: str | None, base_offset: int)</code> &ndash; Parameters: label (keyword-only, type str); attack_bonus (keyword-only, type str | None); damage_formula (keyword-only, type str | None); notes (keyword-only, type str | None); base_offset (keyword-only, type int). Returns: tuple[str, Tuple[int, int] | None, Tuple[int, int] | None].</li><li><code>_extract_label_and_attack(left: str)</code> &ndash; Parameters: left (type str). Returns: tuple[str, str | None, str | None].</li><li><code>_extract_damage(right: str, span: Tuple[int, int], segment: str)</code> &ndash; Parameters: right (type str); span (type Tuple[int, int]); segment (type str). Returns: tuple[str | None, str | None, ParsedError | None].</li><li><code>_split_dm_damage(text: str)</code> &ndash; Parameters: text (type str). Returns: tuple[str, str | None].</li><li><code>_try_parse_formula(formula: str, *, force_sign: bool)</code> &ndash; Parameters: formula (type str); force_sign (keyword-only, type bool). Returns: str | None.</li><li><code>_format_parsed_formula(parsed: dice_engine.ParsedFormula, *, force_sign: bool)</code> &ndash; Parameters: parsed (type dice_engine.ParsedFormula); force_sign (keyword-only, type bool). Returns: str.</li><li><code>_make_attack_roll_formula(attack_bonus: str)</code> &ndash; Parameters: attack_bonus (type str). Returns: str.</li><li><code>_coerce_text(raw: Any)</code> &ndash; Parameters: raw (type Any). Returns: str.</li><li><code>_infer_actions_from_plain_text(text: str)</code> &ndash; Parameters: text (type str). Returns: list[ParsedAction].</li><li><code>_build_action_from_match(match: re.Match[str], pattern: _ActionPattern)</code> &ndash; Parameters: match (type re.Match[str]); pattern (type _ActionPattern). Returns: ParsedAction | None.</li></ul><div class='class'><h4>class ParsedDifficulty</h4><p>Descriptor for a system-supplied difficulty roll button.</p><ul><li><code>to_dict(self)</code> &ndash; Returns: dict[str, Any].</li></ul></div><div class='class'><h4>class ParsedAction</h4><p>Lightweight container describing a parsed inline combat action.</p><ul><li><code>to_dict(self)</code> &ndash; Returns: dict[str, Any].</li></ul></div><div class='class'><h4>class ParsedError</h4><p>Structured representation of a validation issue in inline markup.</p><ul><li><code>to_dict(self)</code> &ndash; Returns: dict[str, Any].</li></ul></div><div class='class'><h4>class _DifficultyPattern</h4><p></p><ul></ul></div><div class='class'><h4>class _ActionPattern</h4><p></p><ul></ul></div></section>
<section class='module'><h3>modules\helpers\logging_helper.py</h3><p></p><h4>Functions</h4><ul><li><code>_resolve_directory(directory: str)</code> &ndash; Parameters: directory (type str). Returns: str.</li><li><code>_refresh_logger()</code> &ndash; Returns: logging.Logger.</li><li><code>ensure_logger()</code> &ndash; Returns: tuple[logging.Logger, bool].</li><li><code>is_logging_enabled()</code> &ndash; Returns: bool.</li><li><code>get_active_log_path()</code> &ndash; Returns: Optional[str].</li><li><code>_determine_caller(extra_depth: int=0)</code> &ndash; Parameters: extra_depth (type int, default 0). Returns: str.</li><li><code>_log(level: int, message: str, *, func_name: Optional[str]=None, extra_depth: int=0, exc_info: bool=False)</code> &ndash; Parameters: level (type int); message (type str); func_name (keyword-only, type Optional[str], default None); extra_depth (keyword-only, type int, default 0); exc_info (keyword-only, type bool, default False). Returns: None.</li><li><code>log_debug(message: str, *, func_name: Optional[str]=None)</code> &ndash; Parameters: message (type str); func_name (keyword-only, type Optional[str], default None). Returns: None.</li><li><code>log_info(message: str, *, func_name: Optional[str]=None)</code> &ndash; Parameters: message (type str); func_name (keyword-only, type Optional[str], default None). Returns: None.</li><li><code>log_warning(message: str, *, func_name: Optional[str]=None)</code> &ndash; Parameters: message (type str); func_name (keyword-only, type Optional[str], default None). Returns: None.</li><li><code>log_error(message: str, *, func_name: Optional[str]=None)</code> &ndash; Parameters: message (type str); func_name (keyword-only, type Optional[str], default None). Returns: None.</li><li><code>log_exception(message: str, *, func_name: Optional[str]=None)</code> &ndash; Parameters: message (type str); func_name (keyword-only, type Optional[str], default None). Returns: None.</li><li><code>log_module_import(module_name: Optional[str]=None)</code> &ndash; Parameters: module_name (type Optional[str], default None). Returns: None.</li><li><code>log_function(func: F)</code> &ndash; Parameters: func (type F). Returns: F.</li><li><code>log_methods(cls: type)</code> &ndash; Returns: type.</li><li><code>initialize_logging()</code> &ndash; Returns: bool.</li></ul></section>
<section class='module'><h3>modules\helpers\rich_text_editor.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class RichTextEditor (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, initial_text="", max_lines=100)</code> &ndash; Parameters: master; initial_text (default ""); max_lines (default 100).</li><li><code>update_text_height(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>toggle_bold(self)</code> &ndash; No inline documentation available.</li><li><code>toggle_italic(self)</code> &ndash; No inline documentation available.</li><li><code>toggle_underline(self)</code> &ndash; No inline documentation available.</li><li><code>change_font_size(self)</code> &ndash; No inline documentation available.</li><li><code>change_text_color(self)</code> &ndash; No inline documentation available.</li><li><code>align_left(self)</code> &ndash; No inline documentation available.</li><li><code>align_center(self)</code> &ndash; No inline documentation available.</li><li><code>align_right(self)</code> &ndash; No inline documentation available.</li><li><code>toggle_bullet_list(self)</code> &ndash; No inline documentation available.</li><li><code>toggle_numbered_list(self)</code> &ndash; No inline documentation available.</li><li><code>get_text_data(self)</code> &ndash; Returns a dict with plain text and *integer* formatting ranges.</li><li><code>load_text_data(self, data)</code> &ndash; Loads text and applies formatting from RTF-JSON (with numeric offsets). Parameters: data.</li><li><code>get_text(self)</code> &ndash; For backward compatibility, return plain text.</li><li><code>_index_to_offset(self, index_str)</code> &ndash; Turn a Tk index like "3.14" (line 3, column 14) into a
single integer offset in the full self.text_widget content. Parameters: index_str.</li></ul></div></section>
<section class='module'><h3>modules\helpers\selection_dialog.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class SelectionDialog (ctk.CTkToplevel)</h4><p></p><ul><li><code>__init__(self, master, title, label, options)</code> &ndash; Parameters: master; title; label; options.</li><li><code>on_ok(self)</code> &ndash; No inline documentation available.</li><li><code>on_cancel(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\helpers\swarmui_helper.py</h3><p></p><h4>Functions</h4><ul><li><code>get_available_models()</code> &ndash; No inline documentation available.</li></ul></section>
<section class='module'><h3>modules\helpers\system_config.py</h3><p>Utilities for loading and caching campaign system configuration.</p><h4>Functions</h4><ul><li><code>get_current_system_config()</code> &ndash; Public shortcut for :meth:`SystemConfigManager.get_current_system_config`. Returns: Optional[SystemConfig].</li><li><code>refresh_current_system()</code> &ndash; Public shortcut for :meth:`SystemConfigManager.refresh_current_system`. Returns: Optional[SystemConfig].</li><li><code>set_current_system(slug: str)</code> &ndash; Public shortcut for :meth:`SystemConfigManager.set_current_system`. Parameters: slug (type str). Returns: Optional[SystemConfig].</li><li><code>list_available_systems()</code> &ndash; Public shortcut for :meth:`SystemConfigManager.list_available_systems`. Returns: Tuple[SystemConfig, ...].</li><li><code>register_system_change_listener(callback: ChangeCallback)</code> &ndash; Register a listener for system configuration changes. Parameters: callback (type ChangeCallback). Returns: Callable[[], None].</li><li><code>unregister_system_change_listener(callback: ChangeCallback)</code> &ndash; Unregister a previously registered listener. Parameters: callback (type ChangeCallback). Returns: None.</li></ul><div class='class'><h4>class AnalyzerPattern</h4><p>Normalized representation of an analyzer pattern entry.</p><ul></ul></div><div class='class'><h4>class SystemConfig</h4><p>Fully parsed system configuration for the active campaign.</p><ul></ul></div><div class='class'><h4>class SystemConfigManager</h4><p>Loader and cache for campaign system configuration.</p><ul><li><code>get_current_system_config(cls)</code> &ndash; Return the cached system configuration, refreshing if required. Returns: Optional[SystemConfig].</li><li><code>refresh_current_system(cls)</code> &ndash; Force a reload of the active system configuration. Returns: Optional[SystemConfig].</li><li><code>set_current_system(cls, slug: str)</code> &ndash; Persist a new active system slug and refresh the cache. Parameters: slug (type str). Returns: Optional[SystemConfig].</li><li><code>list_available_systems(cls)</code> &ndash; Return all configured systems parsed into :class:`SystemConfig` objects. Returns: Tuple[SystemConfig, ...].</li><li><code>register_change_listener(cls, callback: ChangeCallback)</code> &ndash; Register a callback invoked whenever the active system changes. Parameters: callback (type ChangeCallback). Returns: Callable[[], None].</li><li><code>unregister_change_listener(cls, callback: ChangeCallback)</code> &ndash; Remove a previously registered change listener. Parameters: callback (type ChangeCallback). Returns: None.</li><li><code>_refresh_cache(cls, *, force: bool)</code> &ndash; Reload the cached configuration if required.

Returns a tuple of (config, changed) indicating whether the cached
configuration was updated. Parameters: force (keyword-only, type bool). Returns: Tuple[Optional[SystemConfig], bool].</li><li><code>_resolve_system_config(cls, slug: Optional[str])</code> &ndash; Load the system configuration for ``slug`` (falling back to defaults). Parameters: slug (type Optional[str]). Returns: Optional[SystemConfig].</li><li><code>_load_config_for_slug(cls, slug: str)</code> &ndash; Parameters: slug (type str). Returns: Optional[SystemConfig].</li><li><code>_load_first_system(cls)</code> &ndash; Returns: Optional[SystemConfig].</li><li><code>_fetch_all_system_rows(cls)</code> &ndash; Returns: Sequence[Tuple[Any, ...]].</li><li><code>_row_to_config(cls, row: Optional[Sequence[Any]])</code> &ndash; Parameters: row (type Optional[Sequence[Any]]). Returns: Optional[SystemConfig].</li><li><code>_parse_supported_faces(raw_json: Optional[str])</code> &ndash; Parameters: raw_json (type Optional[str]). Returns: Tuple[FaceValue, ...].</li><li><code>_parse_analyzer_config(cls, raw_json: Optional[str])</code> &ndash; Parameters: raw_json (type Optional[str]). Returns: Tuple[Tuple[AnalyzerPattern, ...], Mapping[str, Any]].</li><li><code>_mapping_proxy(data: Optional[Mapping[str, Any]])</code> &ndash; Parameters: data (type Optional[Mapping[str, Any]]). Returns: Mapping[str, Any].</li><li><code>_system_exists(cls, slug: str)</code> &ndash; Parameters: slug (type str). Returns: bool.</li><li><code>_compute_db_signature(cls)</code> &ndash; Returns: Tuple[Optional[str], Optional[float], Optional[int], Optional[int]].</li><li><code>_notify_listeners(cls, config: SystemConfig)</code> &ndash; Parameters: config (type SystemConfig). Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\helpers\template_loader.py</h3><p></p><h4>Functions</h4><ul><li><code>_default_template_path(entity_name: str)</code> &ndash; Parameters: entity_name (type str). Returns: str.</li><li><code>_campaign_template_path(entity_name: str)</code> &ndash; Parameters: entity_name (type str). Returns: str.</li><li><code>_template_path(entity_name: str)</code> &ndash; Prefer campaign-local template if it exists, else fall back to defaults. Parameters: entity_name (type str). Returns: str.</li><li><code>_load_base_template(entity_name: str)</code> &ndash; Load the current template JSON (campaign-local if present). Parameters: entity_name (type str). Returns: dict.</li><li><code>_custom_manifest_path()</code> &ndash; Returns: str.</li><li><code>_load_custom_manifest()</code> &ndash; Returns: dict.</li><li><code>_save_custom_manifest(manifest: dict)</code> &ndash; Parameters: manifest (type dict).</li><li><code>_resolve_icon_path(icon_value: str | None)</code> &ndash; Parameters: icon_value (type str | None). Returns: str | None.</li><li><code>_prepare_icon_for_entity(entity_slug: str, icon_source: str | None)</code> &ndash; Parameters: entity_slug (type str); icon_source (type str | None). Returns: str | None.</li><li><code>load_entity_definitions()</code> &ndash; Return mapping of entity slug to metadata (label, icon, is_custom). Returns: dict.</li><li><code>load_template(entity_name: str)</code> &ndash; Load template and return merged fields (fields + custom_fields if present).

Built-in fields remain separate inside the file under "fields". User-added
fields are persisted under "custom_fields" and merged at runtime for UI. Parameters: entity_name (type str). Returns: dict.</li><li><code>create_custom_entity(entity_slug: str, display_name: str, icon_source: str | None=None)</code> &ndash; Create a campaign-local template for ``entity_slug`` and register metadata. Parameters: entity_slug (type str); display_name (type str); icon_source (type str | None, default None). Returns: dict.</li><li><code>update_custom_entity(entity_slug: str, display_name: str | None=None, *, icon_source: str | None=None, clear_icon: bool=False)</code> &ndash; Update label and/or icon metadata for an existing custom entity. Parameters: entity_slug (type str); display_name (type str | None, default None); icon_source (keyword-only, type str | None, default None); clear_icon (keyword-only, type bool, default False). Returns: dict.</li><li><code>delete_custom_entity(entity_slug: str)</code> &ndash; Remove an existing custom entity definition and its template. Parameters: entity_slug (type str).</li><li><code>_render_template_content(fields: list, custom_fields: list)</code> &ndash; Return the canonical JSON body for a template file. Parameters: fields (type list); custom_fields (type list). Returns: str.</li><li><code>_write_template_file(path: str, fields: list, custom_fields: list)</code> &ndash; Write template content to ``path`` using canonical formatting. Parameters: path (type str); fields (type list); custom_fields (type list).</li><li><code>save_custom_fields(entity_name: str, fields: list)</code> &ndash; Write custom fields into the entity template file under "custom_fields" key.

File format goal: keep the overall JSON pretty-printed with indent=2, but
ensure each custom field object is rendered on a single line for clarity. Parameters: entity_name (type str); fields (type list).</li><li><code>sync_campaign_template(entity_name: str)</code> &ndash; Ensure the campaign template for ``entity_name`` matches the default fields.

Returns ``True`` when the campaign template file was created or updated.
Existing ``custom_fields`` are preserved when rewriting the file. Parameters: entity_name (type str). Returns: bool.</li><li><code>list_known_entities()</code> &ndash; Returns: list.</li><li><code>build_entity_wrappers()</code> &ndash; Return ``slug -&gt; GenericModelWrapper`` for all known entities. Returns: dict.</li></ul></section>
<section class='module'><h3>modules\helpers\text_helpers.py</h3><p></p><h4>Functions</h4><ul><li><code>format_longtext(data, max_length=30000)</code> &ndash; Formate un champ longtext pour l'afficher dans une liste (abrégé + multi-lignes). Parameters: data; max_length (default 30000).</li><li><code>format_multiline_text(data, max_length=30000)</code> &ndash; Like format_longtext but *preserves* newlines for HTML &lt;pre‑wrap&gt; output. Parameters: data; max_length (default 30000).</li><li><code>rtf_to_html(rtf)</code> &ndash; Convert RTF-JSON {"text":…, "formatting":…} into HTML, handling:
- numeric offsets (e.g. "0", "26")
- Tk indices (e.g. "1.26" for line 1, column 26) Parameters: rtf.</li><li><code>normalize_rtf_json(rtf, text_widget=None)</code> &ndash; Convert any { text:str, formatting:{ tag:[[s,e],…], … } }
where s/e might be "line.char" (e.g. "1.26")
into integer offsets. Parameters: rtf; text_widget (default None).</li><li><code>ai_text_to_rtf_json(raw_text)</code> &ndash; Convert an AI answer (plain text with light Markdown/HTML) to our RTF-JSON:
{"text": str, "formatting": { tag: [(start,end), ...], ... }}

Supported inline markers:
- Bold: **text**, __text__, &lt;b&gt;text&lt;/b&gt;, &lt;strong&gt;text&lt;/strong&gt;
- Italic: *text*, _text_, &lt;i&gt;text&lt;/i&gt;, &lt;em&gt;text&lt;/em&gt;
- Underline: ++text++, &lt;u&gt;text&lt;/u&gt;

Block helpers:
- Headings: #, ##, ### → size_22/18/16 on the full line text
- Bullets: lines starting with "- " or "* " are turned into "• " prefix
- Numbered: lines starting with "1. ", "2) ", etc. are kept as-is

Returns formatting with numeric offsets suitable for RichTextEditor.load_text_data. Parameters: raw_text.</li><li><code>_coerce_text(val)</code> &ndash; Parameters: val.</li><li><code>coerce_text(val)</code> &ndash; Return a plain-text representation for longtext-style values.

Many parts of the UI accept data that may either be a raw string or the
richer ``{"text": ..., "formatting": ...}`` structure produced by
importers.  ``coerce_text`` normalises the value so widgets can safely
display it without worrying about the underlying shape. Parameters: val.</li><li><code>format_longtext(data, max_length=30000)</code> &ndash; Parameters: data; max_length (default 30000).</li><li><code>format_multiline_text(data, max_length=30000)</code> &ndash; Parameters: data; max_length (default 30000).</li></ul></section>
<section class='module'><h3>modules\helpers\window_helper.py</h3><p></p><h4>Functions</h4><ul><li><code>position_window_at_top(window, width=None, height=None)</code> &ndash; Positionne une fenêtre au sommet de l'écran, centrée horizontalement.

Args:
    window: la fenêtre CustomTkinter ou Tkinter à positionner.
    width: largeur fixe (facultatif). Si None, utilise la taille actuelle.
    height: hauteur fixe (facultatif). Si None, utilise la taille actuelle. Parameters: window; width (default None); height (default None).</li></ul></section>
<section class='module'><h3>modules\informations\informations_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\maps\controllers\display_map_controller.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class DisplayMapController</h4><p></p><ul><li><code>__init__(self, parent, maps_wrapper, map_template, *, root_app=None)</code> &ndash; Parameters: parent; maps_wrapper; map_template; root_app (keyword-only, default None).</li><li><code>_on_fit_mode_change(self, value)</code> &ndash; Parameters: value.</li><li><code>_apply_fit_mode(self, *, defer: bool=False)</code> &ndash; Parameters: defer (keyword-only, type bool, default False).</li><li><code>_set_selection(self, items)</code> &ndash; Centralised helper to assign the current selection list. Parameters: items.</li><li><code>_clear_selection(self)</code> &ndash; No inline documentation available.</li><li><code>_is_shift_pressed(self, event)</code> &ndash; Parameters: event.</li><li><code>_is_ctrl_pressed(self, event)</code> &ndash; Parameters: event.</li><li><code>_update_selection_state(self, item, event=None)</code> &ndash; Parameters: item; event (default None).</li><li><code>_prepare_item_selection(self, item, event=None)</code> &ndash; Parameters: item; event (default None).</li><li><code>_start_drag_selection(self, event, existing_selection=None)</code> &ndash; Parameters: event; existing_selection (default None).</li><li><code>_rectangles_overlap(self, a, b)</code> &ndash; Parameters: a; b.</li><li><code>_collect_items_in_rect(self, x1, y1, x2, y2)</code> &ndash; Parameters: x1; y1; x2; y2.</li><li><code>_merge_drag_selection(self, items_in_rect)</code> &ndash; Parameters: items_in_rect.</li><li><code>_update_drag_selection(self, event)</code> &ndash; Parameters: event.</li><li><code>_cleanup_drag_selection(self)</code> &ndash; No inline documentation available.</li><li><code>_finalize_drag_selection(self, event)</code> &ndash; Parameters: event.</li><li><code>_get_item_category(self, item)</code> &ndash; Parameters: item.</li><li><code>_ensure_selection_for_context_menu(self, item)</code> &ndash; Parameters: item.</li><li><code>_get_selection_icon_image(self, width, height)</code> &ndash; Parameters: width; height.</li><li><code>_calculate_item_bbox(self, item)</code> &ndash; Parameters: item.</li><li><code>_remove_selection_overlay(self, item=None, key=None)</code> &ndash; Parameters: item (default None); key (default None).</li><li><code>_update_selection_indicators(self)</code> &ndash; No inline documentation available.</li><li><code>open_map_by_name(self, map_name, *, apply_fit=True)</code> &ndash; Parameters: map_name; apply_fit (keyword-only, default True).</li><li><code>open_global_search(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>open_chatbot_assistant(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>add_marker(self)</code> &ndash; No inline documentation available.</li><li><code>_on_marker_text_change(self, marker, persist=False)</code> &ndash; Parameters: marker; persist (default False).</li><li><code>_on_marker_entry_return(self, event, marker)</code> &ndash; Parameters: event; marker.</li><li><code>_on_marker_description_change(self, marker, new_text=None, persist=False)</code> &ndash; Parameters: marker; new_text (default None); persist (default False).</li><li><code>_update_marker_entry_dimensions(self, marker, expand=False)</code> &ndash; Parameters: marker; expand (default False).</li><li><code>_expand_marker_entry(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_collapse_marker_entry(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_on_marker_entry_focus_in(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_on_marker_entry_focus_out(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_on_marker_entry_press(self, event, marker)</code> &ndash; Parameters: event; marker.</li><li><code>_on_marker_entry_click(self, event, marker)</code> &ndash; Parameters: event; marker.</li><li><code>_show_marker_description(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_hide_marker_description(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_hide_all_marker_descriptions(self)</code> &ndash; No inline documentation available.</li><li><code>_hide_other_marker_descriptions(self, active_marker)</code> &ndash; Parameters: active_marker.</li><li><code>_hide_all_token_hovers(self)</code> &ndash; No inline documentation available.</li><li><code>_hide_other_token_hovers(self, active_token)</code> &ndash; Parameters: active_token.</li><li><code>_on_canvas_focus_out(self, event=None)</code> &ndash; Hide hover windows when the canvas loses focus, unless the focus
moved inside one of the hover popups. Parameters: event (default None).</li><li><code>_widget_is_within_hover_popup(self, widget)</code> &ndash; Return True if *widget* is a descendant of any registered hover popup. Parameters: widget. Returns: bool.</li><li><code>clear_hover_windows(self)</code> &ndash; Hide all token and marker info popups.</li><li><code>_on_application_focus_out(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>_show_marker_menu(self, event, markers)</code> &ndash; Parameters: event; markers.</li><li><code>_open_marker_linked_map(self, marker, silent=False)</code> &ndash; Parameters: marker; silent (default False).</li><li><code>_choose_marker_linked_map(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_clear_marker_link(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_change_markers_border_color(self, markers)</code> &ndash; Parameters: markers.</li><li><code>_change_marker_border_color(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_attach_video_to_markers(self, markers)</code> &ndash; Parameters: markers.</li><li><code>_clear_marker_videos(self, markers)</code> &ndash; Parameters: markers.</li><li><code>_play_marker_video(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_edit_marker_description(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_ensure_marker_description_popup(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_refresh_marker_description_popup(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_on_hover_font_size_change(self, value)</code> &ndash; Parameters: value.</li><li><code>_extract_longtext_text(value)</code> &ndash; Parameters: value.</li><li><code>_resolve_dice_bar_window(self)</code> &ndash; Returns: "DiceBarWindow | None".</li><li><code>_get_token_hover_text(self, token)</code> &ndash; Parameters: token.</li><li><code>_format_action_header(action: dict)</code> &ndash; Parameters: action (type dict). Returns: str.</li><li><code>_format_attack_button_text(action: dict)</code> &ndash; Parameters: action (type dict). Returns: str.</li><li><code>_format_damage_button_text(action: dict)</code> &ndash; Parameters: action (type dict). Returns: str.</li><li><code>_execute_token_hover_action(self, token: dict, action: dict, roll_type: str)</code> &ndash; Run a token hover action while temporarily suppressing auto-hide logic. Parameters: token (type dict); action (type dict); roll_type (type str). Returns: None.</li><li><code>_roll_token_action(self, token: dict, action: dict, roll_type: str)</code> &ndash; Parameters: token (type dict); action (type dict); roll_type (type str). Returns: None.</li><li><code>_format_roll_summary(kind: str, formula: str, result)</code> &ndash; Parameters: kind (type str); formula (type str); result. Returns: str.</li><li><code>_ensure_token_hover_popup(self, token)</code> &ndash; Parameters: token.</li><li><code>_register_hover_popup(self, popup)</code> &ndash; Keep a reference to created hover popups for global dismissal. Parameters: popup.</li><li><code>_refresh_token_hover_popup(self, token)</code> &ndash; Parameters: token.</li><li><code>_populate_token_links(self, token: dict, display_text: str)</code> &ndash; Parameters: token (type dict); display_text (type str). Returns: None.</li><li><code>_iter_text_fragments(value)</code> &ndash; Parameters: value.</li><li><code>_extract_links_from_sources(cls, sources)</code> &ndash; Parameters: sources. Returns: list[str].</li><li><code>_extract_links_from_text(text: str)</code> &ndash; Parameters: text (type str). Returns: list[str].</li><li><code>_open_external_link(url: str)</code> &ndash; Parameters: url (type str). Returns: None.</li><li><code>_show_token_hover(self, token)</code> &ndash; Parameters: token.</li><li><code>_hide_token_hover(self, token)</code> &ndash; Parameters: token.</li><li><code>_open_marker_description_editor(self, marker)</code> &ndash; Parameters: marker.</li><li><code>_widget_event_to_canvas_event(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_marker_handle_press(self, event, marker)</code> &ndash; Parameters: event; marker.</li><li><code>_on_marker_handle_drag(self, event, marker)</code> &ndash; Parameters: event; marker.</li><li><code>_on_marker_handle_release(self, event, marker)</code> &ndash; Parameters: event; marker.</li><li><code>_push_fog_history(self)</code> &ndash; No inline documentation available.</li><li><code>undo_fog(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>_on_token_right_click(self, event, tokens, clicked_token)</code> &ndash; Parameters: event; tokens; clicked_token.</li><li><code>_on_token_double_click(self, event, token)</code> &ndash; Parameters: event; token.</li><li><code>_create_marker(self)</code> &ndash; No inline documentation available.</li><li><code>_schedule_marker_animation(self)</code> &ndash; No inline documentation available.</li><li><code>_animate_marker(self)</code> &ndash; No inline documentation available.</li><li><code>_on_middle_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_middle_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_middle_release(self, event)</code> &ndash; Parameters: event.</li><li><code>_nudge_canvas(self, dx, dy)</code> &ndash; Move all visible canvas items by dx,dy without recomputing images. Parameters: dx; dy.</li><li><code>_on_mouse_down(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_mouse_move(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_mouse_up(self, event)</code> &ndash; Parameters: event.</li><li><code>_perform_zoom(self, final: bool)</code> &ndash; Parameters: final (type bool).</li><li><code>_update_canvas_images(self, resample=Image.LANCZOS)</code> &ndash; Parameters: resample (default Image.LANCZOS).</li><li><code>_bind_item_events(self, item)</code> &ndash; Parameters: item.</li><li><code>_on_item_press(self, event, item)</code> &ndash; Parameters: event; item.</li><li><code>_on_item_move(self, event, item)</code> &ndash; Parameters: event; item.</li><li><code>_on_item_release(self, event, item)</code> &ndash; Parameters: event; item.</li><li><code>_get_drag_targets(self, primary_item)</code> &ndash; Parameters: primary_item.</li><li><code>_apply_drag_delta_to_item(self, item, dx, dy)</code> &ndash; Parameters: item; dx; dy.</li><li><code>_handle_item_click(self, event, item)</code> &ndash; Parameters: event; item.</li><li><code>_on_marker_double_click(self, event, marker)</code> &ndash; Parameters: event; marker.</li><li><code>_on_item_right_click(self, event, item)</code> &ndash; Parameters: event; item.</li><li><code>_show_shape_menu(self, event, shapes)</code> &ndash; Parameters: event; shapes.</li><li><code>_edit_shapes_color(self, shapes)</code> &ndash; Parameters: shapes.</li><li><code>_resize_shapes_dialog(self, shapes)</code> &ndash; Parameters: shapes.</li><li><code>_toggle_shapes_fill(self, shapes)</code> &ndash; Parameters: shapes.</li><li><code>_edit_shape_color_dialog(self, shape)</code> &ndash; Parameters: shape.</li><li><code>_resize_shape_dialog(self, shape)</code> &ndash; Parameters: shape.</li><li><code>_resize_tokens(self, tokens)</code> &ndash; Parameters: tokens.</li><li><code>_apply_token_size(self, token, new_size)</code> &ndash; Parameters: token; new_size.</li><li><code>_resize_token_dialog(self, token)</code> &ndash; Parameters: token.</li><li><code>_show_token_menu(self, event, tokens)</code> &ndash; Parameters: event; tokens.</li><li><code>_show_portraits_for_tokens(self, tokens)</code> &ndash; Parameters: tokens.</li><li><code>_play_audio_for_tokens(self, tokens)</code> &ndash; Parameters: tokens.</li><li><code>_get_token_audio_value(self, token)</code> &ndash; Parameters: token.</li><li><code>_play_token_audio(self, token)</code> &ndash; Parameters: token.</li><li><code>_prompt_change_token_border_color(self, tokens)</code> &ndash; Parameters: tokens.</li><li><code>_toggle_shape_fill(self, shape)</code> &ndash; Parameters: shape.</li><li><code>_delete_items(self, items)</code> &ndash; Parameters: items.</li><li><code>_bring_items_to_front(self, items)</code> &ndash; Parameters: items.</li><li><code>_send_items_to_back(self, items)</code> &ndash; Parameters: items.</li><li><code>_copy_item(self, item_to_copy=None)</code> &ndash; Parameters: item_to_copy (default None).</li><li><code>_clipboard_value_should_skip(self, value)</code> &ndash; Parameters: value.</li><li><code>_sanitize_clipboard_structure(self, value, memo=None)</code> &ndash; Parameters: value; memo (default None).</li><li><code>_clone_item_for_clipboard(self, item, reference_position)</code> &ndash; Parameters: item; reference_position.</li><li><code>_paste_item(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>_delete_item(self, item_to_delete)</code> &ndash; Parameters: item_to_delete.</li><li><code>_bring_item_to_front(self, item)</code> &ndash; Parameters: item.</li><li><code>_send_item_to_back(self, item)</code> &ndash; Parameters: item.</li><li><code>_on_max_hp_menu_click(self, event, token)</code> &ndash; Parameters: event; token.</li><li><code>_on_max_hp_entry_commit(self, event, token)</code> &ndash; Parameters: event; token.</li><li><code>_on_hp_double_click(self, event, token)</code> &ndash; Parameters: event; token.</li><li><code>_on_hp_entry_commit(self, event, token)</code> &ndash; Parameters: event; token.</li><li><code>on_resize(self)</code> &ndash; No inline documentation available.</li><li><code>on_zoom(self, event)</code> &ndash; Parameters: event.</li><li><code>save_map(self)</code> &ndash; No inline documentation available.</li><li><code>_on_drawing_tool_change(self, selected_tool: str)</code> &ndash; Parameters: selected_tool (type str).</li><li><code>_on_shape_fill_mode_change(self, selected_mode: str)</code> &ndash; Parameters: selected_mode (type str).</li><li><code>_on_pick_shape_fill_color(self)</code> &ndash; No inline documentation available.</li><li><code>_on_pick_shape_border_color(self)</code> &ndash; No inline documentation available.</li><li><code>_update_shape_controls_visibility(self)</code> &ndash; No inline documentation available.</li><li><code>_activate_graphical_resize(self, shape)</code> &ndash; Parameters: shape.</li><li><code>_draw_resize_handles(self, item)</code> &ndash; Parameters: item.</li><li><code>_remove_resize_handles(self)</code> &ndash; No inline documentation available.</li><li><code>_on_resize_handle_press(self, event, handle_type)</code> &ndash; Parameters: event; handle_type.</li><li><code>_on_resize_handle_move(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_resize_handle_release(self, event)</code> &ndash; Parameters: event.</li></ul></div></section>
<section class='module'><h3>modules\maps\exporters\__init__.py</h3><p>Export helpers for third-party virtual tabletops.</p><h4>Functions</h4><ul></ul></section>
<section class='module'><h3>modules\maps\exporters\maptools.py</h3><p></p><h4>Functions</h4><ul><li><code>build_token_macros(actions: List[Dict[str, Any]], *, token_name: str | None=None)</code> &ndash; Return MapTool-style macro definitions for the provided actions. Parameters: actions (type List[Dict[str, Any]]); token_name (keyword-only, type str | None, default None). Returns: List[Dict[str, str]].</li><li><code>_normalize_formula(value: Any)</code> &ndash; Parameters: value (type Any). Returns: str.</li></ul></section>
<section class='module'><h3>modules\maps\maps_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\maps\services\entity_picker_service.py</h3><p></p><h4>Functions</h4><ul><li><code>open_entity_picker(self, entity_type)</code> &ndash; Show a GenericListSelectionView for NPCs or Creatures. Parameters: entity_type.</li><li><code>on_entity_selected(self, entity_type, entity_name, picker_frame)</code> &ndash; Called when user picks an NPC or Creature in the selection dialog. Parameters: entity_type; entity_name; picker_frame.</li><li><code>on_entities_selected(self, entity_type, records, picker_frame)</code> &ndash; Add multiple entities to the map in one action. Parameters: entity_type; records; picker_frame.</li><li><code>_extract_portrait_path(record)</code> &ndash; Parameters: record.</li><li><code>_get_entity_display_name(record)</code> &ndash; Parameters: record.</li><li><code>_add_entity_record(self, entity_type, record)</code> &ndash; Parameters: entity_type; record.</li></ul></section>
<section class='module'><h3>modules\maps\services\fog_manager.py</h3><p></p><h4>Functions</h4><ul><li><code>_set_fog(self, mode)</code> &ndash; Toggle the active fog brush mode between add/remove/none. Parameters: mode.</li><li><code>clear_fog(self)</code> &ndash; No inline documentation available.</li><li><code>reset_fog(self)</code> &ndash; No inline documentation available.</li><li><code>on_paint(self, event)</code> &ndash; Paint or erase fog using a square brush of size self.brush_size,
with semi-transparent black (alpha=128) for fog. Parameters: event.</li></ul></section>
<section class='module'><h3>modules\maps\services\token_manager.py</h3><p></p><h4>Functions</h4><ul><li><code>_resolve_campaign_path(path: str)</code> &ndash; Parameters: path (type str). Returns: str.</li><li><code>_campaign_relative_path(path: str)</code> &ndash; Parameters: path (type str). Returns: str.</li><li><code>_deserialize_tokens_field(raw_tokens: Any)</code> &ndash; Return a list of token dicts and remember the original container type. Parameters: raw_tokens (type Any). Returns: Tuple[list, type].</li><li><code>normalize_existing_token_paths(maps_wrapper)</code> &ndash; Convert stored token image paths to campaign-relative references. Parameters: maps_wrapper. Returns: bool.</li><li><code>add_token(self, path, entity_type, entity_name, entity_record=None)</code> &ndash; Parameters: path; entity_type; entity_name; entity_record (default None).</li><li><code>_on_token_press(self, event, token)</code> &ndash; Parameters: event; token.</li><li><code>_on_token_move(self, event, token)</code> &ndash; Parameters: event; token.</li><li><code>_on_token_release(self, event, token)</code> &ndash; Parameters: event; token.</li><li><code>_copy_token(self, event=None)</code> &ndash; Copy the last‐clicked token’s data into a buffer. Parameters: event (default None).</li><li><code>_paste_token(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>_resize_token_dialog(self, token)</code> &ndash; Prompt for a new px size, then redraw just that token. Parameters: token.</li><li><code>_change_token_border_color(self, token)</code> &ndash; Open a color chooser and update the token’s border. Parameters: token.</li><li><code>_delete_token(self, token)</code> &ndash; Remove a token’s canvas items (image, border, name, HP UI, info widget, edit entries) and its data. Parameters: token.</li><li><code>_persist_tokens(self)</code> &ndash; Quickly capture token state, then hand off the heavy write to a daemon thread.</li></ul></section>
<section class='module'><h3>modules\maps\utils\icon_loader.py</h3><p></p><h4>Functions</h4><ul><li><code>load_icon(self, path, size=(32,32))</code> &ndash; Parameters: path; size (default (32,32)).</li></ul></section>
<section class='module'><h3>modules\maps\views\canvas_view.py</h3><p></p><h4>Functions</h4><ul><li><code>_build_canvas(self)</code> &ndash; No inline documentation available.</li><li><code>_on_delete_key(self, event=None)</code> &ndash; Delete the hovered marker or the currently selected item when Delete is pressed. Parameters: event (default None).</li><li><code>on_paint2(self, event)</code> &ndash; Paint or erase fog using a square brush of size self.brush_size,
with semi-transparent black (alpha=128) for fog. Parameters: event.</li></ul></section>
<section class='module'><h3>modules\maps\views\fullscreen_view.py</h3><p></p><h4>Functions</h4><ul><li><code>open_fullscreen(self)</code> &ndash; No inline documentation available.</li><li><code>_update_fullscreen_map(self)</code> &ndash; Mirror the GM canvas into the fullscreen window.</li></ul></section>
<section class='module'><h3>modules\maps\views\map_selector.py</h3><p></p><h4>Functions</h4><ul><li><code>_resolve_campaign_path(path: str)</code> &ndash; Return an absolute path for campaign-relative assets. Parameters: path (type str). Returns: str.</li><li><code>_campaign_relative_path(path: str)</code> &ndash; Parameters: path (type str). Returns: str.</li><li><code>_default_token_image_path()</code> &ndash; Locate the default pin image shipped with the application. Returns: str.</li><li><code>_find_existing_token_image(original_path: str)</code> &ndash; Attempt to locate a token image inside the current campaign.

Some persisted databases contain absolute paths from other machines. When
those paths are reloaded we try to discover a matching asset inside the
active campaign directory by progressively stripping leading folders and
finally falling back to a filename search beneath the campaign's assets
directory. Returns an absolute path if a match is found, otherwise an empty
string. Parameters: original_path (type str). Returns: str.</li><li><code>select_map(self)</code> &ndash; Show the full‐frame map selector, replacing any existing UI.</li><li><code>_on_display_map(self, entity_type, map_name)</code> &ndash; Callback from selector: build editor UI and load the chosen map. Parameters: entity_type; map_name.</li></ul></section>
<section class='module'><h3>modules\maps\views\toolbar_view.py</h3><p></p><h4>Functions</h4><ul><li><code>_build_toolbar(self)</code> &ndash; No inline documentation available.</li><li><code>_on_brush_size_change(self, val)</code> &ndash; Parameters: val.</li><li><code>_on_brush_shape_change(self, val)</code> &ndash; Parameters: val.</li><li><code>_change_brush(self, delta)</code> &ndash; Parameters: delta.</li><li><code>_on_token_size_change(self, val)</code> &ndash; Parameters: val.</li><li><code>_update_fog_button_states(self)</code> &ndash; Update fog button appearance to reflect the active fog tool.</li></ul></section>
<section class='module'><h3>modules\maps\views\web_display_view.py</h3><p></p><h4>Functions</h4><ul><li><code>open_web_display(self, port=None)</code> &ndash; Parameters: port (default None).</li><li><code>_render_map_image(self)</code> &ndash; No inline documentation available.</li><li><code>_update_web_display_map(self)</code> &ndash; No inline documentation available.</li><li><code>close_web_display(self, port=None)</code> &ndash; Shut down the web display server if it is running.

The server is stopped using Werkzeug's ``shutdown`` API rather than
sending an HTTP request to a dedicated route. Parameters: port (default None).</li></ul></section>
<section class='module'><h3>modules\maps\world_map_view.py</h3><p>World Map exploration window with nested map navigation and entity synthesis.</p><h4>Functions</h4><ul><li><code>_default_pin_image_path()</code> &ndash; Return the absolute path to the bundled pin placeholder image. Returns: str.</li></ul><div class='class'><h4>class WorldMapPanel (ctk.CTkFrame)</h4><p>Interactive world map panel with nested map support.

Can be embedded in other views (e.g., GM screen tabs). For legacy callers,
see WorldMapWindow below, which wraps this panel in a CTkToplevel.</p><ul><li><code>__init__(self, master=None)</code> &ndash; Parameters: master (default None).</li><li><code>_build_layout(self)</code> &ndash; Returns: None.</li><li><code>_on_inspector_tab_selected(self, tab_name: str)</code> &ndash; Parameters: tab_name (type str). Returns: None.</li><li><code>_select_inspector_tab(self, tab_name: str)</code> &ndash; Parameters: tab_name (type str). Returns: None.</li><li><code>_clear_tab_contents(self, tab_name: str)</code> &ndash; Parameters: tab_name (type str). Returns: None.</li><li><code>_render_tab_message(self, tab_name: str, message: str)</code> &ndash; Parameters: tab_name (type str); message (type str). Returns: None.</li><li><code>_load_world_map_store(self)</code> &ndash; Returns: dict.</li><li><code>_save_world_map_store(self)</code> &ndash; Returns: None.</li><li><code>_seed_world_maps(self)</code> &ndash; Returns: None.</li><li><code>_ensure_world_map_entry(self, map_name: str)</code> &ndash; Parameters: map_name (type str). Returns: dict | None.</li><li><code>_show_empty_state(self)</code> &ndash; Returns: None.</li><li><code>_on_map_selected(self, selected: str)</code> &ndash; Parameters: selected (type str). Returns: None.</li><li><code>load_map(self, map_name: str, *, push_history: bool=True)</code> &ndash; Parameters: map_name (type str); push_history (keyword-only, type bool, default True). Returns: None.</li><li><code>navigate_back(self)</code> &ndash; Returns: None.</li><li><code>navigate_to_map(self, child_map: str | None)</code> &ndash; Parameters: child_map (type str | None). Returns: None.</li><li><code>_update_back_button_state(self)</code> &ndash; Returns: None.</li><li><code>_update_map_tool_button_state(self)</code> &ndash; Returns: None.</li><li><code>_open_in_map_tool(self)</code> &ndash; Returns: None.</li><li><code>_focus_on_selected_token(self)</code> &ndash; Returns: None.</li><li><code>_focus_on_token(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_open_selected_record(self)</code> &ndash; Returns: None.</li><li><code>_open_selected_in_map_tool(self)</code> &ndash; Returns: None.</li><li><code>_open_picker(self, entity_type: str)</code> &ndash; Parameters: entity_type (type str). Returns: None.</li><li><code>_add_token(self, entity_type: str, record: dict)</code> &ndash; Parameters: entity_type (type str); record (type dict). Returns: None.</li><li><code>_build_token(self, entity_type: str, record: dict)</code> &ndash; Parameters: entity_type (type str); record (type dict). Returns: dict.</li><li><code>_deserialize_tokens(self, entry: dict)</code> &ndash; Parameters: entry (type dict). Returns: list[dict].</li><li><code>_persist_tokens(self)</code> &ndash; Returns: None.</li><li><code>_load_base_image(self)</code> &ndash; Returns: None.</li><li><code>_draw_scene(self)</code> &ndash; Returns: None.</li><li><code>_apply_pending_view_state(self, base_scale: float, base_w: int, base_h: int)</code> &ndash; Parameters: base_scale (type float); base_w (type int); base_h (type int). Returns: None.</li><li><code>_capture_view_state(self)</code> &ndash; Returns: dict | None.</li><li><code>_clamp_zoom(self, zoom: float)</code> &ndash; Parameters: zoom (type float). Returns: float.</li><li><code>_on_mouse_wheel(self, event, direction: int | None=None)</code> &ndash; Parameters: event; direction (type int | None, default None).</li><li><code>_adjust_zoom(self, factor: float, focus: tuple[float, float] | None=None)</code> &ndash; Parameters: factor (type float); focus (type tuple[float, float] | None, default None). Returns: None.</li><li><code>_on_pan_start(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_pan_move(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_pan_end(self, _event)</code> &ndash; Parameters: _event.</li><li><code>_on_save_shortcut(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_safe_float(value, default: float=0.0)</code> &ndash; Parameters: value; default (type float, default 0.0). Returns: float.</li><li><code>_draw_token(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_create_token_pil_image(self, token: dict, size: int)</code> &ndash; Parameters: token (type dict); size (type int). Returns: Image.Image.</li><li><code>_resolve_token_image(self, token: dict, size: int)</code> &ndash; Parameters: token (type dict); size (type int). Returns: ImageTk.PhotoImage.</li><li><code>_resolve_token_ctk_image(self, token: dict, size: int)</code> &ndash; Parameters: token (type dict); size (type int). Returns: ctk.CTkImage.</li><li><code>_resolve_token_color(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: str.</li><li><code>_load_image(self, path: str)</code> &ndash; Parameters: path (type str). Returns: Image.Image | None.</li><li><code>_create_portrait_placeholder(self)</code> &ndash; Returns: Image.Image.</li><li><code>_set_portrait_image(self, pil_image: Image.Image | None)</code> &ndash; Parameters: pil_image (type Image.Image | None). Returns: None.</li><li><code>_on_token_press(self, event, token: dict)</code> &ndash; Parameters: event; token (type dict). Returns: None.</li><li><code>_on_token_drag(self, event, token: dict)</code> &ndash; Parameters: event; token (type dict). Returns: None.</li><li><code>_on_token_release(self, _event, token: dict)</code> &ndash; Parameters: _event; token (type dict). Returns: None.</li><li><code>_on_token_double_click(self, _event, token: dict)</code> &ndash; Parameters: _event; token (type dict). Returns: None.</li><li><code>_delete_selected_token(self, _event=None)</code> &ndash; Parameters: _event (default None). Returns: None.</li><li><code>_show_token_menu(self, event, token: dict)</code> &ndash; Parameters: event; token (type dict). Returns: None.</li><li><code>_prompt_resize(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_delete_token(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_configure_inspector_actions(self, token: dict | None)</code> &ndash; Parameters: token (type dict | None). Returns: None.</li><li><code>_clear_inspector(self)</code> &ndash; Returns: None.</li><li><code>_show_entity_synthesis(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_show_map_hint(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_set_quick_actions_state(self, enabled: bool)</code> &ndash; Parameters: enabled (type bool). Returns: None.</li><li><code>_on_highlight_token(self)</code> &ndash; Returns: None.</li><li><code>_pulse_token(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_on_color_swatch_click(self)</code> &ndash; Returns: None.</li><li><code>_update_color_swatch(self, token: dict | None)</code> &ndash; Parameters: token (type dict | None). Returns: None.</li><li><code>_prompt_token_color(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_ask_token_color(self, initial: str | None=None)</code> &ndash; Parameters: initial (type str | None, default None). Returns: str | None.</li><li><code>_extract_color_hex(selection)</code> &ndash; Parameters: selection. Returns: str | None.</li><li><code>_normalize_hex_color(value: str | None)</code> &ndash; Parameters: value (type str | None). Returns: str | None.</li><li><code>_calculate_swatch_border(color: str)</code> &ndash; Parameters: color (type str). Returns: str.</li><li><code>_render_badges(self, labels: list[str])</code> &ndash; Parameters: labels (type list[str]). Returns: None.</li><li><code>_clear_summary_sections(self)</code> &ndash; Returns: None.</li><li><code>_render_summary_message(self, message: str)</code> &ndash; Parameters: message (type str). Returns: None.</li><li><code>_render_summary_sections(self, sections: dict[str, list[str]])</code> &ndash; Parameters: sections (type dict[str, list[str]]). Returns: None.</li><li><code>_populate_summary_tab(self, sections: dict[str, list[str]])</code> &ndash; Parameters: sections (type dict[str, list[str]]). Returns: None.</li><li><code>_populate_notes_tab(self, record: dict | None)</code> &ndash; Parameters: record (type dict | None). Returns: None.</li><li><code>_populate_characters_tab(self, _record: dict | None)</code> &ndash; Parameters: _record (type dict | None). Returns: None.</li><li><code>_on_entity_card_selected(self, token: dict)</code> &ndash; Parameters: token (type dict). Returns: None.</li><li><code>_get_stats_preview(self, record: dict | None)</code> &ndash; Parameters: record (type dict | None). Returns: str.</li><li><code>_get_summary_preview(self, record: dict | None)</code> &ndash; Parameters: record (type dict | None). Returns: str.</li><li><code>_on_save_notes(self)</code> &ndash; Returns: None.</li><li><code>_save_entity_notes(self, token: dict, notes: str)</code> &ndash; Parameters: token (type dict); notes (type str). Returns: bool.</li><li><code>_get_entity_table_name(entity_type: str | None)</code> &ndash; Parameters: entity_type (type str | None). Returns: str | None.</li><li><code>_update_token_records(self, entity_type: str | None, entity_id: str | None, record: dict)</code> &ndash; Parameters: entity_type (type str | None); entity_id (type str | None); record (type dict). Returns: None.</li><li><code>_compose_summary(self, entity_type: str, record: dict)</code> &ndash; Parameters: entity_type (type str); record (type dict). Returns: dict[str, list[str]].</li><li><code>_harvest_fields(self, record: dict, fields: list[str])</code> &ndash; Parameters: record (type dict); fields (type list[str]). Returns: list[str].</li><li><code>_collect_badges(self, entity_type: str, record: dict)</code> &ndash; Parameters: entity_type (type str); record (type dict). Returns: list[str].</li><li><code>_summarize_map_contents(self, record: dict)</code> &ndash; Parameters: record (type dict). Returns: list[str].</li><li><code>_normalize_text(self, value)</code> &ndash; Parameters: value. Returns: str.</li><li><code>_resolve_portrait_path(self, record: dict)</code> &ndash; Parameters: record (type dict). Returns: str | None.</li><li><code>_resolve_map_image(self, record: dict)</code> &ndash; Parameters: record (type dict). Returns: str | None.</li><li><code>_fetch_record(self, entity_type: str, name: str | None)</code> &ndash; Parameters: entity_type (type str); name (type str | None). Returns: dict | None.</li><li><code>_on_destroy(self, _event=None)</code> &ndash; Parameters: _event (default None). Returns: None.</li><li><code>open_chatbot(self, event=None)</code> &ndash; Parameters: event (default None).</li></ul></div><div class='class'><h4>class WorldMapWindow (ctk.CTkToplevel)</h4><p>Thin wrapper window that hosts a WorldMapPanel for legacy callers.</p><ul><li><code>__init__(self, master=None, initial_map: str | None=None)</code> &ndash; Parameters: master (default None); initial_map (type str | None, default None).</li></ul></div></section>
<section class='module'><h3>modules\npcs\npc_graph_editor.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class NPCGraphEditor (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, npc_wrapper: GenericModelWrapper, faction_wrapper: GenericModelWrapper, *args, **kwargs)</code> &ndash; Parameters: master; npc_wrapper (type GenericModelWrapper); faction_wrapper (type GenericModelWrapper); args (variadic positional); kwargs (variadic keyword).</li><li><code>_on_zoom(self, event)</code> &ndash; Parameters: event.</li><li><code>open_npc_editor(self, event)</code> &ndash; Parameters: event.</li><li><code>display_portrait_window(self)</code> &ndash; Display the NPC's portrait in a normal window (with decorations) that is
sized and positioned to cover the second monitor (if available).</li><li><code>_on_mousewheel_y(self, event)</code> &ndash; Parameters: event.</li><li><code>get_state(self)</code> &ndash; No inline documentation available.</li><li><code>set_state(self, state)</code> &ndash; Parameters: state.</li><li><code>_on_mousewheel_x(self, event)</code> &ndash; Parameters: event.</li><li><code>_start_canvas_pan(self, event)</code> &ndash; Parameters: event.</li><li><code>_do_canvas_pan(self, event)</code> &ndash; Parameters: event.</li><li><code>_end_canvas_pan(self, _event)</code> &ndash; Parameters: _event.</li><li><code>init_toolbar(self)</code> &ndash; No inline documentation available.</li><li><code>reset_zoom(self)</code> &ndash; No inline documentation available.</li><li><code>start_link_creation(self)</code> &ndash; No inline documentation available.</li><li><code>select_first_node(self, event)</code> &ndash; Parameters: event.</li><li><code>select_second_node(self, event)</code> &ndash; Parameters: event.</li><li><code>prompt_link_text(self)</code> &ndash; No inline documentation available.</li><li><code>add_link(self, tag1, tag2, link_text)</code> &ndash; Parameters: tag1; tag2; link_text.</li><li><code>add_npc(self)</code> &ndash; No inline documentation available.</li><li><code>place_pending_npc(self, event)</code> &ndash; Parameters: event.</li><li><code>add_faction(self)</code> &ndash; No inline documentation available.</li><li><code>update_links_positions_for_node(self, node_tag)</code> &ndash; Parameters: node_tag.</li><li><code>update_links_for_node(self, node_tag)</code> &ndash; Parameters: node_tag.</li><li><code>delete_shape(self, tag)</code> &ndash; Parameters: tag.</li><li><code>on_right_click(self, event)</code> &ndash; Parameters: event.</li><li><code>show_color_menu(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>show_link_menu(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>show_node_menu(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>set_arrow_mode(self, new_mode)</code> &ndash; Parameters: new_mode.</li><li><code>delete_node(self)</code> &ndash; No inline documentation available.</li><li><code>redraw_after_drag(self)</code> &ndash; No inline documentation available.</li><li><code>_get_entity_audio(self, record)</code> &ndash; Parameters: record.</li><li><code>_play_entity_audio(self, record, name)</code> &ndash; Parameters: record; name.</li><li><code>_on_canvas_configure(self, event)</code> &ndash; Whenever the canvas is resized (or we manually call this),
redraw the background to fill the full width/height. Parameters: event.</li><li><code>draw_nodes(self)</code> &ndash; No inline documentation available.</li><li><code>draw_all_links(self)</code> &ndash; No inline documentation available.</li><li><code>draw_one_link(self, link)</code> &ndash; Parameters: link.</li><li><code>draw_arrowhead(self, start_x, start_y, end_x, end_y, node_tag)</code> &ndash; Parameters: start_x; start_y; end_x; end_y; node_tag.</li><li><code>save_graph(self)</code> &ndash; No inline documentation available.</li><li><code>load_graph(self, path=None)</code> &ndash; Parameters: path (default None).</li><li><code>change_node_color(self, color)</code> &ndash; Parameters: color.</li><li><code>change_shape_color(self, tag, color)</code> &ndash; Parameters: tag; color.</li><li><code>show_shape_menu(self, x, y, shape_tag)</code> &ndash; Parameters: x; y; shape_tag.</li><li><code>bring_to_front(self, shape_tag)</code> &ndash; Parameters: shape_tag.</li><li><code>send_to_back(self, tag=None)</code> &ndash; Parameters: tag (default None).</li><li><code>activate_resize_mode(self, shape_tag)</code> &ndash; Parameters: shape_tag.</li><li><code>start_resizing(self, event)</code> &ndash; Parameters: event.</li><li><code>do_resizing(self, event)</code> &ndash; Parameters: event.</li><li><code>end_resizing(self, event)</code> &ndash; Parameters: event.</li><li><code>distance_point_to_line(self, px, py, x1, y1, x2, y2)</code> &ndash; Parameters: px; py; x1; y1; x2; y2.</li><li><code>get_link_by_position(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>add_shape(self, shape_type)</code> &ndash; Parameters: shape_type.</li><li><code>draw_shape(self, shape)</code> &ndash; Parameters: shape.</li><li><code>draw_all_shapes(self)</code> &ndash; No inline documentation available.</li><li><code>save_graph(self, path=None)</code> &ndash; Parameters: path (default None).</li><li><code>load_portrait_scaled(self, portrait_path, node_tag, scale=1.0)</code> &ndash; Parameters: portrait_path; node_tag; scale (default 1.0).</li><li><code>draw_graph(self)</code> &ndash; No inline documentation available.</li><li><code>start_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>on_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>end_drag(self, event)</code> &ndash; Parameters: event.</li></ul></div></section>
<section class='module'><h3>modules\npcs\npc_opener.py</h3><p></p><h4>Functions</h4><ul><li><code>open_npc_editor_window(npc_name)</code> &ndash; Opens the specified NPC in a new GenericEditorWindow,
completely detached from the scenario/tabs system. Parameters: npc_name.</li></ul></section>
<section class='module'><h3>modules\npcs\npcs_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\objects\loot_generator_panel.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class LootGeneratorPanel (ctk.CTkFrame)</h4><p>Embedded loot generator panel for the GM screen.</p><ul><li><code>__init__(self, master, object_wrapper: Optional[GenericModelWrapper]=None, template: Optional[dict]=None, **kwargs)</code> &ndash; Parameters: master; object_wrapper (type Optional[GenericModelWrapper], default None); template (type Optional[dict], default None); kwargs (variadic keyword).</li><li><code>_load_objects(self)</code> &ndash; Returns: List[dict].</li><li><code>_build_ui(self)</code> &ndash; No inline documentation available.</li><li><code>_collect_categories(self)</code> &ndash; Returns: List[str].</li><li><code>_discover_numeric_fields(self)</code> &ndash; Returns: List[str].</li><li><code>_select_all_categories(self)</code> &ndash; No inline documentation available.</li><li><code>_clear_categories(self)</code> &ndash; No inline documentation available.</li><li><code>_parse_count(self)</code> &ndash; Returns: int.</li><li><code>_keyword_list(self, var: ctk.StringVar)</code> &ndash; Parameters: var (type ctk.StringVar). Returns: List[str].</li><li><code>_numeric_filter_values(self)</code> &ndash; Returns: Dict[str, Dict[str, float]].</li><li><code>_parse_float(raw: str)</code> &ndash; Parameters: raw (type str). Returns: Optional[float].</li><li><code>_coerce_numeric(value)</code> &ndash; Parameters: value. Returns: Optional[float].</li><li><code>_text_from_rtf(value)</code> &ndash; Extract plain text from a rich text field. Parameters: value. Returns: str.</li><li><code>_filter_objects(self)</code> &ndash; Returns: List[dict].</li><li><code>_generate_loot(self)</code> &ndash; No inline documentation available.</li><li><code>_render_results(self)</code> &ndash; No inline documentation available.</li><li><code>_copy_to_clipboard(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\objects\object_constants.py</h3><p>Shared constants for object-related modules.</p><h4>Functions</h4><ul></ul></section>
<section class='module'><h3>modules\objects\object_importer.py</h3><p></p><h4>Functions</h4><ul><li><code>parse_json_relaxed(payload: str)</code> &ndash; Parse JSON from a possibly noisy AI response. Parameters: payload (type str).</li><li><code>_normalize_object_payload(payload)</code> &ndash; Return the equipment list from various payload shapes. Parameters: payload.</li><li><code>_to_longtext(value)</code> &ndash; Convert plain strings into the rich-text JSON structure used by the DB. Parameters: value.</li><li><code>import_object_records(payload)</code> &ndash; Persist a list (or wrapped dict) of equipment entries into the database. Parameters: payload. Returns: int.</li><li><code>import_objects_from_json(raw_text: str)</code> &ndash; Parse JSON text containing object definitions and import them into the DB. Parameters: raw_text (type str). Returns: int.</li></ul><div class='class'><h4>class ObjectImportWindow (ctk.CTkToplevel)</h4><p>Window allowing AI-assisted import of equipment objects from PDFs or pasted text.</p><ul><li><code>__init__(self, master=None)</code> &ndash; Parameters: master (default None).</li><li><code>import_pasted_json(self)</code> &ndash; No inline documentation available.</li><li><code>import_pdf_via_ai(self)</code> &ndash; No inline documentation available.</li><li><code>ai_parse_textarea(self)</code> &ndash; No inline documentation available.</li><li><code>_extract_pdf_text(self, path: str)</code> &ndash; Parameters: path (type str). Returns: list[str].</li><li><code>_ai_extract_and_import(self, raw_text: str, source_label: str="", *, update_text: bool=True)</code> &ndash; Parameters: raw_text (type str); source_label (type str, default ""); update_text (keyword-only, type bool, default True).</li><li><code>_set_text(self, value: str)</code> &ndash; Parameters: value (type str).</li><li><code>_set_status(self, text: str)</code> &ndash; Parameters: text (type str).</li><li><code>_busy(self, active: bool)</code> &ndash; Parameters: active (type bool).</li><li><code>_info(self, title: str, message: str)</code> &ndash; Parameters: title (type str); message (type str).</li><li><code>_warn(self, title: str, message: str)</code> &ndash; Parameters: title (type str); message (type str).</li><li><code>_error(self, title: str, message: str)</code> &ndash; Parameters: title (type str); message (type str).</li></ul></div></section>
<section class='module'><h3>modules\objects\object_shelf_canvas_view.py</h3><p>Canvas‑based shelf view for object entities.

This implementation focuses on fast drawing with a background image and
category shelves that span the full width. It exposes the same minimal
public API the app expects from the previous view:

- is_available() -&gt; bool
- is_visible() -&gt; bool
- show(before_widget)
- hide()
- populate()
- refresh_selection()
- update_summary()
- start_visibility_monitor()/stop_visibility_monitor()

It draws only category shelves (not individual items) for performance and
clarity; counts are shown per category. The background image is scaled to
the canvas and shelves are drawn as semi‑transparent rounded panels so the
background remains visible behind them.</p><h4>Functions</h4><ul></ul><div class='class'><h4>class _ShelfRow</h4><p></p><ul></ul></div><div class='class'><h4>class ObjectShelfView</h4><p>Canvas‑based shelves with background image.</p><ul><li><code>__init__(self, host, allowed_categories: Sequence[str])</code> &ndash; Parameters: host; allowed_categories (type Sequence[str]).</li><li><code>is_available(self)</code> &ndash; Returns: bool.</li><li><code>is_visible(self)</code> &ndash; Returns: bool.</li><li><code>show(self, before_widget)</code> &ndash; Parameters: before_widget.</li><li><code>hide(self)</code> &ndash; No inline documentation available.</li><li><code>populate(self)</code> &ndash; No inline documentation available.</li><li><code>refresh_selection(self)</code> &ndash; No inline documentation available.</li><li><code>update_summary(self)</code> &ndash; No inline documentation available.</li><li><code>_build_search_bar(self)</code> &ndash; No inline documentation available.</li><li><code>_trigger_search(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>_current_search_query(self)</code> &ndash; Returns: str.</li><li><code>_expand_rows_for_search(self)</code> &ndash; No inline documentation available.</li><li><code>start_visibility_monitor(self)</code> &ndash; No inline documentation available.</li><li><code>stop_visibility_monitor(self)</code> &ndash; No inline documentation available.</li><li><code>_load_background(self)</code> &ndash; No inline documentation available.</li><li><code>_on_visibility_tick(self)</code> &ndash; No inline documentation available.</li><li><code>_on_mousewheel(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_detail_mousewheel(self, event)</code> &ndash; Parameters: event.</li><li><code>_update_detail_body_height(self, max_panel_height: int=150, min_body_height: int=40)</code> &ndash; Adjust detail scroll area height based on content, capping total panel height.

The overall detail panel should not exceed `max_panel_height`.
We compute available height for the scrollable body by subtracting the
header height and known paddings, then clamp the body height to that. Parameters: max_panel_height (type int, default 150); min_body_height (type int, default 40).</li><li><code>_on_canvas_configure(self, _event)</code> &ndash; Parameters: _event.</li><li><code>_request_redraw(self)</code> &ndash; No inline documentation available.</li><li><code>_redraw(self)</code> &ndash; No inline documentation available.</li><li><code>_ensure_background(self, w: int, h: int)</code> &ndash; Parameters: w (type int); h (type int).</li><li><code>_draw_shelf_row(self, x1: int, y1: int, x2: int, y2: int, row: _ShelfRow)</code> &ndash; Parameters: x1 (type int); y1 (type int); x2 (type int); y2 (type int); row (type _ShelfRow).</li><li><code>_get_panel_image(self, width: int, height: int, radius: int=12)</code> &ndash; Parameters: width (type int); height (type int); radius (type int, default 12). Returns: ImageTk.PhotoImage.</li><li><code>_get_shelf_image(self, width: int, height: int)</code> &ndash; Cached wood-like plank image for shelf rows.

Uses a simple warm gradient with subtle plank lines for a shelf look. Parameters: width (type int); height (type int). Returns: ImageTk.PhotoImage.</li><li><code>_get_crate_image(self, width: int, height: int)</code> &ndash; Cached crate tile image for object items.

Designed to be used as a single canvas image per item for speed. Parameters: width (type int); height (type int). Returns: ImageTk.PhotoImage.</li><li><code>_rounded_rect(draw: ImageDraw.ImageDraw, box, radius, fill=None, outline=None, width: int=1)</code> &ndash; Parameters: draw (type ImageDraw.ImageDraw); box; radius; fill (default None); outline (default None); width (type int, default 1).</li><li><code>_build_rows(self)</code> &ndash; Returns: List[_ShelfRow].</li><li><code>_normalize_category_display(value: object)</code> &ndash; Parameters: value (type object). Returns: str.</li><li><code>_find_row_by_y(self, y: int)</code> &ndash; Parameters: y (type int). Returns: Optional[_ShelfRow].</li><li><code>_on_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_measure_items_height(self, inner_width: int, row: _ShelfRow)</code> &ndash; Parameters: inner_width (type int); row (type _ShelfRow). Returns: int.</li><li><code>_draw_row_items(self, x: int, y: int, right: int, row: _ShelfRow)</code> &ndash; Parameters: x (type int); y (type int); right (type int); row (type _ShelfRow).</li><li><code>_on_item_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_ensure_fixed_detail_bar(self)</code> &ndash; No inline documentation available.</li><li><code>_hide_fixed_detail_bar(self)</code> &ndash; No inline documentation available.</li><li><code>_show_item_detail_fixed(self, item: dict)</code> &ndash; Parameters: item (type dict).</li><li><code>_ensure_detail_panel(self)</code> &ndash; No inline documentation available.</li><li><code>_hide_item_detail(self)</code> &ndash; No inline documentation available.</li><li><code>_show_item_detail(self, item: dict)</code> &ndash; Parameters: item (type dict).</li><li><code>_rebuild_stats(self, body: ctk.CTkScrollableFrame, item: dict)</code> &ndash; Parameters: body (type ctk.CTkScrollableFrame); item (type dict).</li><li><code>_add_stat_row(parent, row: int, key: str, value)</code> &ndash; Parameters: parent; row (type int); key (type str); value.</li></ul></div></section>
<section class='module'><h3>modules\objects\object_shelf_view.py</h3><p>Shelf view implementation for object entities.</p><h4>Functions</h4><ul></ul><div class='class'><h4>class ShelfSectionState</h4><p>Keep track of widgets and metadata for a shelf section.</p><ul></ul></div><div class='class'><h4>class ObjectShelfView</h4><p>Encapsulates the supply crate shelf experience for object entities.</p><ul><li><code>__init__(self, host, allowed_categories: Sequence[str])</code> &ndash; Parameters: host; allowed_categories (type Sequence[str]).</li><li><code>_initialize_background(self)</code> &ndash; Create and manage the background image for the shelf view.</li><li><code>_on_frame_resize(self, event)</code> &ndash; Resize the background image to keep it filling the frame. Parameters: event.</li><li><code>_build_search_bar(self)</code> &ndash; Create a shelf-level search input that leverages the host filter.</li><li><code>_trigger_search(self, event=None)</code> &ndash; Invoke the host filter when the search entry is submitted. Parameters: event (default None).</li><li><code>_current_search_query(self)</code> &ndash; Return the trimmed search query if one is active. Returns: str.</li><li><code>is_available(self)</code> &ndash; Returns: bool.</li><li><code>is_visible(self)</code> &ndash; Returns: bool.</li><li><code>show(self, before_widget)</code> &ndash; Parameters: before_widget.</li><li><code>hide(self)</code> &ndash; No inline documentation available.</li><li><code>populate(self)</code> &ndash; No inline documentation available.</li><li><code>refresh_selection(self)</code> &ndash; No inline documentation available.</li><li><code>_get_current_selection(self)</code> &ndash; Returns: Set[str].</li><li><code>_sync_selection_delta(self, previous: Set[str], current: Set[str], highlight_target: Optional[str]=None)</code> &ndash; Parameters: previous (type Set[str]); current (type Set[str]); highlight_target (type Optional[str], default None).</li><li><code>update_summary(self)</code> &ndash; No inline documentation available.</li><li><code>start_visibility_monitor(self)</code> &ndash; No inline documentation available.</li><li><code>stop_visibility_monitor(self)</code> &ndash; No inline documentation available.</li><li><code>_rebuild_sections(self)</code> &ndash; No inline documentation available.</li><li><code>_expand_sections_for_search(self)</code> &ndash; Ensure all sections are open and populated when a search is active.</li><li><code>_group_items_by_category(self)</code> &ndash; No inline documentation available.</li><li><code>_normalize_category(self, value)</code> &ndash; Parameters: value.</li><li><code>_create_section_widgets(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_update_section_controls(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_format_category_display(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState). Returns: str.</li><li><code>_apply_column_configuration(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_on_grid_resize(self, state: ShelfSectionState, width: int)</code> &ndash; Parameters: state (type ShelfSectionState); width (type int).</li><li><code>_freeze_layout(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_thaw_layout(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_determine_column_count(self, state: ShelfSectionState, width: Optional[int]=None)</code> &ndash; Parameters: state (type ShelfSectionState); width (type Optional[int], default None). Returns: int.</li><li><code>_reposition_section_widgets(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_update_pin_button(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_update_collapse_button(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_toggle_section_collapse(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_collapse_section(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_toggle_section_pin(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_ensure_section_loaded(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_suggest_batch_size(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState). Returns: int.</li><li><code>_prepare_item_display(self, state: ShelfSectionState, item: dict)</code> &ndash; Parameters: state (type ShelfSectionState); item (type dict). Returns: dict.</li><li><code>_register_wrap_targets(self, state: ShelfSectionState, base_id: str, labels: Sequence[Optional[ctk.CTkLabel]])</code> &ndash; Parameters: state (type ShelfSectionState); base_id (type str); labels (type Sequence[Optional[ctk.CTkLabel]]).</li><li><code>_prepare_spec_data(self, state: ShelfSectionState, item: dict)</code> &ndash; Parameters: state (type ShelfSectionState); item (type dict). Returns: List[Tuple[str, str, bool]].</li><li><code>_normalize_stats_text(text: str)</code> &ndash; Parameters: text (type str). Returns: str.</li><li><code>_update_wrap_lengths(self, state: ShelfSectionState, *, immediate: bool=False)</code> &ndash; Parameters: state (type ShelfSectionState); immediate (keyword-only, type bool, default False).</li><li><code>_load_section_batch(self, state: ShelfSectionState, batch_size=24)</code> &ndash; Parameters: state (type ShelfSectionState); batch_size (default 24).</li><li><code>_ensure_shelf_row(self, state: ShelfSectionState, row_group: int, columns: int, row: int)</code> &ndash; Parameters: state (type ShelfSectionState); row_group (type int); columns (type int); row (type int). Returns: ctk.CTkFrame.</li><li><code>_build_collapsed_strip(self, state: ShelfSectionState, container: ctk.CTkFrame, before_widget: Optional[ctk.CTkFrame]=None)</code> &ndash; Parameters: state (type ShelfSectionState); container (type ctk.CTkFrame); before_widget (type Optional[ctk.CTkFrame], default None).</li><li><code>_build_section_overlay(self, state: ShelfSectionState, parent: ctk.CTkFrame)</code> &ndash; Parameters: state (type ShelfSectionState); parent (type ctk.CTkFrame).</li><li><code>_update_collapsed_strip_text(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_update_section_overlay_text(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_maybe_load_more_crates(self, state: ShelfSectionState, force=False)</code> &ndash; Parameters: state (type ShelfSectionState); force (default False).</li><li><code>_create_crate_widget(self, state: ShelfSectionState, item, display: dict)</code> &ndash; Parameters: state (type ShelfSectionState); item; display (type dict).</li><li><code>_handle_crate_primary(self, event, state: ShelfSectionState, base_id)</code> &ndash; Parameters: event; state (type ShelfSectionState); base_id.</li><li><code>_on_crate_click(self, _state: ShelfSectionState, base_id)</code> &ndash; Parameters: _state (type ShelfSectionState); base_id.</li><li><code>_toggle_crate_selection(self, base_id)</code> &ndash; Parameters: base_id.</li><li><code>_focus_crate(self, base_id)</code> &ndash; Parameters: base_id.</li><li><code>_move_crate_focus(self, state: ShelfSectionState, base_id, delta)</code> &ndash; Parameters: state (type ShelfSectionState); base_id; delta.</li><li><code>_toggle_spec_sheet(self, state: ShelfSectionState, base_id)</code> &ndash; Parameters: state (type ShelfSectionState); base_id.</li><li><code>_show_spec_overlay(self, state: ShelfSectionState, base_id: str, display: Dict[str, str], spec_data: Sequence[Tuple[str, str, bool]])</code> &ndash; Parameters: state (type ShelfSectionState); base_id (type str); display (type Dict[str, str]); spec_data (type Sequence[Tuple[str, str, bool]]).</li><li><code>_build_spec_sheet_content(self, parent, spec_data: Sequence[Tuple[str, str, bool]])</code> &ndash; Parameters: parent; spec_data (type Sequence[Tuple[str, str, bool]]).</li><li><code>_hide_spec_overlay(self, state: ShelfSectionState, destroy: bool=True)</code> &ndash; Parameters: state (type ShelfSectionState); destroy (type bool, default True).</li><li><code>_dispose_specs(self, state: ShelfSectionState)</code> &ndash; Parameters: state (type ShelfSectionState).</li><li><code>_scroll_widget_into_view(self, widget, padding: int=20)</code> &ndash; Parameters: widget; padding (type int, default 20).</li><li><code>_set_crate_selected(self, base_id, selected=False, crate=None, highlight=False)</code> &ndash; Parameters: base_id; selected (default False); crate (default None); highlight (default False).</li><li><code>_monitor_visibility(self)</code> &ndash; No inline documentation available.</li><li><code>_check_visible_shelves(self)</code> &ndash; No inline documentation available.</li><li><code>_on_canvas_change(self)</code> &ndash; No inline documentation available.</li><li><code>_calculate_section_padding(self, state: ShelfSectionState)</code> &ndash; Determine how much horizontal padding surrounds a section grid. Parameters: state (type ShelfSectionState). Returns: int.</li><li><code>_horizontal_padding_for_widget(widget, default_per_side: int)</code> &ndash; Return the total horizontal padding applied to a packed widget. Parameters: widget; default_per_side (type int). Returns: int.</li><li><code>_coerce_padding_value(raw)</code> &ndash; Normalize various tkinter padx representations into total pixels. Parameters: raw. Returns: int.</li><li><code>_on_mousewheel(self, event)</code> &ndash; Parameters: event.</li><li><code>scroll_to_top(self)</code> &ndash; No inline documentation available.</li><li><code>_update_return_button(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\objects\objects_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\pcs\display_pcs.py</h3><p></p><h4>Functions</h4><ul><li><code>display_pcs_in_banner(banner_frame, pcs_items)</code> &ndash; Parameters: banner_frame; pcs_items.</li></ul></section>
<section class='module'><h3>modules\pcs\pc_graph_editor.py</h3><p></p><h4>Functions</h4><ul><li><code>get_monitors()</code> &ndash; No inline documentation available.</li></ul><div class='class'><h4>class PCGraphEditor (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, pc_wrapper: GenericModelWrapper, faction_wrapper: GenericModelWrapper, *args, **kwargs)</code> &ndash; Parameters: master; pc_wrapper (type GenericModelWrapper); faction_wrapper (type GenericModelWrapper); args (variadic positional); kwargs (variadic keyword).</li><li><code>open_pc_editor(self, event)</code> &ndash; Parameters: event.</li><li><code>display_portrait_window(self)</code> &ndash; Delegate portrait‐popping to the shared `show_portrait` helper.</li><li><code>_on_mousewheel_y(self, event)</code> &ndash; Parameters: event.</li><li><code>get_state(self)</code> &ndash; No inline documentation available.</li><li><code>set_state(self, state)</code> &ndash; Parameters: state.</li><li><code>_on_mousewheel_x(self, event)</code> &ndash; Parameters: event.</li><li><code>_start_canvas_pan(self, event)</code> &ndash; Parameters: event.</li><li><code>_do_canvas_pan(self, event)</code> &ndash; Parameters: event.</li><li><code>_end_canvas_pan(self, _event)</code> &ndash; Parameters: _event.</li><li><code>init_toolbar(self)</code> &ndash; No inline documentation available.</li><li><code>start_link_creation(self)</code> &ndash; No inline documentation available.</li><li><code>select_first_node(self, event)</code> &ndash; Parameters: event.</li><li><code>select_second_node(self, event)</code> &ndash; Parameters: event.</li><li><code>prompt_link_text(self)</code> &ndash; No inline documentation available.</li><li><code>add_link(self, tag1, tag2, link_text)</code> &ndash; Parameters: tag1; tag2; link_text.</li><li><code>add_pc(self)</code> &ndash; No inline documentation available.</li><li><code>place_pending_pc(self, event)</code> &ndash; Parameters: event.</li><li><code>add_faction(self)</code> &ndash; No inline documentation available.</li><li><code>update_links_positions_for_node(self, node_tag)</code> &ndash; Parameters: node_tag.</li><li><code>update_links_for_node(self, node_tag)</code> &ndash; Parameters: node_tag.</li><li><code>delete_shape(self, tag)</code> &ndash; Parameters: tag.</li><li><code>on_right_click(self, event)</code> &ndash; Parameters: event.</li><li><code>show_color_menu(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>show_link_menu(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>show_node_menu(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>set_arrow_mode(self, new_mode)</code> &ndash; Parameters: new_mode.</li><li><code>delete_node(self)</code> &ndash; No inline documentation available.</li><li><code>redraw_after_drag(self)</code> &ndash; No inline documentation available.</li><li><code>_get_entity_audio(self, record)</code> &ndash; Parameters: record.</li><li><code>_play_entity_audio(self, record, name)</code> &ndash; Parameters: record; name.</li><li><code>draw_nodes(self)</code> &ndash; No inline documentation available.</li><li><code>draw_all_links(self)</code> &ndash; No inline documentation available.</li><li><code>draw_one_link(self, link)</code> &ndash; Parameters: link.</li><li><code>draw_arrowhead(self, start_x, start_y, end_x, end_y, node_tag)</code> &ndash; Parameters: start_x; start_y; end_x; end_y; node_tag.</li><li><code>save_graph(self)</code> &ndash; No inline documentation available.</li><li><code>load_graph(self)</code> &ndash; No inline documentation available.</li><li><code>change_node_color(self, color)</code> &ndash; Parameters: color.</li><li><code>change_shape_color(self, tag, color)</code> &ndash; Parameters: tag; color.</li><li><code>show_shape_menu(self, x, y, shape_tag)</code> &ndash; Parameters: x; y; shape_tag.</li><li><code>bring_to_front(self, shape_tag)</code> &ndash; Parameters: shape_tag.</li><li><code>send_to_back(self, shape_tag)</code> &ndash; Parameters: shape_tag.</li><li><code>activate_resize_mode(self, shape_tag)</code> &ndash; Parameters: shape_tag.</li><li><code>start_resizing(self, event)</code> &ndash; Parameters: event.</li><li><code>do_resizing(self, event)</code> &ndash; Parameters: event.</li><li><code>end_resizing(self, event)</code> &ndash; Parameters: event.</li><li><code>distance_point_to_line(self, px, py, x1, y1, x2, y2)</code> &ndash; Parameters: px; py; x1; y1; x2; y2.</li><li><code>get_link_by_position(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>add_shape(self, shape_type)</code> &ndash; Parameters: shape_type.</li><li><code>draw_shape(self, shape)</code> &ndash; Parameters: shape.</li><li><code>draw_all_shapes(self)</code> &ndash; No inline documentation available.</li><li><code>save_graph(self)</code> &ndash; No inline documentation available.</li><li><code>draw_graph(self)</code> &ndash; No inline documentation available.</li><li><code>start_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>on_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>end_drag(self, event)</code> &ndash; Parameters: event.</li></ul></div></section>
<section class='module'><h3>modules\pcs\pc_opener.py</h3><p></p><h4>Functions</h4><ul><li><code>open_pc_editor_window(pc_name)</code> &ndash; Opens the specified NPC in a new GenericEditorWindow,
completely detached from the scenario/tabs system. Parameters: pc_name.</li></ul></section>
<section class='module'><h3>modules\pcs\pcs_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\places\places_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\scenarios\epic_finale_planner.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class FinaleBlueprintStep (WizardStep)</h4><p>Wizard step for composing an epic finale outline before refinement.</p><ul><li><code>__init__(self, master, wizard)</code> &ndash; Parameters: master; wizard.</li><li><code>_create_entity_selector(self, parent, row, column, key, button_text)</code> &ndash; Parameters: parent; row; column; key; button_text.</li><li><code>_refresh_entities(self)</code> &ndash; No inline documentation available.</li><li><code>_get_selector_items(self, key)</code> &ndash; Parameters: key.</li><li><code>_update_entity_selector(self, key, items)</code> &ndash; Parameters: key; items.</li><li><code>_ensure_selector_option(self, selector, value)</code> &ndash; Parameters: selector; value.</li><li><code>_set_entity_selector_values(self, key, values)</code> &ndash; Parameters: key; values.</li><li><code>_clear_entity_selector(self, key)</code> &ndash; Parameters: key.</li><li><code>_collect_entity_selector_values(self, key)</code> &ndash; Parameters: key.</li><li><code>_build_name_list(self, items)</code> &ndash; Parameters: items.</li><li><code>_build_option_list(self, items)</code> &ndash; Parameters: items.</li><li><code>_format_name(item)</code> &ndash; Parameters: item.</li><li><code>_parse_list(text)</code> &ndash; Parameters: text.</li><li><code>_deduplicate_preserve_order(items)</code> &ndash; Parameters: items.</li><li><code>_format_scene_entities(scene)</code> &ndash; Parameters: scene.</li><li><code>_entity_hook_text(entity)</code> &ndash; Parameters: entity.</li><li><code>_format_entity_suggestion(self, entity)</code> &ndash; Parameters: entity.</li><li><code>_refresh_parameter_suggestions(self)</code> &ndash; No inline documentation available.</li><li><code>load_state(self, state)</code> &ndash; Parameters: state.</li><li><code>_set_if_available(var, value, options)</code> &ndash; Parameters: var; value; options.</li><li><code>save_state(self, state)</code> &ndash; Parameters: state.</li><li><code>generate_outline(self)</code> &ndash; No inline documentation available.</li><li><code>_build_scenario_from_config(self)</code> &ndash; No inline documentation available.</li><li><code>_build_gm_guidance_sentences(self, antagonists, allied_factions, npc_allies, location)</code> &ndash; Parameters: antagonists; allied_factions; npc_allies; location.</li><li><code>_extract_entity_guidance(self, name, items)</code> &ndash; Parameters: name; items.</li><li><code>_distribute_guidance_across_beats(self, beats, guidance_sentences, rng)</code> &ndash; Parameters: beats; guidance_sentences; rng.</li><li><code>_extract_guidance_subject(sentence)</code> &ndash; Parameters: sentence.</li><li><code>_get_cached_entities(self, attribute)</code> &ndash; Parameters: attribute.</li><li><code>_find_entity_by_name(self, name, items)</code> &ndash; Parameters: name; items.</li><li><code>_normalise_secret_value(self, value)</code> &ndash; Parameters: value.</li><li><code>_condense_guidance_text(text, limit=160)</code> &ndash; Parameters: text; limit (default 160).</li><li><code>_format_gm_guidance(name, label, text)</code> &ndash; Parameters: name; label; text.</li><li><code>_scene_title(index, beat_text)</code> &ndash; Parameters: index; beat_text.</li><li><code>_personalise_beat(beat, antagonist, ally, location)</code> &ndash; Parameters: beat; antagonist; ally; location.</li><li><code>_append_guidance_sentences(base_text, sentences)</code> &ndash; Parameters: base_text; sentences.</li><li><code>_select_callback_scene_index(beats, rng)</code> &ndash; Parameters: beats; rng.</li><li><code>_select_escalation_scene_index(beats, callback_index, rng)</code> &ndash; Parameters: beats; callback_index; rng.</li><li><code>_infer_scene_participants(self, beat, antagonists, npc_allies, allied_factions, rng, antagonist_cycle, ally_cycle, faction_cycle, antagonist_pointer, ally_pointer, faction_pointer)</code> &ndash; Parameters: beat; antagonists; npc_allies; allied_factions; rng; antagonist_cycle; ally_cycle; faction_cycle; antagonist_pointer; ally_pointer; faction_pointer.</li><li><code>_get_rng_for_generation(self)</code> &ndash; No inline documentation available.</li><li><code>_prepare_rotation_cycle(items, rng)</code> &ndash; Parameters: items; rng.</li><li><code>_draw_from_rotation(cycle, pointer, rng)</code> &ndash; Parameters: cycle; pointer; rng.</li><li><code>_clean_selection(value)</code> &ndash; Parameters: value.</li><li><code>_default_title(climax_name, location)</code> &ndash; Parameters: climax_name; location.</li><li><code>_apply_scenario_to_state(self, state, scenario)</code> &ndash; Parameters: state; scenario.</li><li><code>_display_preview(self, scenario)</code> &ndash; Parameters: scenario.</li><li><code>_display_preview_from_state(self, state)</code> &ndash; Parameters: state.</li></ul></div><div class='class'><h4>class EpicFinalePlannerWizard (ScenarioBuilderWizard)</h4><p>Scenario builder variant tailored for planning epic finales.</p><ul><li><code>__init__(self, master, on_saved=None, *, initial_scenario=None)</code> &ndash; Parameters: master; on_saved (default None); initial_scenario (keyword-only, default None).</li><li><code>_create_steps(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\scenarios\gm_layout_manager.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class GMScreenLayoutManager</h4><p>Persist GM Screen tab layouts per campaign.</p><ul><li><code>__init__(self)</code> &ndash; No inline documentation available.</li><li><code>_load(self)</code> &ndash; Returns: None.</li><li><code>_write(self)</code> &ndash; Returns: None.</li><li><code>list_layouts(self)</code> &ndash; Returns: Dict[str, Any].</li><li><code>get_layout(self, name: str)</code> &ndash; Parameters: name (type str). Returns: Optional[Dict[str, Any]].</li><li><code>save_layout(self, name: str, layout: Dict[str, Any])</code> &ndash; Parameters: name (type str); layout (type Dict[str, Any]). Returns: None.</li><li><code>get_scenario_default(self, scenario_title: str)</code> &ndash; Parameters: scenario_title (type str). Returns: Optional[str].</li><li><code>set_scenario_default(self, scenario_title: str, layout_name: Optional[str])</code> &ndash; Parameters: scenario_title (type str); layout_name (type Optional[str]). Returns: None.</li><li><code>get_scenario_state(self, scenario_title: str)</code> &ndash; Parameters: scenario_title (type str). Returns: Dict[str, Any].</li><li><code>update_scenario_state(self, scenario_title: str, *, scenes: Optional[Dict[str, Any]]=None, notes: Optional[str]=None)</code> &ndash; Parameters: scenario_title (type str); scenes (keyword-only, type Optional[Dict[str, Any]], default None); notes (keyword-only, type Optional[str], default None). Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\scenarios\gm_screen_view.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class GMScreenView (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, scenario_item, *args, initial_layout=None, layout_manager=None, **kwargs)</code> &ndash; Parameters: master; scenario_item; args (variadic positional); initial_layout (keyword-only, default None); layout_manager (keyword-only, default None); kwargs (variadic keyword).</li><li><code>_sync_fullbleed_now(self, container: ctk.CTkFrame | None)</code> &ndash; Parameters: container (type ctk.CTkFrame | None).</li><li><code>_load_map_records(self)</code> &ndash; No inline documentation available.</li><li><code>_get_map_record(self, map_name)</code> &ndash; Parameters: map_name.</li><li><code>get_map_thumbnail(self, map_name, size=None)</code> &ndash; Parameters: map_name; size (default None).</li><li><code>open_map_tool(self, map_name)</code> &ndash; Parameters: map_name.</li><li><code>_load_persisted_state(self)</code> &ndash; No inline documentation available.</li><li><code>_setup_toplevel_shortcuts(self)</code> &ndash; Bind Ctrl+F locally when the view is hosted in its own window.</li><li><code>_teardown_toplevel_shortcuts(self)</code> &ndash; No inline documentation available.</li><li><code>_on_destroy(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>_persist_scene_state(self)</code> &ndash; No inline documentation available.</li><li><code>open_global_search(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>open_chatbot(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>load_template(self, filename)</code> &ndash; Parameters: filename.</li><li><code>add_tab(self, name, content_frame, content_factory=None, layout_meta=None)</code> &ndash; Parameters: name; content_frame; content_factory (default None); layout_meta (default None).</li><li><code>_apply_initial_layout(self)</code> &ndash; No inline documentation available.</li><li><code>_initialize_context_menu(self)</code> &ndash; No inline documentation available.</li><li><code>reset_scene_widgets(self)</code> &ndash; No inline documentation available.</li><li><code>register_scene_widget(self, scene_key, var, checkbox, display_label=None)</code> &ndash; Parameters: scene_key; var; checkbox; display_label (default None).</li><li><code>_on_scene_var_change(self, scene_key)</code> &ndash; Parameters: scene_key.</li><li><code>get_scene_completion(self, scene_key)</code> &ndash; Parameters: scene_key.</li><li><code>_set_scene_var(self, scene_key, value)</code> &ndash; Parameters: scene_key; value.</li><li><code>set_active_scene(self, scene_key)</code> &ndash; Parameters: scene_key.</li><li><code>mark_active_scene_complete(self)</code> &ndash; No inline documentation available.</li><li><code>mark_next_scene_complete(self)</code> &ndash; No inline documentation available.</li><li><code>add_timestamped_note(self)</code> &ndash; No inline documentation available.</li><li><code>_update_note_cache(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>register_note_widget(self, widget)</code> &ndash; Parameters: widget.</li><li><code>get_note_text(self)</code> &ndash; No inline documentation available.</li><li><code>_show_context_menu(self, event)</code> &ndash; Parameters: event.</li><li><code>_update_layout_status(self, name=None)</code> &ndash; Parameters: name (default None).</li><li><code>_serialize_current_layout(self)</code> &ndash; No inline documentation available.</li><li><code>_prompt_save_layout(self)</code> &ndash; No inline documentation available.</li><li><code>_open_load_layout_dialog(self)</code> &ndash; No inline documentation available.</li><li><code>_clear_all_tabs(self)</code> &ndash; No inline documentation available.</li><li><code>_restore_tab_from_config(self, tab_def)</code> &ndash; Parameters: tab_def.</li><li><code>load_layout(self, layout_name, set_default=False, silent=False)</code> &ndash; Parameters: layout_name; set_default (default False); silent (default False).</li><li><code>_open_entity_from_layout(self, entity_type, entity_name)</code> &ndash; Parameters: entity_type; entity_name.</li><li><code>_on_tab_press(self, event, name)</code> &ndash; Parameters: event; name.</li><li><code>_on_tab_motion(self, event, name)</code> &ndash; Parameters: event; name.</li><li><code>_trigger_shift(self, other_name, dx)</code> &ndash; Parameters: other_name; dx.</li><li><code>_animate_shift(self, frames, deltas, step=0)</code> &ndash; Parameters: frames; deltas; step (default 0).</li><li><code>_swap_order(self, name, other)</code> &ndash; Parameters: name; other.</li><li><code>_on_tab_release(self, event, name)</code> &ndash; Parameters: event; name.</li><li><code>toggle_detach_tab(self, name)</code> &ndash; Parameters: name.</li><li><code>detach_tab(self, name)</code> &ndash; Parameters: name.</li><li><code>create_note_frame(self, master=None, initial_text="")</code> &ndash; Parameters: master (default None); initial_text (default "").</li><li><code>_make_fullbleed(self, container: ctk.CTkFrame)</code> &ndash; Force a container to match the visible area height/width.

CTkScrollableFrame sizes its internal `_scrollable_frame` to content.
For interactive canvases (map tool, world map, scene flow) we want to
occupy all available space. This syncs the container size to the
viewport on resize. Parameters: container (type ctk.CTkFrame).</li><li><code>open_world_map_tab(self, map_name=None, title=None)</code> &ndash; Open a WorldMapPanel inside a new GM-screen tab. Parameters: map_name (default None); title (default None).</li><li><code>open_map_tool_tab(self, map_name=None, title=None)</code> &ndash; Open the Map Tool (DisplayMapController) inside a GM-screen tab. Parameters: map_name (default None); title (default None).</li><li><code>open_scene_flow_tab(self, scenario_title=None, title=None)</code> &ndash; Open the Scene Flow Viewer inside a GM-screen tab. Parameters: scenario_title (default None); title (default None).</li><li><code>open_loot_generator_tab(self, title=None)</code> &ndash; Open the embedded loot generator inside the GM screen. Parameters: title (default None).</li><li><code>reattach_tab(self, name)</code> &ndash; Parameters: name.</li><li><code>close_tab(self, name)</code> &ndash; Parameters: name.</li><li><code>reposition_add_button(self)</code> &ndash; No inline documentation available.</li><li><code>_add_random_entity(self)</code> &ndash; No inline documentation available.</li><li><code>show_tab(self, name)</code> &ndash; Parameters: name.</li><li><code>add_new_tab(self)</code> &ndash; No inline documentation available.</li><li><code>open_selection_window(self, entity_type, popup)</code> &ndash; Parameters: entity_type; popup.</li><li><code>open_entity_tab(self, entity_type, name)</code> &ndash; Parameters: entity_type; name.</li><li><code>_focus_existing_tab(self, tab_name)</code> &ndash; Parameters: tab_name.</li><li><code>_find_existing_entity_tab(self, entity_type, entity_name)</code> &ndash; Parameters: entity_type; entity_name.</li><li><code>create_scenario_graph_frame(self, master=None)</code> &ndash; Parameters: master (default None).</li><li><code>create_entity_frame(self, entity_type, entity, master=None)</code> &ndash; Parameters: entity_type; entity; master (default None).</li><li><code>insert_text(self, parent, header, content)</code> &ndash; Parameters: parent; header; content.</li><li><code>insert_longtext(self, parent, header, content)</code> &ndash; Parameters: parent; header; content.</li><li><code>insert_links(self, parent, header, items, linked_type)</code> &ndash; Parameters: parent; header; items; linked_type.</li><li><code>_on_link_clicked(self, linked_type, item, event=None)</code> &ndash; Parameters: linked_type; item; event (default None).</li><li><code>save_note_to_file(self, note_frame, default_name)</code> &ndash; Parameters: note_frame; default_name.</li><li><code>create_npc_graph_frame(self, master=None)</code> &ndash; Parameters: master (default None).</li><li><code>create_pc_graph_frame(self, master=None)</code> &ndash; Parameters: master (default None).</li><li><code>reorder_detached_windows(self)</code> &ndash; No inline documentation available.</li><li><code>destroy(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\scenarios\scenario_builder_wizard.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class WizardStep (ctk.CTkFrame)</h4><p>Base class for wizard steps with state synchronization hooks.</p><ul><li><code>load_state(self, state)</code> &ndash; Populate widgets using the shared wizard ``state``. Parameters: state.</li><li><code>save_state(self, state)</code> &ndash; Persist widget values into the shared wizard ``state``. Parameters: state.</li></ul></div><div class='class'><h4>class BasicInfoStep (WizardStep)</h4><p></p><ul><li><code>__init__(self, master)</code> &ndash; Parameters: master.</li><li><code>load_state(self, state)</code> &ndash; Parameters: state.</li><li><code>save_state(self, state)</code> &ndash; Parameters: state.</li></ul></div><div class='class'><h4>class ScenesPlanningStep (WizardStep)</h4><p></p><ul><li><code>__init__(self, master, entity_wrappers, *, scenario_wrapper=None, finale_planner_callback=None)</code> &ndash; Parameters: master; entity_wrappers; scenario_wrapper (keyword-only, default None); finale_planner_callback (keyword-only, default None).</li><li><code>set_state_binding(self, state, on_state_change=None)</code> &ndash; Parameters: state; on_state_change (default None).</li><li><code>_switch_to_epic_finale_planner(self)</code> &ndash; No inline documentation available.</li><li><code>_get_scene_links(self, scene)</code> &ndash; Parameters: scene.</li><li><code>_on_canvas_select(self, index)</code> &ndash; Parameters: index.</li><li><code>_on_canvas_move(self, index, x, y)</code> &ndash; Parameters: index; x; y.</li><li><code>_edit_scenario_info(self)</code> &ndash; No inline documentation available.</li><li><code>_load_existing_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>_choose_existing_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>load_from_payload(self, scenario)</code> &ndash; Parameters: scenario.</li><li><code>_apply_loaded_scenario(self, scenario)</code> &ndash; Parameters: scenario.</li><li><code>_edit_scene_via_canvas(self, index)</code> &ndash; Parameters: index.</li><li><code>_open_inline_scene_editor(self, index)</code> &ndash; Parameters: index.</li><li><code>_close_inline_scene_editor(self)</code> &ndash; No inline documentation available.</li><li><code>_apply_inline_scene_update(self, index, data)</code> &ndash; Parameters: index; data.</li><li><code>_show_canvas_menu(self, event, index)</code> &ndash; Parameters: event; index.</li><li><code>_show_background_menu(self, event)</code> &ndash; Parameters: event.</li><li><code>_show_scene_menu(self, event, index)</code> &ndash; Parameters: event; index.</li><li><code>_add_link_between(self, source_index, target_title, label=None)</code> &ndash; Parameters: source_index; target_title; label (default None).</li><li><code>_remove_link_between(self, source_index, target_title)</code> &ndash; Parameters: source_index; target_title.</li><li><code>_clear_links(self, source_index)</code> &ndash; Parameters: source_index.</li><li><code>_remove_entity_from_scene(self, scene_index, field, name)</code> &ndash; Parameters: scene_index; field; name.</li><li><code>_clear_entities_from_scene(self, scene_index, field)</code> &ndash; Parameters: scene_index; field.</li><li><code>_add_entity_to_scene(self, scene_index, entity_type)</code> &ndash; Parameters: scene_index; entity_type.</li><li><code>_create_entity_for_scene(self, scene_index, entity_type)</code> &ndash; Parameters: scene_index; entity_type.</li><li><code>_link_scenes_via_drag(self, source_index, target_index)</code> &ndash; Parameters: source_index; target_index.</li><li><code>_start_link_label_edit(self, source_index, target_index, target_value, bbox)</code> &ndash; Parameters: source_index; target_index; target_value; bbox.</li><li><code>_commit_link_label_editor(self, save=True)</code> &ndash; Parameters: save (default True).</li><li><code>_close_link_label_editor(self)</code> &ndash; No inline documentation available.</li><li><code>_choose_entity_from_library(self, entity_slug, singular_label)</code> &ndash; Parameters: entity_slug; singular_label.</li><li><code>_create_entity_in_library(self, entity_slug, singular_label)</code> &ndash; Parameters: entity_slug; singular_label.</li><li><code>add_scene(self)</code> &ndash; No inline documentation available.</li><li><code>duplicate_scene(self, index=None)</code> &ndash; Parameters: index (default None).</li><li><code>remove_scene(self, index=None)</code> &ndash; Parameters: index (default None).</li><li><code>_update_buttons(self)</code> &ndash; No inline documentation available.</li><li><code>_assign_default_position(self, scene)</code> &ndash; Parameters: scene.</li><li><code>_unique_title(self, base)</code> &ndash; Parameters: base.</li><li><code>load_state(self, state)</code> &ndash; Parameters: state.</li><li><code>save_state(self, state)</code> &ndash; Parameters: state.</li><li><code>_split_to_list(value)</code> &ndash; Parameters: value.</li><li><code>_dedupe(items)</code> &ndash; Parameters: items.</li><li><code>_coerce_scenes(self, raw)</code> &ndash; Parameters: raw.</li><li><code>_normalise_scene(self, entry, index)</code> &ndash; Parameters: entry; index.</li></ul></div><div class='class'><h4>class ScenarioInfoDialog (ctk.CTkToplevel)</h4><p></p><ul><li><code>__init__(self, master, *, title, summary, secrets)</code> &ndash; Parameters: master; title (keyword-only); summary (keyword-only); secrets (keyword-only).</li><li><code>_on_save(self)</code> &ndash; No inline documentation available.</li><li><code>_on_cancel(self)</code> &ndash; No inline documentation available.</li></ul></div><div class='class'><h4>class InlineSceneEditor (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, scene, *, scene_types, on_save, on_cancel, width=None, height=None)</code> &ndash; Parameters: master; scene; scene_types (keyword-only); on_save (keyword-only); on_cancel (keyword-only); width (keyword-only, default None); height (keyword-only, default None).</li><li><code>_on_save(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_on_cancel(self, _event=None)</code> &ndash; Parameters: _event (default None).</li></ul></div><div class='class'><h4>class EntityLinkingStep (WizardStep)</h4><p></p><ul><li><code>__init__(self, master, wrappers)</code> &ndash; Parameters: master; wrappers.</li><li><code>_detect_media_field(self, entity_type)</code> &ndash; Parameters: entity_type.</li><li><code>_invalidate_entity_cache(self, entity_type)</code> &ndash; Parameters: entity_type.</li><li><code>_get_entity_record(self, entity_type, name)</code> &ndash; Parameters: entity_type; name.</li><li><code>_resolve_portrait_path(self, raw_value)</code> &ndash; Parameters: raw_value.</li><li><code>_create_card_image(self, entity_type, portrait_value)</code> &ndash; Parameters: entity_type; portrait_value.</li><li><code>_apply_card_selection_style(self, card, selected)</code> &ndash; Parameters: card; selected.</li><li><code>_toggle_card_selection(self, field, name)</code> &ndash; Parameters: field; name.</li><li><code>_create_entity_card(self, field, name)</code> &ndash; Parameters: field; name.</li><li><code>open_selector(self, entity_type, field)</code> &ndash; Parameters: entity_type; field.</li><li><code>_on_entity_selected(self, field, name, window)</code> &ndash; Parameters: field; name; window.</li><li><code>remove_selected(self, field)</code> &ndash; Parameters: field.</li><li><code>create_new_entity(self, entity_type, field, label)</code> &ndash; Parameters: entity_type; field; label.</li><li><code>refresh_list(self, field)</code> &ndash; Parameters: field.</li><li><code>load_state(self, state)</code> &ndash; Parameters: state.</li><li><code>save_state(self, state)</code> &ndash; Parameters: state.</li></ul></div><div class='class'><h4>class ReviewStep (WizardStep)</h4><p></p><ul><li><code>__init__(self, master)</code> &ndash; Parameters: master.</li><li><code>load_state(self, state)</code> &ndash; Parameters: state.</li></ul></div><div class='class'><h4>class ScenarioBuilderWizard (ctk.CTkToplevel)</h4><p>Interactive wizard guiding users through building a scenario.</p><ul><li><code>__init__(self, master, on_saved=None, *, initial_scenario=None)</code> &ndash; Parameters: master; on_saved (default None); initial_scenario (keyword-only, default None).</li><li><code>_schedule_safe_destroy(self)</code> &ndash; Withdraw the window and destroy it once Tk has processed focus.</li><li><code>destroy(self)</code> &ndash; No inline documentation available.</li><li><code>focus_set(self)</code> &ndash; Safely set focus on the wizard if it still exists.</li><li><code>focus_force(self)</code> &ndash; Safely force focus on the wizard if it still exists.</li><li><code>_build_layout(self)</code> &ndash; No inline documentation available.</li><li><code>_create_steps(self)</code> &ndash; No inline documentation available.</li><li><code>_launch_epic_finale_planner(self, state)</code> &ndash; Parameters: state.</li><li><code>_show_step(self, index)</code> &ndash; Parameters: index.</li><li><code>_on_wizard_state_changed(self, source=None)</code> &ndash; Parameters: source (default None).</li><li><code>load_existing_scenario(self, scenario)</code> &ndash; Parameters: scenario.</li><li><code>_update_navigation_buttons(self)</code> &ndash; No inline documentation available.</li><li><code>go_next(self)</code> &ndash; No inline documentation available.</li><li><code>go_back(self)</code> &ndash; No inline documentation available.</li><li><code>cancel(self)</code> &ndash; No inline documentation available.</li><li><code>finish(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\scenarios\scenario_generator_view.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class ScenarioGeneratorView (ctk.CTkFrame)</h4><p>Frame embedding the scenario generator inside the main application.</p><ul><li><code>__init__(self, parent)</code> &ndash; Parameters: parent.</li><li><code>_build_widgets(self)</code> &ndash; No inline documentation available.</li><li><code>generate_campaign(self)</code> &ndash; No inline documentation available.</li><li><code>export_docx(self)</code> &ndash; No inline documentation available.</li><li><code>add_to_db(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\scenarios\scenario_graph_editor.py</h3><p></p><h4>Functions</h4><ul><li><code>clean_longtext(data, max_length=2000)</code> &ndash; Parameters: data; max_length (default 2000).</li><li><code>make_watermarked_postit(base_path, icon_path, size=(200,200), icon_size=32, margin=8, opacity=80)</code> &ndash; Parameters: base_path; icon_path; size (default (200,200)); icon_size (default 32); margin (default 8); opacity (default 80).</li></ul><div class='class'><h4>class LinkEditDialog (ctk.CTkToplevel)</h4><p></p><ul><li><code>__init__(self, master, link_record, scene_lookup)</code> &ndash; Parameters: master; link_record; scene_lookup.</li><li><code>_focus_label_entry(self)</code> &ndash; No inline documentation available.</li><li><code>_initial_target_value(self, link_data)</code> &ndash; Parameters: link_data.</li><li><code>_prepare_initial_metadata(self, link_data)</code> &ndash; Parameters: link_data.</li><li><code>_on_submit(self)</code> &ndash; No inline documentation available.</li><li><code>_on_cancel(self)</code> &ndash; No inline documentation available.</li></ul></div><div class='class'><h4>class ScenarioGraphEditor (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, scenario_wrapper: GenericModelWrapper, npc_wrapper: GenericModelWrapper, creature_wrapper: GenericModelWrapper, place_wrapper: GenericModelWrapper, *args, **kwargs)</code> &ndash; Parameters: master; scenario_wrapper (type GenericModelWrapper); npc_wrapper (type GenericModelWrapper); creature_wrapper (type GenericModelWrapper); place_wrapper (type GenericModelWrapper); args (variadic positional); kwargs (variadic keyword).</li><li><code>_sanitize_tag_component(self, value)</code> &ndash; Parameters: value.</li><li><code>_build_tag(self, prefix, name=None)</code> &ndash; Parameters: prefix; name (default None).</li><li><code>_on_zoom(self, event)</code> &ndash; Parameters: event.</li><li><code>reset_zoom(self)</code> &ndash; No inline documentation available.</li><li><code>init_toolbar(self)</code> &ndash; No inline documentation available.</li><li><code>_init_detail_panel(self)</code> &ndash; No inline documentation available.</li><li><code>_resolve_panel_background_color(self)</code> &ndash; No inline documentation available.</li><li><code>_create_plain_textbox(self)</code> &ndash; No inline documentation available.</li><li><code>_fallback_to_plain_text(self, text)</code> &ndash; Parameters: text.</li><li><code>_update_detail_text(self, html_text, plain_text)</code> &ndash; Parameters: html_text; plain_text.</li><li><code>_rebuild_entity_buttons(self, entities)</code> &ndash; Parameters: entities.</li><li><code>_format_entity_button_label(self, entity)</code> &ndash; Parameters: entity.</li><li><code>_open_entity_editor(self, entity_entry)</code> &ndash; Parameters: entity_entry.</li><li><code>_resolve_entity_editor_context(self, entity_entry)</code> &ndash; Parameters: entity_entry.</li><li><code>_lookup_from_collection(collection, name)</code> &ndash; Parameters: collection; name.</li><li><code>_apply_inline_markup(text)</code> &ndash; Parameters: text.</li><li><code>_convert_scene_text_to_html(self, text)</code> &ndash; Parameters: text.</li><li><code>_show_detail_panel(self)</code> &ndash; No inline documentation available.</li><li><code>_hide_detail_panel(self)</code> &ndash; No inline documentation available.</li><li><code>_clear_detail_panel(self)</code> &ndash; No inline documentation available.</li><li><code>_show_node_detail(self, node_tag)</code> &ndash; Parameters: node_tag.</li><li><code>_populate_detail_panel(self, scene_data)</code> &ndash; Parameters: scene_data.</li><li><code>_build_scene_payload_from_graph(self, node_tag)</code> &ndash; Parameters: node_tag.</li><li><code>_measure_text_height(self, text, font_obj, wrap_width)</code> &ndash; Parameters: text; font_obj; wrap_width.</li><li><code>_summarize_scene_text(self, text, max_lines=4, min_lines=2)</code> &ndash; Parameters: text; max_lines (default 4); min_lines (default 2).</li><li><code>_truncate_line(self, text, width)</code> &ndash; Parameters: text; width.</li><li><code>_determine_scene_card_size(self, text, entity_count)</code> &ndash; Parameters: text; entity_count.</li><li><code>_extract_scene_type_label(self, entry, explicit_type=None)</code> &ndash; Parameters: entry; explicit_type (default None).</li><li><code>_classify_scene_type(self, type_label)</code> &ndash; Parameters: type_label.</li><li><code>_resolve_scene_type_style(self, source_entry, fallback_color, explicit_type=None)</code> &ndash; Parameters: source_entry; fallback_color; explicit_type (default None).</li><li><code>_extract_scene_badges(self, source_entry)</code> &ndash; Parameters: source_entry.</li><li><code>_normalize_badge_value(self, value)</code> &ndash; Parameters: value.</li><li><code>_compute_badge_layout(self, texts, font_obj, max_width, badge_height, gap, inner_padding)</code> &ndash; Parameters: texts; font_obj; max_width; badge_height; gap; inner_padding.</li><li><code>show_scene_flow(self)</code> &ndash; No inline documentation available.</li><li><code>select_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>display_portrait_window(self)</code> &ndash; No inline documentation available.</li><li><code>load_scenario(self, scenario)</code> &ndash; Parameters: scenario.</li><li><code>load_scenario_scene_flow(self, scenario=None)</code> &ndash; Parameters: scenario (default None).</li><li><code>_coerce_scene_list(self, scenes_raw)</code> &ndash; Parameters: scenes_raw.</li><li><code>_normalize_scene_entry(self, entry, index, scenario_npcs, scenario_creatures, scenario_places)</code> &ndash; Parameters: entry; index; scenario_npcs; scenario_creatures; scenario_places.</li><li><code>_scene_color_from_entry(self, entry)</code> &ndash; Parameters: entry.</li><li><code>_clean_scene_title(self, text)</code> &ndash; Parameters: text.</li><li><code>_to_list(self, value)</code> &ndash; Parameters: value.</li><li><code>_dedupe_preserve_order(self, values)</code> &ndash; Parameters: values.</li><li><code>_lookup_entity_by_name(self, entity_type, name)</code> &ndash; Parameters: entity_type; name.</li><li><code>_normalize_synopsis_text(self, value, max_length=240)</code> &ndash; Parameters: value; max_length (default 240).</li><li><code>_build_entity_synopsis(self, entity_type, record)</code> &ndash; Parameters: entity_type; record.</li><li><code>_get_entity_synopsis_for_display(self, entity)</code> &ndash; Parameters: entity.</li><li><code>_compose_entity_tooltip_text(self, entity_info)</code> &ndash; Parameters: entity_info.</li><li><code>_load_entity_tooltip_portrait(self, entity_info)</code> &ndash; Parameters: entity_info.</li><li><code>_cancel_entity_tooltip_schedule(self)</code> &ndash; No inline documentation available.</li><li><code>_cancel_entity_tooltip_hide(self)</code> &ndash; No inline documentation available.</li><li><code>_hide_entity_tooltip(self)</code> &ndash; No inline documentation available.</li><li><code>_dismiss_entity_tooltip(self)</code> &ndash; No inline documentation available.</li><li><code>_schedule_entity_tooltip_hide(self, tag, delay=ENTITY_TOOLTIP_HIDE_DELAY_MS)</code> &ndash; Parameters: tag; delay (default ENTITY_TOOLTIP_HIDE_DELAY_MS).</li><li><code>_schedule_entity_tooltip(self, root_x, root_y, entity_info, tag)</code> &ndash; Parameters: root_x; root_y; entity_info; tag.</li><li><code>_show_entity_tooltip_at(self, root_x, root_y, entity_info, tag)</code> &ndash; Parameters: root_x; root_y; entity_info; tag.</li><li><code>_on_entity_hover_enter(self, event, entity_info, tag)</code> &ndash; Parameters: event; entity_info; tag.</li><li><code>_on_entity_hover_leave(self, event=None, tag=None)</code> &ndash; Parameters: event (default None); tag (default None).</li><li><code>_bind_entity_tooltip(self, tag, entity_info)</code> &ndash; Parameters: tag; entity_info.</li><li><code>_find_mentions(self, text, candidates)</code> &ndash; Parameters: text; candidates.</li><li><code>_coerce_scene_links(self, value)</code> &ndash; Parameters: value.</li><li><code>_normalise_link_text_value(self, value)</code> &ndash; Convert raw link text payloads into display strings without truncation. Parameters: value.</li><li><code>_link_text_matches_target(self, text, link_record)</code> &ndash; Return True when the provided label simply mirrors the link target. Parameters: text; link_record.</li><li><code>_build_scene_lookup(self, scenes)</code> &ndash; Parameters: scenes.</li><li><code>_resolve_scene_reference(self, reference, lookup, index_lookup)</code> &ndash; Parameters: reference; lookup; index_lookup.</li><li><code>_normalize_scene_identifier_key(self, value)</code> &ndash; Parameters: value.</li><li><code>_slugify_scene_identifier(self, value)</code> &ndash; Parameters: value.</li><li><code>draw_graph(self)</code> &ndash; No inline documentation available.</li><li><code>_extract_entity_image(self, record, entity_type)</code> &ndash; Parameters: record; entity_type.</li><li><code>_resolve_scene_entity_portrait(self, entity)</code> &ndash; Parameters: entity.</li><li><code>_iter_image_candidates(self, value)</code> &ndash; Parameters: value.</li><li><code>_resolve_existing_image_path(self, portrait_path)</code> &ndash; Parameters: portrait_path.</li><li><code>load_portrait(self, portrait_path, node_tag)</code> &ndash; Parameters: portrait_path; node_tag.</li><li><code>load_portrait_scaled(self, portrait_path, node_tag, scale=1.0)</code> &ndash; Parameters: portrait_path; node_tag; scale (default 1.0).</li><li><code>load_thumbnail(self, portrait_path, cache_key, size)</code> &ndash; Parameters: portrait_path; cache_key; size.</li><li><code>_entity_placeholder_color(self, entity_type)</code> &ndash; Parameters: entity_type.</li><li><code>_load_default_type_icons(self)</code> &ndash; No inline documentation available.</li><li><code>_get_scaled_type_icon(self, entity_type, size)</code> &ndash; Parameters: entity_type; size.</li><li><code>draw_nodes(self)</code> &ndash; No inline documentation available.</li><li><code>draw_links(self)</code> &ndash; No inline documentation available.</li><li><code>_draw_scene_card(self, node, scale)</code> &ndash; Parameters: node; scale.</li><li><code>draw_one_link(self, link)</code> &ndash; Parameters: link.</li><li><code>start_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>on_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>on_double_click(self, event)</code> &ndash; Parameters: event.</li><li><code>on_right_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_mousewheel_y(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_mousewheel_x(self, event)</code> &ndash; Parameters: event.</li><li><code>_start_canvas_pan(self, event)</code> &ndash; Parameters: event.</li><li><code>_do_canvas_pan(self, event)</code> &ndash; Parameters: event.</li><li><code>_end_canvas_pan(self, _event)</code> &ndash; Parameters: _event.</li><li><code>show_node_menu(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>_get_entity_audio(self, record)</code> &ndash; Parameters: record.</li><li><code>_play_entity_audio(self, record, name)</code> &ndash; Parameters: record; name.</li><li><code>show_color_menu(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>change_node_color(self, color)</code> &ndash; Parameters: color.</li><li><code>delete_node(self)</code> &ndash; No inline documentation available.</li><li><code>edit_link_text(self, item_id)</code> &ndash; Parameters: item_id.</li><li><code>_get_scenario_scenes_list(self)</code> &ndash; No inline documentation available.</li><li><code>_ensure_scene_entry(self, index)</code> &ndash; Parameters: index.</li><li><code>_persist_scene_links(self)</code> &ndash; No inline documentation available.</li><li><code>_save_scenario_changes(self)</code> &ndash; No inline documentation available.</li><li><code>save_graph(self)</code> &ndash; No inline documentation available.</li><li><code>load_graph(self)</code> &ndash; No inline documentation available.</li><li><code>get_state(self)</code> &ndash; No inline documentation available.</li><li><code>set_state(self, state)</code> &ndash; Parameters: state.</li><li><code>load_icon(self, path, size, opacity)</code> &ndash; Parameters: path; size; opacity.</li></ul></div></section>
<section class='module'><h3>modules\scenarios\scenario_importer.py</h3><p></p><h4>Functions</h4><ul><li><code>remove_emojis(text)</code> &ndash; Parameters: text.</li><li><code>parse_json_relaxed(s: str)</code> &ndash; Try to parse JSON from a possibly noisy AI response (module-level helper). Parameters: s (type str).</li><li><code>import_formatted_scenario(text)</code> &ndash; Parameters: text.</li></ul><div class='class'><h4>class ScenarioImportWindow (ctk.CTkToplevel)</h4><p></p><ul><li><code>__init__(self, master=None)</code> &ndash; Parameters: master (default None).</li><li><code>import_scenario(self)</code> &ndash; No inline documentation available.</li><li><code>import_pdf_via_ai(self)</code> &ndash; No inline documentation available.</li><li><code>ai_parse_textarea(self)</code> &ndash; No inline documentation available.</li><li><code>_extract_pdf_text(self, path: str)</code> &ndash; Attempt to extract text from PDF using available backends. Parameters: path (type str). Returns: str.</li><li><code>_ai_extract_and_import(self, raw_text: str, source_label: str="")</code> &ndash; Parameters: raw_text (type str); source_label (type str, default "").</li><li><code>_set_status(self, text: str)</code> &ndash; Parameters: text (type str).</li><li><code>_busy(self, on: bool)</code> &ndash; Parameters: on (type bool).</li><li><code>_info(self, title: str, msg: str)</code> &ndash; Parameters: title (type str); msg (type str).</li><li><code>_warn(self, title: str, msg: str)</code> &ndash; Parameters: title (type str); msg (type str).</li><li><code>_error(self, title: str, msg: str)</code> &ndash; Parameters: title (type str); msg (type str).</li></ul></div></section>
<section class='module'><h3>modules\scenarios\scenarios_model.py</h3><p></p><h4>Functions</h4><ul><li><code>load()</code> &ndash; No inline documentation available.</li><li><code>save(items)</code> &ndash; Parameters: items.</li></ul></section>
<section class='module'><h3>modules\scenarios\scene_flow_components.py</h3><p>Reusable scene flow widgets and helpers shared across scenario tools.</p><h4>Functions</h4><ul><li><code>normalise_scene_links(scene: dict, split_to_list: Callable[[Any], list[str]])</code> &ndash; Return the cleaned link payload for ``scene``.

The helper mirrors :meth:`ScenesPlanningStep._get_scene_links` so that the
same normalisation logic can be shared with lightweight previews such as
the wizard review step without duplicating behaviour. Parameters: scene (type dict); split_to_list (type Callable[[Any], list[str]]).</li></ul><div class='class'><h4>class SceneFlowPreview (ctk.CTkFrame)</h4><p>Lightweight scene flow canvas used inside the wizard.</p><ul><li><code>__init__(self, master, *, on_select: Optional[Callable[[int], None]]=None)</code> &ndash; Parameters: master; on_select (keyword-only, type Optional[Callable[[int], None]], default None).</li><li><code>render(self, scenes, selected_index)</code> &ndash; Parameters: scenes; selected_index.</li><li><code>_draw(self, *_args, **_kwargs)</code> &ndash; Parameters: _args (variadic positional); _kwargs (variadic keyword).</li><li><code>_handle_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_middle_press(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_middle_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_middle_release(self, _event)</code> &ndash; Parameters: _event.</li><li><code>_build_card_model(self, scene: dict[str, Any], index: int, selected: bool)</code> &ndash; Parameters: scene (type dict[str, Any]); index (type int); selected (type bool). Returns: dict[str, Any].</li><li><code>_compute_card_half_height(self, title: str, summary: str, entity_lines: list[str], has_type: bool, badge_count: int, selected: bool)</code> &ndash; Parameters: title (type str); summary (type str); entity_lines (type list[str]); has_type (type bool); badge_count (type int); selected (type bool). Returns: float.</li><li><code>_prepare_summary(self, scene: dict[str, Any])</code> &ndash; Parameters: scene (type dict[str, Any]). Returns: str.</li><li><code>_prepare_entity_lines(self, scene: dict[str, Any])</code> &ndash; Parameters: scene (type dict[str, Any]). Returns: list[str].</li><li><code>_prepare_icon_badges(self, scene: dict[str, Any])</code> &ndash; Parameters: scene (type dict[str, Any]). Returns: list[tuple[str, bool]].</li><li><code>_measure_text_height(self, canvas: tk.Canvas, text: str, font: tuple, width: int)</code> &ndash; Parameters: canvas (type tk.Canvas); text (type str); font (type tuple); width (type int). Returns: float.</li></ul></div><div class='class'><h4>class SceneCanvas (ctk.CTkFrame)</h4><p></p><ul><li><code>__init__(self, master, on_select: Optional[Callable[[Optional[int]], None]]=None, on_move: Optional[Callable[[int, float, float], None]]=None, on_edit: Optional[Callable[[int], None]]=None, on_context: Optional[Callable[[tk.Event, Optional[int]], None]]=None, on_add_entity: Optional[Callable[[int, str], None]]=None, on_link: Optional[Callable[[int, int], None]]=None, on_link_text_edit: Optional[Callable[[int, int, Any, tuple[float, float, float, float]], None]]=None, available_entity_types: Optional[tuple[str, ...] | list[str]]=None)</code> &ndash; Parameters: master; on_select (type Optional[Callable[[Optional[int]], None]], default None); on_move (type Optional[Callable[[int, float, float], None]], default None); on_edit (type Optional[Callable[[int], None]], default None); on_context (type Optional[Callable[[tk.Event, Optional[int]], None]], default None); on_add_entity (type Optional[Callable[[int, str], None]], default None); on_link (type Optional[Callable[[int, int], None]], default None); on_link_text_edit (type Optional[Callable[[int, int, Any, tuple[float, float, float, float]], None]], default None); available_entity_types (type Optional[tuple[str, ...] | list[str]], default None).</li><li><code>set_scenes(self, scenes, selected_index=None)</code> &ndash; Parameters: scenes; selected_index (default None).</li><li><code>_event_coords(self, event: tk.Event)</code> &ndash; Return the canvas-space coordinates for ``event``. Parameters: event (type tk.Event). Returns: tuple[float, float].</li><li><code>_ensure_positions(self)</code> &ndash; No inline documentation available.</li><li><code>_draw(self, *_args, **_kwargs)</code> &ndash; Parameters: _args (variadic positional); _kwargs (variadic keyword).</li><li><code>_hit_test(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>_hit_icon(self, x, y)</code> &ndash; Parameters: x; y.</li><li><code>get_card_bbox(self, index)</code> &ndash; Parameters: index.</li><li><code>_get_link_anchor(self, idx)</code> &ndash; Parameters: idx.</li><li><code>_truncate_inline_summary(self, text: str)</code> &ndash; Parameters: text (type str). Returns: str.</li><li><code>_prepare_entity_lines(self, scene: dict[str, Any])</code> &ndash; Parameters: scene (type dict[str, Any]). Returns: list[str].</li><li><code>_measure_text_height(self, canvas: tk.Canvas, text: str, font: tuple, width: int)</code> &ndash; Parameters: canvas (type tk.Canvas); text (type str); font (type tuple); width (type int). Returns: float.</li><li><code>_compute_card_height(self, canvas: tk.Canvas, title: str, summary_text: str, entity_lines: list[str], icon_types: list[tuple[str, str]], *, selected: bool)</code> &ndash; Parameters: canvas (type tk.Canvas); title (type str); summary_text (type str); entity_lines (type list[str]); icon_types (type list[tuple[str, str]]); selected (keyword-only, type bool). Returns: float.</li><li><code>_select_index(self, idx, redraw_on_none=True)</code> &ndash; Parameters: idx; redraw_on_none (default True).</li><li><code>_on_middle_press(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_middle_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_middle_release(self, _event)</code> &ndash; Parameters: _event.</li><li><code>_on_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_drag(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_release(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_double_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_on_right_click(self, event)</code> &ndash; Parameters: event.</li></ul></div></section>
<section class='module'><h3>modules\scenarios\scene_flow_rendering.py</h3><p>Shared helpers for rendering scene flow canvases.</p><h4>Functions</h4><ul><li><code>_resolve_tile(cache: TileCache, canvas, *, cache_key: str=_GRID_TILE_KEY)</code> &ndash; Parameters: cache (type TileCache); canvas; cache_key (keyword-only, type str, default _GRID_TILE_KEY). Returns: ImageTk.PhotoImage.</li><li><code>apply_scene_flow_canvas_styling(canvas, *, tile_cache: TileCache, extent_width: int, extent_height: int, background_tags: Sequence[str]=("background", "scene_flow_bg"), cache_key: str=_GRID_TILE_KEY)</code> &ndash; Configure the canvas with the shared grid background used by scene views. Parameters: canvas; tile_cache (keyword-only, type TileCache); extent_width (keyword-only, type int); extent_height (keyword-only, type int); background_tags (keyword-only, type Sequence[str], default ("background", "scene_flow_bg")); cache_key (keyword-only, type str, default _GRID_TILE_KEY). Returns: Optional[ImageTk.PhotoImage].</li><li><code>draw_grid_background(canvas, tile: Optional[ImageTk.PhotoImage], extent_width: int, extent_height: int, tags: Sequence[str]=("background", "scene_flow_bg"))</code> &ndash; Tile ``tile`` across the canvas within the provided extents. Parameters: canvas; tile (type Optional[ImageTk.PhotoImage]); extent_width (type int); extent_height (type int); tags (type Sequence[str], default ("background", "scene_flow_bg")). Returns: None.</li><li><code>create_grid_tile(canvas, *, size: int=256, spacing: int=96, line_color=(255, 255, 255, 25), dot_color=(255, 255, 255, 40))</code> &ndash; Create a PhotoImage used for the tiled background grid. Parameters: canvas; size (keyword-only, type int, default 256); spacing (keyword-only, type int, default 96); line_color (keyword-only, default (255, 255, 255, 25)); dot_color (keyword-only, default (255, 255, 255, 40)). Returns: ImageTk.PhotoImage.</li><li><code>get_shadow_image(canvas, cache: ShadowCache, width: int, height: int, scale: float)</code> &ndash; Return a cached drop shadow sized for the given dimensions. Parameters: canvas; cache (type ShadowCache); width (type int); height (type int); scale (type float). Returns: Tuple[Optional[ImageTk.PhotoImage], int].</li></ul></section>
<section class='module'><h3>modules\scenarios\scene_flow_viewer.py</h3><p></p><h4>Functions</h4><ul><li><code>create_scene_flow_frame(master=None, scenario_title: Optional[str]=None)</code> &ndash; Convenience factory to embed a SceneFlowViewerFrame without a window.

Resolves local wrappers and optionally selects an initial scenario by title. Parameters: master (default None); scenario_title (type Optional[str], default None).</li><li><code>scene_flow_content_factory(scenario_title: Optional[str]=None)</code> &ndash; Return a factory suitable for GM-screen tab restoration. Parameters: scenario_title (type Optional[str], default None).</li></ul><div class='class'><h4>class SceneFlowViewerWindow (ctk.CTkToplevel)</h4><p>Toplevel window hosting a dedicated scene flow viewer.</p><ul><li><code>__init__(self, master: Optional[ctk.CTk]=None, *, scenario_wrapper: GenericModelWrapper, npc_wrapper: GenericModelWrapper, creature_wrapper: GenericModelWrapper, place_wrapper: GenericModelWrapper, initial_scenario: Optional[dict]=None, on_close: Optional[Callable[[], None]]=None)</code> &ndash; Parameters: master (type Optional[ctk.CTk], default None); scenario_wrapper (keyword-only, type GenericModelWrapper); npc_wrapper (keyword-only, type GenericModelWrapper); creature_wrapper (keyword-only, type GenericModelWrapper); place_wrapper (keyword-only, type GenericModelWrapper); initial_scenario (keyword-only, type Optional[dict], default None); on_close (keyword-only, type Optional[Callable[[], None]], default None). Returns: None.</li><li><code>_focus_window(self)</code> &ndash; Returns: None.</li><li><code>_handle_close(self)</code> &ndash; Returns: None.</li></ul></div><div class='class'><h4>class SceneFlowViewerFrame (ScenarioGraphEditor)</h4><p>ScenarioGraphEditor subclass that specialises in scene flow presentation.</p><ul><li><code>__init__(self, master, scenario_wrapper: GenericModelWrapper, npc_wrapper: GenericModelWrapper, creature_wrapper: GenericModelWrapper, place_wrapper: GenericModelWrapper, *, initial_scenario: Optional[dict]=None, **kwargs)</code> &ndash; Parameters: master; scenario_wrapper (type GenericModelWrapper); npc_wrapper (type GenericModelWrapper); creature_wrapper (type GenericModelWrapper); place_wrapper (type GenericModelWrapper); initial_scenario (keyword-only, type Optional[dict], default None); kwargs (variadic keyword). Returns: None.</li><li><code>load_portrait_scaled(self, portrait_path, node_tag, scale: float=1.0)</code> &ndash; Load node portraits at twice the base size used by the editor.

The underlying graph editor already supports zoom scaling via the
``scale`` parameter. By multiplying the provided scale we effectively
double the rendered size of portraits in the dedicated scene flow
viewer while still respecting zoom changes. Parameters: portrait_path; node_tag; scale (type float, default 1.0).</li><li><code>init_toolbar(self)</code> &ndash; Returns: None.</li><li><code>_extract_title(self, scenario: Optional[dict])</code> &ndash; Parameters: scenario (type Optional[dict]). Returns: str.</li><li><code>_populate_scenario_menu(self)</code> &ndash; Returns: None.</li><li><code>_on_scenario_selected(self, _: str)</code> &ndash; Parameters: _ (type str). Returns: None.</li><li><code>_load_selected_scenario(self)</code> &ndash; Returns: None.</li><li><code>_on_canvas_resized(self, _event=None)</code> &ndash; Parameters: _event (default None). Returns: None.</li><li><code>_on_fit_mode_change(self, value: str)</code> &ndash; Parameters: value (type str). Returns: None.</li><li><code>_fit_to_view(self)</code> &ndash; Returns: None.</li><li><code>_on_layout_resize(self, _event=None)</code> &ndash; Keep the canvas height matched to available space under the toolbar. Parameters: _event (default None). Returns: None.</li><li><code>_toggle_detail_panel(self, *_args)</code> &ndash; Parameters: _args (variadic positional). Returns: None.</li><li><code>_apply_scene_flow_styling(self)</code> &ndash; Returns: None.</li><li><code>_draw_scene_card(self, node, scale)</code> &ndash; Parameters: node; scale.</li><li><code>select_scenario(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\ui\chatbot_dialog.py</h3><p>Campaign chatbot dialog with rich text rendering for entity notes.</p><h4>Functions</h4><ul><li><code>_coerce_formatting(data: Mapping[str, Any])</code> &ndash; Parameters: data (type Mapping[str, Any]). Returns: dict[str, list[tuple[int, int]]].</li><li><code>_from_rtf_json(value: Mapping[str, Any])</code> &ndash; Parameters: value (type Mapping[str, Any]). Returns: RichTextValue.</li><li><code>_apply_line_prefix(value: RichTextValue, first_prefix: str, later_prefix: str | None=None)</code> &ndash; Parameters: value (type RichTextValue); first_prefix (type str); later_prefix (type str | None, default None). Returns: RichTextValue.</li><li><code>get_default_chatbot_wrappers()</code> &ndash; Returns: dict[str, GenericModelWrapper].</li><li><code>_normalize_value(value: Any)</code> &ndash; Parameters: value (type Any). Returns: RichTextValue | None.</li><li><code>_normalize_excerpt_source(text: str)</code> &ndash; Normalize extracted text before searching for snippets. Parameters: text (type str). Returns: str.</li><li><code>_clip_snippet(snippet: str, match_pos: int, query_len: int, max_chars: int)</code> &ndash; Parameters: snippet (type str); match_pos (type int); query_len (type int); max_chars (type int). Returns: tuple[str, bool, bool].</li><li><code>_extract_paragraph_snippet(text: str, match_index: int, query_lower: str, *, max_chars: int=2000, fallback_window: int=240)</code> &ndash; Parameters: text (type str); match_index (type int); query_lower (type str); max_chars (keyword-only, type int, default 2000); fallback_window (keyword-only, type int, default 240). Returns: str.</li><li><code>_highlight_snippet(snippet: str, query: str)</code> &ndash; Parameters: snippet (type str); query (type str). Returns: RichTextValue.</li><li><code>_extract_text_from_pdf(path: str)</code> &ndash; Parameters: path (type str). Returns: str.</li><li><code>_normalize_page_number(value: Any)</code> &ndash; Parameters: value (type Any). Returns: int | None.</li><li><code>_label_for_excerpt(page: Mapping[str, Any], default_index: int)</code> &ndash; Parameters: page (type Mapping[str, Any]); default_index (type int). Returns: str.</li><li><code>_collect_book_excerpts(record: Mapping[str, Any], query: str)</code> &ndash; Parameters: record (type Mapping[str, Any]); query (type str). Returns: list[tuple[str, RichTextValue]].</li><li><code>open_chatbot_dialog(master: tk.Misc | None, *, wrappers: Mapping[str, GenericModelWrapper] | None=None, name_field_overrides: Mapping[str, str] | None=None, note_field_candidates: Iterable[str] | None=None)</code> &ndash; Parameters: master (type tk.Misc | None); wrappers (keyword-only, type Mapping[str, GenericModelWrapper] | None, default None); name_field_overrides (keyword-only, type Mapping[str, str] | None, default None); note_field_candidates (keyword-only, type Iterable[str] | None, default None). Returns: ChatbotDialog.</li></ul><div class='class'><h4>class RichTextValue</h4><p>Simple container holding text and formatting spans.</p><ul><li><code>has_content(self)</code> &ndash; Returns: bool.</li><li><code>cleaned(self)</code> &ndash; Returns: "RichTextValue".</li><li><code>clone(self)</code> &ndash; Returns: "RichTextValue".</li></ul></div><div class='class'><h4>class ChatbotDialog (ctk.CTkToplevel)</h4><p>Tk dialog that surfaces entity notes with styled text.</p><ul><li><code>__init__(self, master: tk.Misc | None=None, *, wrappers: Mapping[str, GenericModelWrapper] | None=None, name_field_overrides: Mapping[str, str] | None=None, note_field_candidates: Iterable[str] | None=None, title: str="Campaign Chatbot", geometry: str="1600x900+0+0")</code> &ndash; Parameters: master (type tk.Misc | None, default None); wrappers (keyword-only, type Mapping[str, GenericModelWrapper] | None, default None); name_field_overrides (keyword-only, type Mapping[str, str] | None, default None); note_field_candidates (keyword-only, type Iterable[str] | None, default None); title (keyword-only, type str, default "Campaign Chatbot"); geometry (keyword-only, type str, default "1600x900+0+0"). Returns: None.</li><li><code>_build_ui(self)</code> &ndash; Returns: None.</li><li><code>_focus_query_entry(self)</code> &ndash; Returns: None.</li><li><code>_focus_results(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_maybe_focus_query(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_on_scope_changed(self)</code> &ndash; Returns: None.</li><li><code>_on_query_submit(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_on_submit(self, _event=None)</code> &ndash; Parameters: _event (default None). Returns: None.</li><li><code>_populate(self, *, initial: bool, query: str="")</code> &ndash; Parameters: initial (keyword-only, type bool); query (keyword-only, type str, default ""). Returns: None.</li><li><code>_build_search_blob(self, entity_type: str, record: Mapping[str, Any])</code> &ndash; Parameters: entity_type (type str); record (type Mapping[str, Any]). Returns: str.</li><li><code>_update_excerpt_status(self)</code> &ndash; Returns: None.</li><li><code>_reset_active_record(self)</code> &ndash; Returns: None.</li><li><code>_display_selected_note(self, _event=None)</code> &ndash; Parameters: _event (default None). Returns: None.</li><li><code>_focus_book_sections(self, sections: Sequence[tuple[str, list[tuple[str, RichTextValue]]]], excerpt: tuple[str, RichTextValue] | None)</code> &ndash; Parameters: sections (type Sequence[tuple[str, list[tuple[str, RichTextValue]]]]); excerpt (type tuple[str, RichTextValue] | None). Returns: list[tuple[str, list[tuple[str, RichTextValue]]]].</li><li><code>_render_active_book_excerpt(self)</code> &ndash; Returns: None.</li><li><code>_section_layout(self, entity_type: str)</code> &ndash; Parameters: entity_type (type str). Returns: Sequence[tuple[str, tuple[str, ...]]].</li><li><code>_collate_sections(self, entity_type: str, record: Mapping[str, Any])</code> &ndash; Parameters: entity_type (type str); record (type Mapping[str, Any]). Returns: list[tuple[str, list[tuple[str, RichTextValue]]]].</li><li><code>_set_notes_state(self, state: str)</code> &ndash; Parameters: state (type str). Returns: None.</li><li><code>_temporarily_enable_notes(self)</code> &ndash; No inline documentation available.</li><li><code>_refresh_search_highlights(self)</code> &ndash; Returns: None.</li><li><code>_focus_match(self, delta: int)</code> &ndash; Parameters: delta (type int). Returns: None.</li><li><code>_apply_active_match(self, *, scroll: bool)</code> &ndash; Parameters: scroll (keyword-only, type bool). Returns: None.</li><li><code>_update_navigation_state(self)</code> &ndash; Returns: None.</li><li><code>_on_next_match(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_on_prev_match(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_render_text(self, value: RichTextValue)</code> &ndash; Parameters: value (type RichTextValue). Returns: None.</li><li><code>_render_sections(self, sections: Sequence[tuple[str, list[tuple[str, RichTextValue]]]])</code> &ndash; Parameters: sections (type Sequence[tuple[str, list[tuple[str, RichTextValue]]]]). Returns: None.</li><li><code>_derive_listbox_theme(self)</code> &ndash; Returns: dict[str, str].</li><li><code>_derive_text_theme(self)</code> &ndash; Returns: dict[str, str].</li></ul></div></section>
<section class='module'><h3>modules\ui\icon_button.py</h3><p></p><h4>Functions</h4><ul><li><code>create_icon_button(parent, icon, tooltip_text, command)</code> &ndash; Parameters: parent; icon; tooltip_text; command.</li></ul></section>
<section class='module'><h3>modules\ui\image_viewer.py</h3><p></p><h4>Functions</h4><ul><li><code>_get_monitors()</code> &ndash; Return list of (x, y, width, height).</li><li><code>show_portrait(path, title=None)</code> &ndash; Parameters: path; title (default None).</li></ul></section>
<section class='module'><h3>modules\ui\portrait_importer.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class PortraitPreview (ctk.CTkFrame)</h4><p>Display helper that keeps portrait previews crisp and centered.</p><ul><li><code>__init__(self, parent, placeholder: str="Portrait preview")</code> &ndash; Parameters: parent; placeholder (type str, default "Portrait preview").</li><li><code>clear(self)</code> &ndash; No inline documentation available.</li><li><code>show_error(self, message: str)</code> &ndash; Parameters: message (type str).</li><li><code>display_image(self, path: str)</code> &ndash; Parameters: path (type str). Returns: tuple[int, int] | None.</li><li><code>_on_resize(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_update_display(self)</code> &ndash; No inline documentation available.</li></ul></div><div class='class'><h4>class PortraitImportReviewWindow</h4><p>Interactive window that lets users review and assign portrait matches.</p><ul><li><code>__init__(self, parent, entity_review_data: list[dict], replace_existing: bool, copy_and_resize_callback)</code> &ndash; Parameters: parent; entity_review_data (type list[dict]); replace_existing (type bool); copy_and_resize_callback. Returns: None.</li><li><code>_build_ui(self)</code> &ndash; No inline documentation available.</li><li><code>_build_entity_panel(self, container)</code> &ndash; Parameters: container.</li><li><code>_build_detail_panel(self, container)</code> &ndash; Parameters: container.</li><li><code>_populate_entities(self)</code> &ndash; No inline documentation available.</li><li><code>_on_slider_change(self, value)</code> &ndash; Parameters: value.</li><li><code>_on_spin_change(self)</code> &ndash; No inline documentation available.</li><li><code>_update_threshold_label(self, value)</code> &ndash; Parameters: value.</li><li><code>_populate_match_list(self)</code> &ndash; No inline documentation available.</li><li><code>_on_match_select(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_show_entity_details(self, record: dict | None)</code> &ndash; Parameters: record (type dict | None).</li><li><code>_on_tree_select(self, _event=None)</code> &ndash; Parameters: _event (default None).</li><li><code>_on_tree_double_click(self, event)</code> &ndash; Parameters: event.</li><li><code>_assign_selected_portrait(self, _event=None)</code> &ndash; Parameters: _event (default None).</li></ul></div><div class='class'><h4>class PortraitImporter</h4><p>High level workflow for importing portraits from a directory.</p><ul><li><code>__init__(self, main_window)</code> &ndash; Parameters: main_window. Returns: None.</li><li><code>import_portraits_from_directory(self)</code> &ndash; Match and import portraits from a directory for all portrait-capable entities.</li></ul></div></section>
<section class='module'><h3>modules\ui\second_screen_display.py</h3><p></p><h4>Functions</h4><ul><li><code>show_entity_on_second_screen(item, title, fields)</code> &ndash; Parameters: item; title; fields.</li></ul></section>
<section class='module'><h3>modules\ui\system_selector_dialog.py</h3><p>Modal dialog for switching the active campaign system.</p><h4>Functions</h4><ul></ul><div class='class'><h4>class CampaignSystemSelectorDialog (ctk.CTkToplevel)</h4><p>Displays available campaign systems and updates the active selection.</p><ul><li><code>__init__(self, master: tk.Misc | None=None, *, on_selected: SystemSelectedCallback | None=None)</code> &ndash; Parameters: master (type tk.Misc | None, default None); on_selected (keyword-only, type SystemSelectedCallback | None, default None). Returns: None.</li><li><code>_build_ui(self)</code> &ndash; Returns: None.</li><li><code>_load_systems(self)</code> &ndash; Returns: None.</li><li><code>_display_empty_state(self, message: str)</code> &ndash; Parameters: message (type str). Returns: None.</li><li><code>_update_confirm_state(self)</code> &ndash; Returns: None.</li><li><code>_cancel(self)</code> &ndash; Returns: None.</li><li><code>_confirm_selection(self)</code> &ndash; Returns: None.</li><li><code>destroy(self)</code> &ndash; Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\ui\tooltip.py</h3><p></p><h4>Functions</h4><ul></ul><div class='class'><h4>class ToolTip</h4><p></p><ul><li><code>__init__(self, widget, text, delay=500)</code> &ndash; Parameters: widget; text; delay (default 500).</li><li><code>schedule_wrapper(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>schedule(self)</code> &ndash; No inline documentation available.</li><li><code>cancel(self, event=None)</code> &ndash; Parameters: event (default None).</li><li><code>showtip(self)</code> &ndash; No inline documentation available.</li><li><code>hidetip(self)</code> &ndash; No inline documentation available.</li></ul></div></section>
<section class='module'><h3>modules\ui\video_player.py</h3><p>Utility helpers for displaying videos on the secondary monitor.</p><h4>Functions</h4><ul><li><code>play_video_on_second_screen(video_path: str, title: str | None=None)</code> &ndash; Play the provided video on the secondary monitor.

Parameters
----------
video_path:
    Absolute filesystem path to the video file to display.
title:
    Optional window title to show while the video is playing. Parameters: video_path (type str); title (type str | None, default None). Returns: ctk.CTkToplevel.</li></ul><div class='class'><h4>class _MonitorBounds</h4><p></p><ul></ul></div><div class='class'><h4>class _SecondScreenVideoPlayer</h4><p>Simple video player that renders frames inside a fullscreen CTk window.</p><ul><li><code>__init__(self, video_path: str, title: str | None=None)</code> &ndash; Parameters: video_path (type str); title (type str | None, default None). Returns: None.</li><li><code>_open_container(self, path: str)</code> &ndash; Parameters: path (type str).</li><li><code>_get_video_stream(self)</code> &ndash; No inline documentation available.</li><li><code>_calculate_frame_delay(self)</code> &ndash; Returns: int.</li><li><code>_select_monitor(self)</code> &ndash; Returns: _MonitorBounds.</li><li><code>_build_window(self, video_path: str, title: str | None, monitor: _MonitorBounds)</code> &ndash; Parameters: video_path (type str); title (type str | None); monitor (type _MonitorBounds). Returns: ctk.CTkToplevel.</li><li><code>_render_next_frame(self)</code> &ndash; Returns: None.</li><li><code>_display_image(self, image: Image.Image)</code> &ndash; Parameters: image (type Image.Image). Returns: None.</li><li><code>close(self, event=None)</code> &ndash; Parameters: event (default None). Returns: None.</li></ul></div></section>
<section class='module'><h3>modules\web\GM_webviewer.py</h3><p></p><h4>Functions</h4><ul><li><code>load_user(user_id)</code> &ndash; Parameters: user_id.</li><li><code>login()</code> &ndash; No inline documentation available.</li><li><code>register()</code> &ndash; No inline documentation available.</li><li><code>logout()</code> &ndash; No inline documentation available.</li><li><code>list_entries()</code> &ndash; No inline documentation available.</li><li><code>view_entry(entry_id)</code> &ndash; Parameters: entry_id.</li><li><code>new_entry()</code> &ndash; No inline documentation available.</li><li><code>edit_entry(entry_id)</code> &ndash; Parameters: entry_id.</li><li><code>delete_entry(entry_id)</code> &ndash; Parameters: entry_id.</li><li><code>load_links()</code> &ndash; No inline documentation available.</li><li><code>save_links_list(links_list)</code> &ndash; Parameters: links_list.</li><li><code>save_link(link)</code> &ndash; Parameters: link.</li><li><code>delete_clue_link()</code> &ndash; No inline documentation available.</li><li><code>delete_clue()</code> &ndash; No inline documentation available.</li><li><code>load_positions()</code> &ndash; No inline documentation available.</li><li><code>save_positions(positions)</code> &ndash; Parameters: positions.</li><li><code>get_graph_list()</code> &ndash; No inline documentation available.</li><li><code>get_portrait_mapping()</code> &ndash; No inline documentation available.</li><li><code>get_places_list()</code> &ndash; No inline documentation available.</li><li><code>get_informations_list()</code> &ndash; No inline documentation available.</li><li><code>get_clues_list()</code> &ndash; No inline documentation available.</li><li><code>default()</code> &ndash; No inline documentation available.</li><li><code>welcome()</code> &ndash; No inline documentation available.</li><li><code>npc_view()</code> &ndash; No inline documentation available.</li><li><code>locations_view()</code> &ndash; No inline documentation available.</li><li><code>news_view()</code> &ndash; No inline documentation available.</li><li><code>clues_view()</code> &ndash; No inline documentation available.</li><li><code>get_clue_links()</code> &ndash; No inline documentation available.</li><li><code>add_clue_link()</code> &ndash; No inline documentation available.</li><li><code>npc_graph()</code> &ndash; No inline documentation available.</li><li><code>get_clue_positions()</code> &ndash; No inline documentation available.</li><li><code>set_clue_position()</code> &ndash; No inline documentation available.</li><li><code>get_portrait(filename)</code> &ndash; Parameters: filename.</li><li><code>get_asset(filename)</code> &ndash; Parameters: filename.</li><li><code>get_css(filename)</code> &ndash; Parameters: filename.</li><li><code>set_all_clue_positions()</code> &ndash; No inline documentation available.</li><li><code>information_upload(filename)</code> &ndash; Parameters: filename.</li><li><code>clue_upload(filename)</code> &ndash; Parameters: filename.</li><li><code>add_information()</code> &ndash; No inline documentation available.</li><li><code>factions_view()</code> &ndash; No inline documentation available.</li><li><code>faction_graph()</code> &ndash; No inline documentation available.</li><li><code>add_clue()</code> &ndash; No inline documentation available.</li><li><code>edit_clue(idx)</code> &ndash; Parameters: idx.</li></ul><div class='class'><h4>class User (UserMixin, db.Model)</h4><p></p><ul></ul></div><div class='class'><h4>class JournalEntry (db.Model)</h4><p></p><ul></ul></div></section>
<section class='module'><h3>modules\web\test_server.py</h3><p></p><h4>Functions</h4><ul><li><code>hello()</code> &ndash; No inline documentation available.</li></ul></section></section>
</body>
</html>
